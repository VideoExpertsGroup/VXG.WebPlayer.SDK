// CloudSDK.min.js
// version: 3.1.6
// date-of-build: 210210
// copyright (c) VXG Inc
// Includes gl-matrix  <https://github.com/toji/gl-matrix>
// ver: 3.3.0 // Available under MIT License 
// <https://github.com/toji/gl-matrix/blob/master/LICENSE.md> 
// Includes rangeslider.js <https://github.com/andreruffert/rangeslider.js>
// Available under MIT License 
// <https://github.com/andreruffert/rangeslider.js/blob/develop/LICENSE.md> 
// Includes momentjs  <https://github.com/moment/moment/>
// ver: 2.29.1// Available under MIT License 
// <https://github.com/moment/moment/blob/develop/LICENSE> 
// Includes moment-timezone <https://github.com/moment/moment-timezone/>
// ver: 0.5.32// Available under MIT License 
// <https://github.com/moment/moment-timezone/blob/develop/LICENSE>

window.Log=function(e){var t=this;t.mElementID=e,t.el=document.getElementById(e),t.el&&(t.el.innerHTML='<div class="logger-line">Start</div>'),t.escape=function(e){if(void 0===e)return"undefined";"object"==typeof e&&(e=JSON.stringify(e));var t=e,a=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/"/g,"&quot;"]];for(var r in a)t=t.replace(a[r][0],a[r][1]);return t},t.info=function(e){console.log(e),t.el&&(t.el.innerHTML+='<div class="logger-line info">'+t.escape(e)+"</div>")},t.error=function(e){console.error(e),t.el&&(t.el.innerHTML+='<div class="logger-line error">'+t.escape(e)+"</div>")},t.warn=function(e){console.warn(e),t.el&&(t.el.innerHTML+='<div class="logger-line warn">'+t.escape(e)+"</div>")}},window.CloudHelpers=window.CloudHelpers||{},window.CloudHelpers.RequestWrap=function(){this.request=function(e){var a=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token?r.setRequestHeader("Authorization","SkyVR "+e.token):e.access_token&&r.setRequestHeader("Authorization","Acc "+e.access_token),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void a.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?a.resolve(e):a.reject(e),delete r},r.onerror=function(){a.reject(r),delete r},e.data?r.send(e.data):r.send(),a},this.destroy=function(){this.isRequestAnswerAlowed=0}},CloudHelpers.parseUri=function(e){var t={},a=(t.source=e).split("/");t.protocol=a[0],t.protocol=t.protocol.slice(0,t.protocol.length-1),t.protocol=t.protocol.toLowerCase(),e=e.slice(t.protocol.length+3),"http"==t.protocol&&(t.port=80),"https"==t.protocol&&(t.port=443);var r=e.indexOf("/");r=-1!=r?r:e.length;var n=e.indexOf("?");n=-1!=n?n:e.length;var o=Math.min(r,n),i=e.substring(0,o);e=e.slice(o);for(var s="";-1!=i.indexOf("@");)s+=i.substring(0,i.indexOf("@")+1),i=i.slice(i.indexOf("@")+1);if(""!=s)if(-1!=s.indexOf(":")){var l=s.split(":");t.user=l[0],t.password=l[1],t.password=t.password.substring(0,t.password.length-1)}else t.user=s;if(-1!=i.indexOf(":")){var c=new RegExp(".*:(\\d+)$","g").exec(i);c&&1<c.length&&(t.port=parseInt(c[1],10),i=i.slice(0,i.length-c[1].length-1))}return t.host=i,-1!=e.indexOf("?")?(t.query=e.substring(e.indexOf("?"),e.length),t.path=e.substring(0,e.indexOf("?"))):(t.query="",t.path=e),t.path&&""!=t.path||(t.path="/"),t},CloudHelpers.promise=function(){var t={completed:!1,failed:!1,successed:!1,done:function(e){return t.done_callback=e,t.completed&&"function"==typeof t.done_callback&&t.successed&&t.done_callback.apply(this,t.result_arguments),t},fail:function(e){return t.fail_callback=e,t.completed&&"function"==typeof t.fail_callback&&t.failed&&t.fail_callback.apply(this,t.error_arguments),t},resolve:function(){t.completed||(t.result_arguments=arguments,"function"==typeof t.done_callback&&t.done_callback.apply(this,t.result_arguments)),t.successed=!0,t.completed=!0},reject:function(){t.completed||(t.error_arguments=arguments,"function"==typeof t.fail_callback&&t.fail_callback.apply(this,t.error_arguments)),t.failed=!0,t.completed=!0}};return t},CloudHelpers.waitPromises=function(e){var t=CloudHelpers.promise(),a=e.length,r=[];function n(e){r.push(e),r.length==a&&t.resolve(r)}for(var o in e)e[o].done(n).fail(n);return t},CloudHelpers.request=function(e){var a=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token&&r.setRequestHeader("Authorization","SkyVR "+e.token),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void a.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?a.resolve(e):a.reject(e),delete r},r.onerror=function(){a.reject(r),delete r},e.data?r.send(e.data):r.send(),a},CloudHelpers.request2=function(e){var a=CloudHelpers.promise(),r="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return r.open(e.type,e.url,!0),r.withCredentials=!0,e.contentType&&r.setRequestHeader("Content-Type",e.contentType),e.token&&r.setRequestHeader("Authorization","SkyVR "+e.token),e.access_token&&r.setRequestHeader("Authorization","Acc "+e.access_token),e.license_key&&r.setRequestHeader("Authorization","Lic "+e.license_key),r.onload=function(){var e="";if(""!=this.responseText)try{e=JSON.parse(this.responseText)}catch(e){return console.error(e),void a.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var t=this.status;200<=t&&t<300?a.resolve(e):a.reject(e),delete r},r.onerror=function(){a.reject(r),delete r},e.data?r.send(e.data):r.send(),a},CloudHelpers.requestJS=function(url,beforeEval){var p=CloudHelpers.promise(),xhr="onload"in new XMLHttpRequest?new XMLHttpRequest:new XDomainRequest;return xhr.open("GET",url,!0),xhr.onload=function(){var r="";if(""!=this.responseText)try{r=this.responseText}catch(e){return console.error(e),void p.reject(CloudReturnCode.ERROR_WRONG_RESPONSE)}var st=this.status;200<=st&&st<300?(beforeEval&&(r=beforeEval(r)),eval(r),p.resolve(r)):p.reject(r),delete xhr},xhr.onerror=function(){p.reject(xhr),delete xhr},xhr.send(),p},CloudHelpers.handleError=function(e,t,a){e.errorDetail&&404==e.status?t.reject(CloudReturnCode.ERROR_NOT_FOUND):e.errorDetail&&401==e.status?t.reject(CloudReturnCode.ERROR_NOT_AUTHORIZED):a?a(e,t):t.reject(e)},CloudHelpers.requestAsyncList=function(r,n,o){var i={meta:{limit:1e3,offset:0,total_count:-1},objects:[]};n.limit=i.meta.limit,n.offset=i.meta.offset,r(n).fail(function(e){o.reject(e)}).done(function(e){if(i.meta.total_count=e.meta.total_count,i.objects=i.objects.concat(e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)o.resolve(i);else{for(var t=[],a=i.meta.limit;a<i.meta.total_count;a+=i.meta.limit)n.offset=a,t.push(r(n));CloudHelpers.waitPromises(t).done(function(e){for(var t=0;t<e.length;t++)i.objects=i.objects.concat(e[t].objects);o.resolve(i)}).fail(function(e){o.reject(e)})}})},CloudHelpers.flashVersion=void 0,CloudHelpers.getFlashVersion=function(){try{try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{e.AllowScriptAccess="always"}catch(e){return"6,0,0"}}catch(e){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){}}return"0,0,0"},CloudHelpers.supportFlash=function(){return CloudHelpers.flashVersion||(CloudHelpers.flashVersion=CloudHelpers.getFlashVersion()),"0,0,0"!=CloudHelpers.flashVersion},CloudHelpers.useHls=function(){return CloudHelpers.isMobile()||!CloudHelpers.supportFlash()||CloudHelpers.containsPageParam("hls")},CloudHelpers.supportWebRTC=function(){return!!(window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection)},CloudHelpers.mapToUrlQuery=function(e){if(!e)return"";var t=[];for(var a in e)t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")},CloudHelpers.lang=function(){return CloudHelpers.sLang||CloudHelpers.locale()},CloudHelpers.locale=function(){if(langs=["en","ko","ru"],CloudHelpers.sLang="en",CloudHelpers.containsPageParam("lang")&&-1<=langs.indexOf(CloudHelpers.pageParams.lang))CloudHelpers.sLang=CloudHelpers.pageParams.lang;else if(navigator){var e="en";e=navigator.language?navigator.language.substring(0,2):e,e=navigator.browserLanguage?navigator.browserLanguage.substring(0,2):e,e=navigator.systemLanguage?navigator.systemLanguage.substring(0,2):e,e=navigator.userLanguage?navigator.userLanguage.substring(0,2):e,-1<=langs.indexOf(e)?CloudHelpers.sLang=e:console.warn("Unsupported lang "+e+", will be used default lang: "+CloudHelpers.sLang),CloudHelpers.sLang=-1<=langs.indexOf(e)?e:CloudHelpers.sLang}else CloudHelpers.sLang="en";return CloudHelpers.sLang},CloudHelpers.parsePageParams=function(){for(var e=window.location.search.slice(1).split("&"),t={},a=new RegExp("(.*)=([^&#]*)"),r=0;r<e.length;r++)""!=e[r].trim()&&(p=a.exec(e[r].trim()),null==p?t[decodeURIComponent(e[r].trim().replace(/\+/g," "))]="":t[decodeURIComponent(p[1].replace(/\+/g," "))]=decodeURIComponent(p[2].replace(/\+/g," ")));return t},CloudHelpers.pageParams=CloudHelpers.parsePageParams(),CloudHelpers.containsPageParam=function(e){return void 0!==CloudHelpers.pageParams[e]},CloudHelpers.keepParams=["lang","url","fcno","vendor","demo","messaging","hls","svcp_host","backwardDeactivateAfter","mobile","experimental_hls","page_id","preview","customswf"],CloudHelpers.changeLocationState=function(e){var t=[];for(var a in CloudHelpers.keepParams){var r=CloudHelpers.keepParams[a];CloudHelpers.containsPageParam(r)&&t.push(r+"="+encodeURIComponent(CloudHelpers.pageParams[r]))}for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));var o=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+window.location.host+window.location.pathname+"?"+t.join("&");try{window.history.pushState?window.history.pushState(e,document.title,o):console.error("window.history.pushState - function not found")}catch(e){console.error("changeLocationState: Could not change location to "+o)}CloudHelpers.pagePwindow.btoa("Hello, world"),arams=CloudHelpers.parsePageParams()},CloudHelpers.osname=function(){var e="unknown";return-1!=navigator.appVersion.indexOf("Win")&&(e="win"),-1!=navigator.appVersion.indexOf("Mac")&&(e="mac"),-1!=navigator.appVersion.indexOf("X11")&&(e="unix"),-1!=navigator.appVersion.indexOf("Linux")&&(e="linux"),e},CloudHelpers.isSafari=function(){var e=-1<window.navigator.userAgent.toLowerCase().indexOf("chrome"),t=-1<window.navigator.userAgent.toLowerCase().indexOf("safari");return!e&&t},CloudHelpers.isEdge=function(){return-1<window.navigator.userAgent.indexOf("Edge")},CloudHelpers.isChrome=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},CloudHelpers.isMobile=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},CloudHelpers.isIpV4=function(e){return null!=e.match(/^([0-9]{1,3}\.){3}[0-9]{1,3}/)},CloudHelpers.parseUTCTime=function(e){var t=(e=(e=(e=e.replace(new RegExp("-","g")," ")).replace(new RegExp("T","g")," ")).replace(new RegExp(":","g")," ")).split(" "),a=new Date;a.setUTCFullYear(parseInt(t[0],10)),a.setUTCMonth(parseInt(t[1],10)-1),a.setUTCDate(parseInt(t[2],10)),a.setUTCHours(parseInt(t[3],10)),a.setUTCMinutes(parseInt(t[4],10)),a.setUTCSeconds(parseInt(t[5],10));var r=a.getTime();return r-=r%1e3},CloudHelpers.formatUTCTime=function(e){var t=new Date;return t.setTime(e),t.getUTCFullYear()+"-"+("00"+(t.getUTCMonth()+1)).slice(-2)+"-"+("00"+t.getUTCDate()).slice(-2)+"T"+("00"+t.getUTCHours()).slice(-2)+":"+("00"+t.getUTCMinutes()).slice(-2)+":"+("00"+t.getUTCSeconds()).slice(-2)},CloudHelpers.ONE_SECOND=1e3,CloudHelpers.ONE_MINUTE=6e4,CloudHelpers.ONE_HOUR=36e5,CloudHelpers.getCurrentTimeUTC=function(){return Date.now()},CloudHelpers.isLocalFile=function(){return"https:"!=window.location.protocol&&"http:"!=window.location.protocol},CloudHelpers.combineURL=function(e,t,a){""==t&&(t=void 0),""==a&&(a=void 0);var r=CloudHelpers.parseUri(e),n=r.protocol+"://";return(t||a)&&(n+=t,a&&(n+=":"+a),n+="@"),n+=r.host+(""!=r.port?":"+r.port:"")+r.path},CloudHelpers.validIpV4=function(e){for(var t=e.split("."),a=0;a<4;a++){var r=parseInt(t[a],10);if(r<0||255<r)return!1}return!0},CloudHelpers.convertIpV4ToInt=function(e){for(var t=e.split("."),a=0,r=1,n=3;0<=n;n--)a+=parseInt(t[n],10)*r,r*=256;return a},CloudHelpers.isValidHostID=function(e){var t=CloudHelpers.parseUri(e);return"localhost"==t.host||(!(CloudHelpers.isIpV4(t.host)&&!CloudHelpers.validIpV4(t.host))||(console.error("Address "+t.host+" - invalid address"),!1))},CloudHelpers.isLocalUrlOrIP=function(e){var t=CloudHelpers.parseUri(e);if("localhost"==t.host)return!0;if(CloudHelpers.isIpV4(t.host)){if(!CloudHelpers.validIpV4(t.host))return console.error("Address "+t.host+" - invalid address"),!0;var a=CloudHelpers.convertIpV4ToInt(t.host),r=[];for(var n in r.push({from:"127.0.0.0",to:"127.255.255.255",comment:"localhost addresses"}),r){var o=CloudHelpers.convertIpV4ToInt(r[n].from),i=CloudHelpers.convertIpV4ToInt(r[n].to),s=r[n].comment;if(o<=a&&a<=i)return console.error(s),!0}}return!1},CloudHelpers.isPublicUrl=function(e){var t=CloudHelpers.parseUri(e);if("localhost"==t.host)return!1;if(CloudHelpers.isIpV4(t.host)){if(!CloudHelpers.validIpV4(t.host))return console.error("Address "+t.host+" - invalid address"),!1;var a=CloudHelpers.convertIpV4ToInt(t.host),r=[];for(var n in r.push({from:"10.0.0.0",to:"10.255.255.255",comment:"single class A network"}),r.push({from:"172.16.0.0",to:"172.31.255.255",comment:"16 contiguous class B network"}),r.push({from:"192.168.0.0",to:"192.168.255.255",comment:"256 contiguous class C network"}),r.push({from:"169.254.0.0",to:"169.254.255.255",comment:"Link-local address also refered to as Automatic Private IP Addressing"}),r.push({from:"127.0.0.0",to:"127.255.255.255",comment:"localhost addresses"}),r){var o=CloudHelpers.convertIpV4ToInt(r[n].from),i=CloudHelpers.convertIpV4ToInt(r[n].to),s=r[n].comment;if(o<=a&&a<=i)return console.error(s),!1}}return!0},CloudHelpers.isFrame=function(){try{return window.self!==window.top}catch(e){return!0}},CloudHelpers.isFireFox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")},CloudHelpers.isAndroid=function(){return!!navigator.userAgent.match(/Android/i)},CloudHelpers.isIOS=function(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))},CloudHelpers.isWindowsPhone=function(){return!!navigator.userAgent.match(/Windows Phone/i)},CloudHelpers.isBlackBerry=function(){return!!navigator.userAgent.match(/BlackBerry/i)},CloudHelpers.splitUserInfoFromURL=function(e){var t=CloudHelpers.parseUri(e);return{url:t.protocol+"://"+t.host+(t.port?":"+t.port:"")+t.path,login:t.user,password:t.password}},CloudHelpers.getAbsolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop};if(e.offsetParent){var a=CloudHelpers.getAbsolutePosition(e.offsetParent);t.x+=a.x,t.y+=a.y}return t},CloudHelpers.cache=CloudHelpers.cache||{},CloudHelpers.cache.timezones=CloudHelpers.cache.timezones||{},CloudHelpers.getOffsetTimezone=function(e){if(!moment)return console.warn("Requrired moment.js library"),0;if(null==CloudHelpers.cache.timezones[e]){var t=new Date;if(e&&""!=e){var a=moment(t).tz(e).format("Z"),r=a[0];(r<"0"||"9"<r)&&(a=a.substring(1));var n="-"==r?-1:1,o=a.split(":");a=n*(60*parseInt(o[0],10)+parseInt(o[1],10)),CloudHelpers.cache.timezones[e]=6e4*a}else CloudHelpers.cache.timezones[e]=0}return CloudHelpers.cache.timezones[e]},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},CloudHelpers.autoPlayAllowed=!0,CloudHelpers.checkAutoplay=function(e){e=e||function(){};var t=new CloudHelpers.promise;t.done(function(){console.log("checkAutoplay: done"),e(CloudHelpers.autoPlayAllowed)}),t.fail(function(){console.log("checkAutoplay: waiting"),e(CloudHelpers.autoPlayAllowed)});var a=null,r=document.createElement("div");r.innerHTML="<video muted></video>",(r=r.children[0]).addEventListener("waiting",function(){console.log("checkAutoplay: waiting, ",a),null==a&&(CloudHelpers.autoPlayAllowed=!0,t.resolve(),r.remove())},!1);var n=r.play(),o="";window.Promise&&(o=window.Promise.toString()),-1!==o.indexOf("function Promise()")||-1!==o.indexOf("function ZoneAwarePromise()")?n.catch(function(e){if("NotAllowedError"==e.name)console.error("error.name:","NotAllowedError"),a=!1,CloudHelpers.autoPlayAllowed=a,t.reject();else if(t.reject(),"AbortError"!=e.name)throw console.error("checkAutoplay: happened something else"),e;r.remove()}):(console.error("checkAutoplay could not work in your browser"),t.reject(),e(CloudHelpers.autoPlayAllowed))},"undefined"!=typeof document&&CloudHelpers.checkAutoplay(function(e){console.log("checkautoplay: autoplay2 ",e)}),CloudHelpers.humanFileSize=function(e){if(e<1024)return e+" B";for(var t=-1;++t,1024<=(e/=1024););return e.toFixed(1)+" "+["kB","MB","GB","TB","PB","EB","ZB","YB"][t]},CloudHelpers.base64_encode=function(e){return window.btoa(e)},CloudHelpers.base64_decode=function(e){return window.atob(e)},CloudHelpers.copy=function(e){if(null==e||"object"!=typeof e)return console.error("Expected object"),e;var t=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t},CloudHelpers.unpackAccessToken=function(e){var t={host:"web.skyvr.videoexpertsgroup.com"};try{var a=atob(e);if(a=JSON.parse(a),console.log("Token: ",a),!a.token)return console.error('Invalid access token format (missing "token")'),null;if(!a.access)return console.error('Invalid access token format (missing "access")'),null;a.token&&a.camid&&a.access&&""!==a.token&&""!==a.camid&&""!==a.access&&(t.share_token=a.token,t.camid=a.camid,t.access=a.access),a.api&&(t.host=a.api),a.api_p&&(t.api_port=a.api_p),a.api_security_port&&(t.api_security_port=a.api_security_port)}catch(e){return console.error("Invalid access token format"),null}if(t.base_url=t.host,"web.skyvr.videoexpertsgroup.com"==t.host)t.base_url="https://"+t.host;else if("https:"===location.protocol)t.base_url="https://"+t.host,null!=t.api_secutiry_port?(t.base_url+=":"+t.api_secutiry_port,t.port=t.api_secutiry_port):t.port=443;else{if("http:"!==location.protocol&&"file:"!==location.protocol)return console.error("Invalid protocol"),null;t.base_url="http://"+t.host,null!=self.api_port?(t.base_url+=":"+t.api_port,t.port=t.api_port):t.port=80}return t},CloudHelpers.createCallbacks=function(){return new function(){var n={};console.log(this);var a=this;a.executeCallbacks=function(e,t){function a(e,t,a){setTimeout(function(){n[e](t,a)},1)}for(var r in n)a(r,e,t)},a.removeCallback=function(e){delete n[e]},a.addCallback=function(e,t){"function"==typeof t?(n[e]&&(console.warn(e+" - already registered callback, will be removed before add"),a.removeCallback(e)),n[e]=t):console.error("Second parameter expected function")}}},CloudHelpers.compareVersions=function(e,t){t=t||"0.0.0";var a=(e=e||"0.0.0").split("."),r=t.split(".");if(3==a.length&&3==r.length){for(var n=0;n<3;n++)if(a[n]=parseInt(a[n],10),r[n]=parseInt(r[n],10),a[n]!=r[n])return r[n]-a[n];return 0}console.error("[CloudHelpers.compareVersions] could not compare versions ",e,t)},window.CloudAPI=function(e,t){var s=this;s.token=e.token,s.token_expire=e.expire,s.token_expireUTC=Date.parse(e.expire+"Z"),s.host=t,s.token_type=e.type,s.requestWrap=new CloudHelpers.RequestWrap,s.isShareToken=function(){return"share"==s.token_type},s.endpoints={api:s.host+"api/v2/",cameras:s.host+"api/v2/cameras/",admin_cameras:s.host+"api/v2/admin/cameras/",camsess:s.host+"api/v2/camsess/",server:s.host+"api/v2/server/",account:s.host+"api/v2/account/",cmngrs:s.host+"api/v2/cmngrs/",storage:s.host+"api/v2/storage/",clips:s.host+"api/v2/storage/clips/",channels:s.host+"api/v3/channels/"},s.endpoints_v4={api:s.host+"api/v4/",live_watch:s.host+"api/v4/live/watch/"},s._getCloudToken=function(){return s.token},s.updateApiToken=function(){return s.requestWrap.request({url:s.endpoints.account+"token/api/",type:"GET",token:s._getCloudToken()})},s.isShareToken()||s.updateApiToken().done(function(e){console.warn("[CloudConnection] Cloud Token Api refreshed"),s.token=e.token,s.token_expire=e.expire,s.token_expireUTC=Date.parse(e.expire+"Z"),clearInterval(s.updateTokenInterval),s.updateTokenInterval=setInterval(function(){s.token_expireUTC-(new Date).getTime()<12e5?s.updateApiToken().done(function(e){console.warn("[CloudConnection] Cloud Token api refreshed"),s.token=e.token,s.token_expire=e.expire,s.token_expireUTC=Date.parse(e.expire+"Z")}):console.log("[CloudConnection] Cloud Token is live")},3e5)}),s.dispose=function(){delete s.requestWrap,s.token=null,clearInterval(s.updateTokenInterval)},s.createCamera=function(e){return s.requestWrap.request({url:s.endpoints.cameras+"?detail=detail",type:"POST",token:s._getCloudToken(),data:JSON.stringify(e),contentType:"application/json"})},s.camerasList=function(e){e=e||{},s.isShareToken()&&(e.token=s._getCloudToken());var t=CloudHelpers.mapToUrlQuery(e);return s.requestWrap.request({url:s.endpoints.cameras+"?"+t,type:"GET",token:s._getCloudToken(),contentType:"application/json"})},s.getCameraList=s.camerasList,s.deleteCamera=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/",type:"DELETE",token:s._getCloudToken()})},s.getCamera=function(e,t){(t=t||{}).detail="detail",s.isShareToken()&&(t.token=s._getCloudToken());var a=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:s.endpoints.cameras+e+"/?"+a,type:"GET",token:s._getCloudToken()})},s.getCamera2=function(e,t){t=t||{},s.isShareToken()&&(t.token=s._getCloudToken());var a=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:s.endpoints.cameras+e+"/?"+a,type:"GET",token:s._getCloudToken()})},s.cameraUsage=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/usage/",type:"GET",token:s._getCloudToken()})},s.updateCamera=function(e,t){t=t||{},s.isShareToken()&&(t.token=s._getCloudToken());var a=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:s.endpoints.cameras+e+"/?"+a,type:"PUT",token:s._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},s.cameraLiveUrls=function(e){var t={},a=s.endpoints.cameras+e+"/live_urls/?";s.isShareToken()&&(t.token=s._getCloudToken(),a=s.endpoints_v4.live_watch+"?");var r=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:a+r,type:"GET",token:s._getCloudToken(),data:JSON.stringify(t)})},s.cameraStreamUrls_webrtc=function(e){var t={},a=s.endpoints.cameras+e+"/stream_urls/?";t.proto="webrtc",s.isShareToken()&&(t.token=s._getCloudToken());var r=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:a+r,type:"GET",token:s._getCloudToken(),data:JSON.stringify(t)})},s.getServerTime=function(){var a=CloudHelpers.promise();return s.requestWrap.request({url:s.endpoints.api+"server/time/",type:"GET"}).done(function(e){var t=CloudHelpers.getCurrentTimeUTC();s.diffServerTime=Date.parse(e.utc+"Z")-t,a.resolve(e)}).fail(function(e){a.reject(e)}),a},s.getAccountInfo=function(){return s.requestWrap.request({url:s.endpoints.account,type:"GET",token:s._getCloudToken()})},s.getAccountCapabilities=function(){return s.requestWrap.request({url:s.endpoints.account+"capabilities/",type:"GET",token:s._getCloudToken()})},s.cameraMediaStreams=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/media_streams/",type:"GET",token:s._getCloudToken()})},s.updateCameraMediaStreams=function(e,t){return s.requestWrap.request({url:s.endpoints.cameras+e+"/media_streams/",type:"PUT",data:JSON.stringify(t),contentType:"application/json",token:s._getCloudToken()})},s.cameraPreview=function(e){var t={};s.isShareToken()&&(t.token=s._getCloudToken());var a=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:s.endpoints.cameras+e+"/preview/?"+a,type:"GET",token:s._getCloudToken()})},s.cameraUpdatePreview=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/preview/update/",type:"POST",token:s._getCloudToken()})},s.cameraSendPtz=function(e,t){t=t||{};var a={};s.isShareToken()&&(a.token=s._getCloudToken());var r=CloudHelpers.mapToUrlQuery(a);return s.requestWrap.request({url:s.endpoints.cameras+e+"/send_ptz/?"+r,type:"POST",token:s._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},s.cameraPtzExecute=function(e,t){t=t||{};var a={};s.isShareToken()&&(a.token=s._getCloudToken());var r=CloudHelpers.mapToUrlQuery(a);return s.requestWrap.request({url:s.endpoints.cameras+e+"/ptz/execute/?"+r,type:"POST",token:s._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},s.cameraPtz=function(e){var t={};s.isShareToken()&&(t.token=s._getCloudToken());var a=CloudHelpers.mapToUrlQuery(t);return s.requestWrap.request({url:s.endpoints.cameras+e+"/ptz/?"+a,type:"GET",token:s._getCloudToken()})},s.storageRecords=function(e,t,a){var r=CloudHelpers.promise(),n={camid:e,limit:1e3,offset:0,start:t};return a&&(n.end=a),s.isShareToken()&&(n.token=s._getCloudToken()),CloudHelpers.requestAsyncList(function(e){var t=CloudHelpers.mapToUrlQuery(e);return s.requestWrap.request({url:s.endpoints.storage+"data/?"+t,type:"GET",token:s._getCloudToken()})},n,r),r},s.storageRecordsFirst=function(e,t,a){CloudHelpers.promise();var r={camid:e,limit:a,offset:0,start:t};r.limit=a,s.isShareToken()&&(r.token=s._getCloudToken());var n=CloudHelpers.mapToUrlQuery(r);return s.requestWrap.request({url:s.endpoints.storage+"data/?"+n,type:"GET",token:s._getCloudToken()})},s.storageTimeline=function(e,t,a,r){var n={start:t,end:a,slices:r};s.isShareToken()&&(n.token=s._getCloudToken());var o=CloudHelpers.mapToUrlQuery(n);return s.requestWrap.request({url:s.endpoints.storage+"timeline/"+e+"/?"+o,type:"GET",token:s._getCloudToken()})},s.storageActivity=function(e,t){var a={camid:e};t&&(a.daysincamtz=""),s.isShareToken()&&(a.token=s._getCloudToken());var r=CloudHelpers.mapToUrlQuery(a);return s.requestWrap.request({url:s.endpoints.storage+"activity/?"+r,type:"GET",token:s._getCloudToken()})},s.resetCameraManager=function(e,t){return s.isShareToken()?(t=t||{},s.requestWrap.request({url:s.endpoints.cmngrs+e+"/reset/?token="+s._getCloudToken(),type:"POST",data:JSON.stringify(t),contentType:"application/json"})):(t=t||{},s.requestWrap.request({url:s.endpoints.cmngrs+e+"/reset/",type:"POST",token:s._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"}))},s.updateCameraManager=function(e,t){return t=t||{},s.requestWrap.request({url:s.endpoints.cmngrs+e+"/",type:"PUT",token:s._getCloudToken(),data:JSON.stringify(t),contentType:"application/json"})},s.getCamsessList=function(e){var t=CloudHelpers.mapToUrlQuery(e);return s.requestWrap.request({url:s.endpoints.camsess+"?"+t,type:"GET",token:s._getCloudToken(),contentType:"application/json"})},s.getCamsess=function(e){return s.requestWrap.request({url:s.endpoints.camsess+e+"/?detail=detail",type:"GET",token:s._getCloudToken(),contentType:"application/json"})},s.getCamsessRecords=function(e){return s.requestWrap.request({url:s.endpoints.camsess+e+"/records/",type:"GET",token:s._getCloudToken(),contentType:"application/json"})},s.deleteCamsess=function(e){return s.requestWrap.request({url:s.endpoints.camsess+e+"/",type:"DELETE",token:s._getCloudToken()})},s.creareCameraSharingToken=function(e,t,a){return t=t||"",s.requestWrap.request({url:s.endpoints.cameras+e+"/sharings/",type:"POST",data:JSON.stringify({camid:e,name:t,access:a}),contentType:"application/json",token:s._getCloudToken()})},s.updateCameraSharingToken=function(e,t,a){return(a=a||{}).camid=e,a.shid=t,s.requestWrap.request({url:s.endpoints.cameras+e+"/sharings/"+t+"/",type:"PUT",data:JSON.stringify(a),contentType:"application/json",token:s._getCloudToken()})},s.getCameraSharingTokensList=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/sharings/?detail=detail",type:"GET",token:s._getCloudToken()})},s.deleteCameraSharingToken=function(e,t){return s.requestWrap.request({url:s.endpoints.cameras+e+"/sharings/"+t+"/",type:"DELETE",token:s._getCloudToken()})},s.createClip=function(e,t,a,r,n,o){t=t||"",obj={},obj.camid=e,obj.source_camid=e,obj.start=a,obj.end=r,obj.wait_for_data=!0,void 0!==n&&(obj.delete_at=n);var i={};return i.url=s.endpoints.clips,i.type="POST",i.data=JSON.stringify(obj),i.contentType="application/json",void 0!==o?i.access_token=o:i.token=s._getCloudToken(),s.requestWrap.request(i)},s.getClip=function(e,t){var a={};return a.url=s.endpoints.clips+e+"/",a.type="GET",void 0!==t?a.access_token=t:a.token=s._getCloudToken(),s.requestWrap.request(a)},s.getChannels=function(){return s.requestWrap.request({url:s.endpoints.channels,type:"GET",token:s._getCloudToken()})},s.getCameraStreamingURLs=function(e){return s.requestWrap.request({url:s.endpoints.cameras+e+"/stream_urls/",type:"GET",token:s._getCloudToken()})}},window.SkyVR=window.CloudAPI,CloudAPI.config={url:"",url_cameras:"",url_api:"",cameraID:"",user_name:"",vendor:""},CloudAPI.setToCookie=function(e,t){var a=new Date((new Date).getTime()+6048e5);document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+"; path=/; expires="+a.toUTCString()},CloudAPI.getFromCookie=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):""},CloudAPI.removeFromCookie=function(e){document.cookie=encodeURIComponent(e)+"=; path=/;"},CloudAPI.cache={cameras:{},timezones:{}},CloudAPI.cache.cameraInfo=function(e){return e?CloudAPI.cache.cameras[e]:CloudAPI.isCameraID()?CloudAPI.cache.cameras[CloudAPI.cameraID()]:void 0},CloudAPI.cache.getCameraInfo=CloudAPI.cache.cameraInfo,CloudAPI.cache.mergeObjects=function(e,t){for(var a in t){var r=typeof t[a];"boolean"==r||"string"==r||"number"==r?e[a]!=t[a]&&(e[a]&&(console.log("Changed "+a),CloudAPI.events.trigger("CAMERA_INFO_CHANGED",{name:a,new_value:t[a]})),e[a]=t[a]):Array.isArray(t[a])?e[a]=t[a]:"object"==r&&(e[a]||(e[a]={}),e[a]=CloudAPI.cache.mergeObjects(e[a],t[a]))}return e},CloudAPI.cache.updateCameraInfo=function(e){var t=e.id;CloudAPI.cache.cameras[t]||(CloudAPI.cache.cameras[t]={}),CloudAPI.cache.cameras[t]=CloudAPI.cache.mergeObjects(CloudAPI.cache.cameras[t],e)},CloudAPI.cache.setCameraInfo=function(e){var t=e.id;null==CloudAPI.cache.cameras[t]&&(CloudAPI.cache.cameras[t]={});var a=!(!e.p2p_streaming||1!=e.p2p_streaming),r=CloudAPI.cache.cameras[t];return CloudAPI.cache.cameras[t]=CloudAPI.cache.mergeObjects(r,e),CloudAPI.cache.cameras[t].lastTimeUpdated=Date.now(),a},CloudAPI.cache.setP2PSettings=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].p2p=t,CloudAPI.cache.cameras[e].p2p_settings=CloudAPI.cache.cameras[e].p2p},CloudAPI.cache.setMemoryCard=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].memory_card=t},CloudAPI.cache.setPtzCaps=function(e,t){null==CloudAPI.cache.cameras[e]&&(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].ptz=t},CloudAPI.cache.updateCameraAudio=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].audio||(CloudAPI.cache.cameras[e].audio={}),CloudAPI.cache.cameras[e].audio=CloudAPI.cache.mergeObjects(CloudAPI.cache.cameras[e].audio,t)},CloudAPI.cache.cameraAudio=function(e){return e=e||CloudAPI.cameraID(),CloudAPI.cache.cameras[e]?CloudAPI.cache.cameras[e].audio:{}},CloudAPI.cache.updateCameraVideo=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].video||(CloudAPI.cache.cameras[e].video={});var a=CloudAPI.cache.cameras[e].video;CloudAPI.cache.cameras[e].video=CloudAPI.cache.mergeObjects(a,t)},CloudAPI.cache.cameraVideo=function(e){return e=e||CloudAPI.cameraID(),CloudAPI.cache.cameras[e]?CloudAPI.cache.cameras[e].video:{}},CloudAPI.cache.cameraVideoStreamName=function(e){if(e=e||CloudAPI.cameraID(),!CloudAPI.cache.cameras[e])return{};var t=CloudAPI.cache.cameras[e].video;if(t.streams)for(var a in t.streams)return a},CloudAPI.cache.cameraVideoStreams=function(e){if(e=e||CloudAPI.cameraID(),!CloudAPI.cache.cameras[e])return{};var t=CloudAPI.cache.cameras[e].video;return t.streams?t.streams:void 0},CloudAPI.cache.setLimits=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].limits=t},CloudAPI.cache.updateCameraVideoStream=function(e,t,a){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].video||(CloudAPI.cache.cameras[e].video={}),CloudAPI.cache.cameras[e].video.streams||(CloudAPI.cache.cameras[e].video.streams={}),CloudAPI.cache.cameras[e].video.streams[t]||(CloudAPI.cache.cameras[e].video.streams[t]={});var r=CloudAPI.cache.cameras[e].video.streams[t];CloudAPI.cache.cameras[e].video.streams[t]=CloudAPI.cache.mergeObjects(r,a)},CloudAPI.cache.setAudioStream=function(e,t,a){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].audio||(CloudAPI.cache.cameras[e].audio={}),CloudAPI.cache.cameras[e].audio.streams||(CloudAPI.cache.cameras[e].audio.streams={}),CloudAPI.cache.cameras[e].audio.streams[t]=a},CloudAPI.cache.setMediaStreams=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].media_streams=t},CloudAPI.cache.updateEventProcessingEventsMotion=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].event_processing||(CloudAPI.cache.cameras[e].event_processing={}),CloudAPI.cache.cameras[e].event_processing.events||(CloudAPI.cache.cameras[e].event_processing.events={}),CloudAPI.cache.cameras[e].event_processing.events.motion||(CloudAPI.cache.cameras[e].event_processing.events.motion={});var a=CloudAPI.cache.cameras[e].event_processing.events.motion;CloudAPI.cache.cameras[e].event_processing.events.motion=CloudAPI.cache.mergeObjects(a,t)},CloudAPI.cache.updateCameraEventProcessingEventsSound=function(e,t){CloudAPI.cache.cameras[e]||(CloudAPI.cache.cameras[e]={}),CloudAPI.cache.cameras[e].event_processing||(CloudAPI.cache.cameras[e].event_processing={}),CloudAPI.cache.cameras[e].event_processing.events||(CloudAPI.cache.cameras[e].event_processing.events={}),CloudAPI.cache.cameras[e].event_processing.events.sound||(CloudAPI.cache.cameras[e].event_processing.events.sound={});var a=CloudAPI.cache.cameras[e].event_processing.events.sound;CloudAPI.cache.cameras[e].event_processing.events.sound=CloudAPI.cache.mergeObjects(a,t)},CloudAPI.generateNewLocation=function(e){var t=[];return CloudHelpers.containsPageParam("lang")&&t.push("lang="+encodeURIComponent(CloudAPI.pageParams.lang)),CloudHelpers.containsPageParam("vendor")&&t.push("vendor="+encodeURIComponent(CloudAPI.pageParams.vendor)),CloudHelpers.containsPageParam("mobile")&&t.push("mobile="+encodeURIComponent(CloudAPI.pageParams.mobile)),t.push("p="+encodeURIComponent(e)),"?"+t.join("&")},CloudAPI.setURL=function(e){if(CloudAPI.config.url!=e){CloudAPI.config.url=e,CloudAPI.config.url_api=e+"api/v2/",CloudAPI.config.url_cameras=e+"api/v2/cameras/",CloudAPI.config.url_admin_cameras=e+"api/v2/admin/cameras/",CloudAPI.config.url_camsess=e+"api/v2/camsess/",CloudAPI.config.url_server=e+"api/v2/server/",CloudAPI.config.url_account=e+"api/v2/account/",CloudAPI.config.url_cmngrs=e+"api/v2/cmngrs/",CloudAPI.config.url_storage=e+"api/v2/storage/",CloudAPI.config.url_clips=e+"api/v2/storage/clips/",CloudAPI.config.anonToken={token:"",type:"anon",expire:"",expireTimeUTC:0},localStorage.getItem("SkyVR_anonToken")&&(CloudAPI.config.anonToken=JSON.parse(localStorage.getItem("SkyVR_anonToken"))),CloudAPI.config.apiToken={token:"",type:"api",expire:"",expireTimeUTC:0},CloudAPI.config.shareToken={};var t=CloudAPI.getFromStorage("SkyVR_apiToken");if(t){var a=JSON.parse(t);a.expireTimeUTC>Date.now()&&(CloudAPI.config.apiToken=a)}CloudAPI.setToStorage("CloudAPI_svcp_host",e)}},CloudAPI.isExpiredApiToken=function(){return!CloudAPI.config.apiToken.expireTimeUTC||!(CloudAPI.config.apiToken.expireTimeUTC>Date.now())},CloudAPI.applyApiToken=function(){$.ajaxSetup({crossDomain:!0,cache:!1,beforeSend:function(e,t){CloudAPI.config.apiToken&&CloudAPI.config.apiToken.token&&e.setRequestHeader("Authorization","SkyVR "+CloudAPI.config.apiToken.token)}})},CloudAPI.enable401handler=function(){},CloudAPI.disable401handler=function(){$.ajaxSetup({error:function(e,t,a){}})},CloudAPI.printStack=function(){var e=new Error;console.error(e.stack)},CloudAPI.PAGE_SIGNIN="signin",CloudAPI.hasAccess=function(e,t){if(SkyUI.isDemo())return!0;if(!e)return!1;if(!e.access)return!0;var a=!1;for(var r in e.access)e.access[r]==t&&(a=!0);return a},CloudAPI.hasAccessSettings=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessMotionDetection=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all")||CloudAPI.hasAccess(e,"ptz"))},CloudAPI.hasAccessClips=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"clipplay")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"cplay")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessLive=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"ptz")||CloudAPI.hasAccess(e,"live")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessPlayback=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"play")||CloudAPI.hasAccess(e,"watch")||CloudAPI.hasAccess(e,"splay")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessMakeClip=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"clipping")||CloudAPI.hasAccess(e,"all"))},CloudAPI.hasAccessBackAudio=function(e){return!!SkyUI.isDemo()||(e=e||CloudAPI.cache.cameraInfo(),CloudAPI.hasAccess(e,"all")||CloudAPI.hasAccess(e,"backaudio"))},CloudAPI.handleNothing=function(e){},CloudAPI.handleNothingError=function(e,t,a){},CloudAPI.handleError=function(e,t,a){console.error(a)},CloudAPI.parseUri=function(e){function o(e){for(var r=o.options,t=r.parser[r.strictMode?"strict":"loose"].exec(e),n={},a=14;a--;)n[r.key[a]]=t[a]||"";return n[r.q.name]={},n[r.key[12]].replace(r.q.parser,function(e,t,a){t&&(n[r.q.name][t]=a)}),n}return o.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},o(e)},CloudAPI.logout=function(e){$.ajax({url:CloudAPI.config.url_account+"logout/",type:"POST",success:e,error:CloudAPI.handleError})},CloudAPI.cameraVideoStream=function(t){var a=$.Deferred();if(!CloudAPI.isCameraID())return a.reject(),a;var r=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/streams/"+t+"/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraVideoStream(r,t,e),a.resolve(e)}).fail(function(){a.reject()}),a},CloudAPI.cameraLimits=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var e=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+e+"/limits/",type:"GET"}).done(function(e){CloudAPI.cache.setLimits(CloudAPI.cameraID(),e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraEventProcessingEventsMotion=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+a+"/event_processing/events/motion/",type:"GET"}).done(function(e){CloudAPI.cache.updateEventProcessingEventsMotion(a,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraEventProcessingEventsMotion=function(e){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+a+"/event_processing/events/motion/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){CloudAPI.cache.updateEventProcessingEventsMotion(a,e),t.resolve()}).fail(function(){t.reject()}),t},CloudAPI.cameraEventProcessingEventsSound=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+a+"/event_processing/events/sound/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraEventProcessingEventsSound(a,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraEventProcessingEventsSound=function(e){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+a+"/event_processing/events/sound/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(){CloudAPI.cache.updateCameraEventProcessingEventsSound(a,e),t.resolve()}).fail(function(){t.reject()}),t},CloudAPI.updateCameraVideoStream=function(e,t){var a=$.Deferred();if(!CloudAPI.isCameraID())return a.reject(),a;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/streams/"+e+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(){console.log("[CLOUDAPI] [CLOUDAPI] Updated video/streams/"+e+" in cache for "+r),CloudAPI.cache.updateCameraVideoStream(r,e,t),a.resolve()}).fail(function(){a.reject()}),a},CloudAPI.setVBRQuality=function(e,t,a,r){if(CloudAPI.isCameraID()){a=null==a?CloudAPI.handleNothing:a,r=null==r?CloudAPI.handleError:r;var n={};n.vbr_quality=e,n.vbr=!0,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/video/streams/"+t+"/",type:"PUT",success:a,error:a,data:JSON.stringify(n),contentType:"application/json"})}},CloudAPI.formatMemoryCard=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var e=CloudAPI.config.cameraID;return $.ajax({url:CloudAPI.config.url_cameras+e+"/format_memory_card/",type:"POST"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraMemoryCard=function(t){var a=$.Deferred();return(t=t||CloudAPI.config.cameraID)?$.ajax({url:CloudAPI.config.url_cameras+t+"/memory_card/",type:"GET"}).done(function(e){CloudAPI.cache.setMemoryCard(t,e),a.resolve(e)}).fail(function(){CloudAPI.cache.setMemoryCard(t,{status:"none"}),a.reject()}):a.reject(),a},CloudAPI.cameraWifi=function(){var t=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/wifi/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}):t.reject(),t},CloudAPI.cameraFirmwares=function(){var t=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/firmwares/?limit=1000",type:"GET",contentType:"application/json"}).done(function(e){t.resolve(e.objects)}).fail(function(){t.reject()}):t.reject(),t},CloudAPI.cameraFirmwaresUpgrade=function(e){var a=$.Deferred();if(!CloudAPI.isCameraID())return a.reject(),a;console.log("[CLOUDAPI] upgrade firmware to version: "+e);var t={};return t.version=e,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.config.cameraID+"/firmwares/upgrade/",type:"POST",data:JSON.stringify(t),contentType:"application/json"}).done(function(){a.resolve()}).fail(function(e,t){console.error("[CLOUDAPI] cameraFirmwaresUpgrade, "+t,e),a.reject()}),a},CloudAPI.accountInfo=function(){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_account,type:"GET",cache:!1}).done(function(e){CloudAPI.cache.account=e,t.resolve(e)}).fail(function(e){console.log("Fail "+CloudAPI.config.url_account),console.error(e),t.reject(e)}),t},CloudAPI.anonToken=function(){var t=$.Deferred(),e=Date.now(),a=CloudAPI.config.anonToken.expireTimeUTC-6e5,r=CloudAPI.config.anonToken.expireTimeUTC-3e5;return a<e&&e<r?($.ajaxSetup({crossDomain:!0,cache:!1,headers:{Authorization:"SkyVR "+CloudAPI.config.anonToken.token}}),t.resolve(CloudAPI.config.anonToken)):$.ajax({url:CloudAPI.config.url_account+"token/anon/",type:"GET"}).done(function(e){CloudAPI.config.anonToken.token=e.token,CloudAPI.config.anonToken.type=e.type,CloudAPI.config.anonToken.expire=e.expire,CloudAPI.config.anonToken.expireTimeUTC=Date.parse(e.expire+"Z"),CloudAPI.setToStorage("SkyVR_anonToken",JSON.stringify(CloudAPI.config.anonToken)),$.ajaxSetup({crossDomain:!0,cache:!1,headers:{Authorization:"SkyVR "+e.token}}),t.resolve(CloudAPI.config.anonToken)}).fail(function(){t.reject()}),t},CloudAPI.accountShare=function(e){return CloudAPI.cameraID(),$.ajax({url:CloudAPI.config.url_account+"share/",type:"POST",data:JSON.stringify(e),contentType:"application/json",cache:!1})},CloudAPI.capabilities=function(e,t){e=null==e?CloudAPI.handleNothing:e,t=null==t?CloudAPI.handleError:t,$.ajax({url:CloudAPI.config.url_api+"capabilities/",type:"GET",success:e,error:t})},CloudAPI.cameraInfo=function(t){var a=$.Deferred();return null==(t=t||CloudAPI.cameraID())?a.reject():$.ajax({url:CloudAPI.config.url_cameras+t+"/",type:"GET"}).done(function(e){CloudAPI.cache.cameras[e.id]&&!CloudAPI.cache.cameras[e.id].memory_card?(console.log("cameraInfo cahce has not memory card info for camid="+e.id),CloudAPI.cameraMemoryCard(e.id)):CloudAPI.cache.cameras[e.id]||(console.log("cameraInfo has not in cache for camid="+e.id),CloudAPI.cameraMemoryCard(e.id)),CloudAPI.cache.setCameraInfo(e)?CloudAPI.cameraP2PSettings(t).done(function(e){a.resolve(CloudAPI.cache.cameras[t])}).fail(function(){a.resolve(CloudAPI.cache.cameras[t])}):a.resolve(CloudAPI.cache.cameras[t])}).fail(function(){a.reject()}),a},CloudAPI.updateCamera=function(t){var a=$.Deferred();return CloudAPI.isCameraID()?$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(e){console.log("[CLOUDAPI] Updated camera in cache for "+CloudAPI.cameraID()),t.id=CloudAPI.cameraID(),CloudAPI.cache.updateCameraInfo(t),a.resolve(e)}).fail(function(){a.reject()}):a.reject(),a},CloudAPI.cameraMesaging=function(e){var t=$.Deferred();return null==(e=e||CloudAPI.cameraID())?t.reject():$.ajax({url:CloudAPI.config.url_cameras+e+"/raw_messaging/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.updateCameraAudio=function(t){var a=$.Deferred();if(!CloudAPI.isCameraID())return a.reject(),a;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/audio/",type:"PUT",data:JSON.stringify(t),contentType:"application/json"}).done(function(e){console.log("[CLOUDAPI] Updated audio in cache for "+r),CloudAPI.cache.updateCameraAudio(r,t),a.resolve(e)}).fail(function(){a.reject()}),a},CloudAPI.cameraAudio=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+a+"/audio/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraAudio(a,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.cameraVideo=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+a+"/video/",type:"GET"}).done(function(e){CloudAPI.cache.updateCameraVideo(a,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraVideo=function(t){var a=$.Deferred();if(!CloudAPI.isCameraID())return a.reject(),a;var r=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+r+"/video/",type:"PUT",contentType:"application/json",data:JSON.stringify(t)}).done(function(e){CloudAPI.cache.updateCameraVideo(r,t),a.resolve(e)}).fail(function(){a.reject()}),a},CloudAPI.setCameraVideo=function(e,t,a){if(CloudAPI.isCameraID())return t=t||CloudAPI.handleNothing,a=a||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/video/",type:"PUT",success:t,error:a,contentType:"application/json",data:JSON.stringify(e)})},CloudAPI.cameraMediaStreams=function(){var t=$.Deferred();if(!CloudAPI.isCameraID())return t.reject(),t;var a=CloudAPI.cameraID();return $.ajax({url:CloudAPI.config.url_cameras+a+"/media_streams/",type:"GET"}).done(function(e){CloudAPI.cache.setMediaStreams(a,e),t.resolve(e)}).fail(function(){t.reject()}),t},CloudAPI.updateCameraMediaStreams=function(e,t){var a=$.Deferred();return(t=t||CloudAPI.cameraID())?$.ajax({url:CloudAPI.config.url_cameras+t+"/media_streams/",type:"PUT",data:JSON.stringify(e),contentType:"application/json"}).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}):a.reject(),a},CloudAPI.cameraLiveUrls=function(e){var t=$.Deferred();return(e=e||CloudAPI.cameraID())?$.ajax({url:CloudAPI.config.url_cameras+e+"/live_urls/",type:"GET"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}):t.reject(),t},CloudAPI.cameraBackwardStart=function(){if(CloudAPI.isCameraID()){var e={};CloudAPI.config.backwardURL&&(e.url=CloudAPI.config.backwardURL,CloudAPI.config.tmpBackwardURL==CloudAPI.config.backwardURL?CloudAPI.config.tmpBackwardURLCount++:(CloudAPI.config.tmpBackwardURLCount=1,CloudAPI.config.tmpBackwardURL=CloudAPI.config.backwardURL),CloudAPI.isP2PStreaming()&&(console.log("[CLOUDAPI] Send (audio streaming) backward start: "+CloudAPI.config.backwardURL),$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/audio/backward/start/",type:"POST",success:CloudAPI.handleNothing,data:JSON.stringify(e),contentType:"application/json"})))}},CloudAPI.cameraBackwardStop=function(){if(CloudAPI.isCameraID()){var e={};if(CloudAPI.config.backwardURL){if(e.url=CloudAPI.config.backwardURL,CloudAPI.config.tmpBackwardURL==CloudAPI.config.backwardURL){if(0==CloudAPI.config.tmpBackwardURLCount)return;CloudAPI.config.tmpBackwardURLCount--}CloudAPI.isP2PStreaming()&&(console.log("[CLOUDAPI] Send (audio streaming) backward stop: "+CloudAPI.config.backwardURL),$.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/audio/backward/stop/",type:"POST",success:CloudAPI.handleNothing,data:JSON.stringify(e),contentType:"application/json"}))}}},CloudAPI.cameraSchedule=function(){if(CloudAPI.isCameraID())return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/schedule/",type:"GET",cache:!1})},CloudAPI.updateCameraSchedule=function(e){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/schedule/",type:"PUT",data:JSON.stringify(e),cache:!1,contentType:"application/json"})},CloudAPI.hasAccessCameraPreview=function(e){var t=CloudAPI.cache.cameraInfo(e);return!!t&&(CloudAPI.hasAccess(t,"live")||CloudAPI.hasAccess(t,"all")||CloudAPI.hasAccess(t,"ptz"))},CloudAPI.cameraPreview=function(e,t,a){return t=null==t?CloudAPI.handleNothing:t,a=null==a?CloudAPI.handleError:a,$.ajax({url:CloudAPI.config.url_cameras+e+"/preview/",type:"GET",success:t,error:a})},CloudAPI.hasAccessCameraUpdatePreview=function(e){var t=CloudAPI.cache.cameraInfo(e);return!!t&&(CloudAPI.hasAccess(t,"live")||CloudAPI.hasAccess(t,"all")||CloudAPI.hasAccess(t,"ptz"))},CloudAPI.cameraUpdatePreview=function(e){return $.ajax({url:CloudAPI.config.url_cameras+e+"/preview/update/",type:"POST"})},CloudAPI.storageDataFirstRecord=function(e){var t=$.Deferred(),a={camid:CloudAPI.cameraID(),limit:1,offset:0};return e&&(a.start=e),$.ajax({url:CloudAPI.config.url_storage+"data/",data:a,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.storageEventsFirstRecord=function(){var t=$.Deferred(),e={camid:CloudAPI.cameraID(),limit:1,offset:0};return $.ajax({url:CloudAPI.config.url_storage+"events/",data:e,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.storageThumbnailsFirstRecord=function(){var t=$.Deferred(),e={camid:CloudAPI.cameraID(),limit:1,offset:0};return $.ajax({url:CloudAPI.config.url_storage+"thumbnails/",data:e,cache:!1,type:"GET"}).done(function(e){0<e.objects.length?t.resolve(e.objects[0]):t.reject()}).fail(function(){t.reject()}),t},CloudAPI.getAllData=function(e,t){},CloudAPI.storageThumbnails=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},o={camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"thumbnails/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(o.end=t),i(o).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],a=n.meta.limit;a<e.meta.total_count;a+=n.meta.limit)o.offset=a,t.push(i(o));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageTimeline=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},o={slices:1,camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"timeline/"+CloudAPI.cameraID()+"/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(o.end=t),i(o).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],a=n.meta.limit;a<e.meta.total_count;a+=n.meta.limit)o.offset=a,t.push(i(o));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageEvents=function(e,t){var r=$.Deferred(),n={meta:{limit:1e3,offset:0,total_count:-1},objects:[]},o={camid:CloudAPI.cameraID(),limit:n.meta.limit,offset:n.meta.offset,start:e};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_storage+"events/",data:e,cache:!1,async:!0,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return t&&(o.end=t),i(o).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],a=n.meta.limit;a<e.meta.total_count;a+=n.meta.limit)o.offset=a,t.push(i(o));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.cameraMotionDetectionDemo=function(){return JSON.parse('{"caps": {"columns": 23, "max_regions": 8, "region_shape": "rect", "rows": 15, "sensitivity": "region"}}')},CloudAPI.cameraMotionDetection=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/motion_detection/",type:"GET"})},CloudAPI.cameraMotionDetectionRegionsDemo=function(){return JSON.parse('{"meta": {"limit": 20, "next": null, "offset": 0, "previous": null, "total_count": 8}, "objects": [{"enabled": true, "id": 2686, "map": "ZmQwMDBjM2ZjMDAwN2Y4MDAwZmYwMDAxZmUwMDAzZmNlNjAw", "name": "motion1", "sensitivity": 5}, {"enabled": true, "id": 2687, "map": "ZjYwMDBmMGZmODAwMWZmMDAwM2ZlMDAwN2ZjMDAwZmY4MDAxZmZmMDAw", "name": "motion2", "sensitivity": 5}, {"enabled": true, "id": 2688, "map": "ZjQwMDBmM2ZlMDAwN2ZjMDAwZmY4MDAxZmYwMDAzZmUwMDA3ZmNmMjAw", "name": "motion3", "sensitivity": 5}, {"enabled": true, "id": 2689, "map": "ZWMwMDBjMWZlMDAwM2ZjMDAwN2Y4MDAwZmYwMDAxZmVmNzAw", "name": "motion4", "sensitivity": 5}, {"enabled": true, "id": 2690, "map": "ZTQwMDA2ZTAwMDAxYzAwMDAzODBmOTAw", "name": "motion5", "sensitivity": 5}, {"enabled": true, "id": 2691, "map": "MmIwMWZmMDAwM2ZlMDAwN2ZjMDAwZmY4MDAxZmYwMDAzZmUwMDA3ZmMwMDBmZjgwMDFmZjAwMDNmZTAwMDdmYzAwMGZmODAwMWZmMDAwM2ZlMDAwN2ZjMDAw", "name": "motion6", "sensitivity": 5}, {"enabled": true, "id": 2692, "map": "MTJmZjgwMDFmZjAwMDNmZTAwMDdmYzAwMGZmODAwMWZmMDAwM2ZlMGU4MDA=", "name": "motion7", "sensitivity": 5}, {"enabled": false, "id": 2693, "map": "", "name": "motion8", "sensitivity": 5}]}')},CloudAPI.cameraMotionDetectionRegions=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/motion_detection/regions/",type:"GET"})},CloudAPI.cameraP2PSettings=function(t,a,e,r){return t=t||CloudAPI.cameraID(),a=null==a?CloudAPI.handleNothing:a,e=null==e?CloudAPI.handleError:e,r=null==r?CloudAPI.handleNothing:r,$.ajax({url:CloudAPI.config.url_cameras+t+"/p2p_settings/",type:"GET",success:function(e){CloudAPI.cache.setP2PSettings(t,e),a(e)},error:e,complete:r})},CloudAPI.cameraSetP2PSettings=function(e){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/p2p_settings/",type:"PUT",data:JSON.stringify(e),cache:!1,contentType:"application/json"})},CloudAPI.cameraLog=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/log/",type:"GET"})},CloudAPI.cameraLogDownload=function(e){var t=$.Deferred(),a=null;return(a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(200==a.status?t.resolve(a.responseText):t.reject())},a.open("GET",e,!0),a.send(),t.promise()},CloudAPI.cameraLogUpdate=function(){return $.ajax({url:CloudAPI.config.url_cameras+CloudAPI.cameraID()+"/log/update/",type:"POST"})},CloudAPI.cameraManagersList=function(e,t){e=e||CloudAPI.handleNothing,t=t||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cmngrs,type:"GET",success:e,error:t})},CloudAPI.cameraManagerReset=function(e){return $.ajax({url:CloudAPI.config.url_cmngrs+e+"/reset/",type:"POST"})},CloudAPI.camerasList=function(e){e=e||{};var n=$.Deferred(),r={meta:{limit:20,offset:0,total_count:-1},objects:[]},o={limit:r.meta.limit,offset:r.meta.offset};for(var t in e)o[t]=e[t];function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_cameras,data:e,cache:!1,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}function s(t){var a=0,r=t.objects.length;a==r&&n.resolve(t);for(var e=0;e<r;e++)cam=t.objects[e],CloudAPI.cache.setCameraInfo(cam)?(console.log("update p2p_settings: ",cam.id),CloudAPI.cameraP2PSettings(cam.id).done(function(e){CloudAPI.cameraMemoryCard(cam.id).done(function(){(a+=1)==r&&n.resolve(t)}).fail(function(){(a+=1)==r&&n.resolve(t)})}).fail(function(){(a+=1)==r&&n.resolve(t)})):(a+=1)==r&&n.resolve(t)}return i(o).fail(function(){n.reject()}).done(function(e){if(r.meta.total_count=e.meta.total_count,$.merge(r.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)s(r);else{for(var t=[],a=r.meta.limit;a<e.meta.total_count;a+=r.meta.limit)o.offset=a,t.push(i(o));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(r.objects,arguments[e].objects);s(r)}).fail(function(){n.reject()})}}),n},CloudAPI.camerasListByCriterions=function(e,t,a){t=t||CloudAPI.handleNothing,a=a||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cameras,data:e,type:"GET",success:t,error:a})},CloudAPI.cameraManagerInfo=function(e,t,a){t=t||CloudAPI.handleNothing,a=a||CloudAPI.handleError,$.ajax({url:CloudAPI.config.url_cmngrs+e+"/",type:"GET",success:t,error:a})},CloudAPI.cameraManagerSetTimezone=function(e,t,a,r){a=a||CloudAPI.handleNothing,r=r||CloudAPI.handleError;var n={};n.timezone=t,$.ajax({url:CloudAPI.config.url_cmngrs+e+"/",type:"PUT",success:a,error:r,data:JSON.stringify(n),contentType:"application/json"})},CloudAPI.storageClipList=function(){var r=$.Deferred(),n={meta:{limit:100,offset:0,total_count:-1},objects:[]},o={limit:n.meta.limit,offset:n.meta.offset,camid:CloudAPI.cameraID(),usecamtz:""};function i(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_clips,data:e,cache:!1,type:"GET"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}return i(o).fail(function(){r.reject()}).done(function(e){if(n.meta.total_count=e.meta.total_count,n.meta.expire=e.meta.expire,$.merge(n.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)r.resolve(n);else{for(var t=[],a=n.meta.limit;a<e.meta.total_count;a+=n.meta.limit)o.offset=a,t.push(i(o));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(n.objects,arguments[e].objects);r.resolve(n)}).fail(function(){r.reject()})}}),r},CloudAPI.storageClipListAnon=function(e){var i=$.Deferred();return CloudAPI.anonToken().done(function(a){var r={meta:{limit:100,offset:0,total_count:-1},objects:[]},n={limit:r.meta.limit,offset:r.meta.offset,usecamtz:""};function o(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_clips,data:e,cache:!1,type:"GET",headers:{Authorization:"SkyVR "+a.token}}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t}e&&(n.token=e),o(n).fail(function(){i.reject()}).done(function(e){if(r.meta.total_count=e.meta.total_count,r.meta.expire=e.meta.expire,$.merge(r.objects,e.objects),e.meta.offset+e.objects.length>=e.meta.total_count)i.resolve(r);else{for(var t=[],a=r.meta.limit;a<e.meta.total_count;a+=r.meta.limit)n.offset=a,t.push(o(n));$.when.apply($,t).done(function(){for(var e=0;e<arguments.length;e++)$.merge(r.objects,arguments[e].objects);i.resolve(r)}).fail(function(){i.reject()})}})}).fail(function(){i.reject()}),i},CloudAPI.storageClipCreate=function(e,t,a,r,n){var o={};return o.camid=CloudAPI.cameraID(),o.title=e,o.group=t,o.start=a,o.end=r,o.delete_at=n,$.ajax({url:CloudAPI.config.url_clips,type:"POST",data:JSON.stringify(o),cache:!1,contentType:"application/json"})},CloudAPI.storageClip=function(e){return $.ajax({url:CloudAPI.config.url_clips+e+"/",type:"GET",cache:!1})},CloudAPI.serverTime=function(){return $.ajax({url:CloudAPI.config.url_server+"time/",type:"GET",cache:!1})},CloudAPI.storageClipAnon=function(t,e){var a=$.Deferred(),r={};return e&&(r.token=e),CloudAPI.anonToken().done(function(e){$.ajax({url:CloudAPI.config.url_clips+t+"/",type:"GET",data:r,cache:!1,headers:{Authorization:"SkyVR "+e.token}}).done(function(e){a.resolve(e)}).fail(function(){a.reject()})}).fail(function(){a.reject()}),a},CloudAPI.storageClipDelete=function(e){return $.ajax({url:CloudAPI.config.url_clips+e+"/",type:"DELETE",cache:!1})},CloudAPI.storageClipUpdate=function(e,t){return $.ajax({url:CloudAPI.config.url_clips+e+"/",data:JSON.stringify(t),type:"PUT",cache:!1,contentType:"application/json"})},CloudAPI.cameraSettings=function(){var o,e=$.Deferred(),t=[];function a(e){var t=$.Deferred();return e.always(function(){t.resolve()}),t}return t.push(a((o=$.Deferred(),CloudAPI.cameraMediaStreams().done(function(e){console.log("MediaStreams: ",e);var t=e.mstreams_supported,a=e.live_ms_id;if(0<t.length&&""!=a){for(var r="",n=0;n<t.length;n++)if(t[n].id==a){r=t[n].vs_id;break}""!=r?CloudAPI.cameraVideoStream(r).done(function(){o.resolve()}).fail(function(){o.reject()}):o.reject()}else o.resolve()}).fail(function(){o.reject()}),o))),CloudAPI.cache.cameraInfo().url||(t.push(a(CloudAPI.cameraVideo())),t.push(a(CloudAPI.cameraAudio())),t.push(a(CloudAPI.cameraLimits())),t.push(a(CloudAPI.cameraEventProcessingEventsMotion())),t.push(a(CloudAPI.cameraEventProcessingEventsSound())),t.push(a(CloudAPI.cameraMemoryCard()))),$.when.apply($,t).done(function(){e.resolve(CloudAPI.cache.cameraInfo())}).fail(function(){e.reject()}),e},CloudAPI.createCamsess=function(e){return e=e||{},$.ajax({url:CloudAPI.config.url_camsess,data:JSON.stringify(e),type:"POST",contentType:"application/json",cache:!1})},CloudAPI.updateCamsess=function(e,t){return t=t||{},$.ajax({url:CloudAPI.config.url_camsess+e+"/",data:JSON.stringify(t),type:"PUT",contentType:"application/json",cache:!1})},CloudAPI.cameraCreate=function(e){var t=$.Deferred();return e=e||{},$.ajax({url:CloudAPI.config.url_cameras,type:"POST",data:JSON.stringify(e),cache:!1,contentType:"application/json"}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.cameraDelete=function(e){var t=$.Deferred();return $.ajax({url:CloudAPI.config.url_cameras+e+"/",type:"DELETE",cache:!1}).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)}),t},CloudAPI.cameraUpdate=function(e,t){var a=$.Deferred();return t=t||{},$.ajax({url:CloudAPI.config.url_cameras+e+"/",type:"PUT",data:JSON.stringify(t),cache:!1,contentType:"application/json"}).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}),a},CloudAPI.adminCameras=function(e){return e=e||{},$.ajax({url:CloudAPI.config.url_admin_cameras,data:e,type:"GET",cache:!1})},CloudAPI.adminCameraInfo=function(e){return $.ajax({url:CloudAPI.config.url_admin_cameras+e+"/",type:"GET",cache:!1})},CloudAPI.updateAdminCamera=function(e,t){return t=t||{},$.ajax({url:CloudAPI.config.url_admin_cameras+e+"/",type:"PUT",data:JSON.stringify(t),contentType:"application/json",cache:!1})},CloudAPI.store={},CloudAPI.store.volume=function(e){return e&&CloudAPI.setToStorage("volume",e),CloudAPI.getFromStorage("volume")},CloudAPI.store.prev_volume=function(e){return e&&CloudAPI.setToStorage("prev_volume",e),CloudAPI.getFromStorage("prev_volume")},CloudAPI.store.zoom=function(e){return null!=e&&CloudAPI.setToStorage("zoom",e),CloudAPI.getFromStorage("zoom")},CloudAPI.store.zoom_left=function(e){return null!=e&&CloudAPI.setToStorage("zoom_left",e),CloudAPI.getFromStorage("zoom_left")},CloudAPI.store.zoom_top=function(e){return null!=e&&CloudAPI.setToStorage("zoom_top",e),CloudAPI.getFromStorage("zoom_top")},CloudAPI.store.user_profile=function(e){return null!=e&&CloudAPI.setToStorage("user_profile",e),CloudAPI.getFromStorage("user_profile")},CloudAPI.store.svcp_host=function(e){return null!=e&&CloudAPI.setToStorage("svcp_host",e),CloudAPI.getFromStorage("svcp_host")},CloudAPI.storageTemp={},CloudAPI.storageMode="local",CloudAPI.detectStorageMode=function(){try{localStorage.setItem("detectStorageMode","yes")}catch(e){CloudAPI.storageMode="temp"}},CloudAPI.detectStorageMode(),CloudAPI.setToStorage=function(e,t){"local"==CloudAPI.storageMode?localStorage.setItem(e,t):CloudAPI.storageTemp[e]=t},CloudAPI.getFromStorage=function(e){return"local"==CloudAPI.storageMode?localStorage.getItem(e):CloudAPI.storageTemp[e]},CloudAPI.removeFromStorage=function(e){"local"==CloudAPI.storageMode?localStorage.removeItem(e):CloudAPI.storageTemp[e]=void 0},CloudAPI.loadApiTokenFromHref=function(){var e=window.location.href.split("#"),t=e[e.length-1];for(var a in t=t.split("&")){var r=t[a].split("=")[0],n=decodeURIComponent(t[a].split("=")[1]);"token"==r?(CloudAPI.config.apiToken=CloudAPI.config.apiToken||{},CloudAPI.config.apiToken.token=n,CloudAPI.config.apiToken.type="api"):"expire"==r&&(CloudAPI.config.apiToken=CloudAPI.config.apiToken||{},CloudAPI.config.apiToken.expire=n,CloudAPI.config.apiToken.expireTimeUTC=Date.parse(n+"Z"))}console.log("Href token: ",CloudAPI.config.apiToken),CloudAPI.setToStorage("SkyVR_apiToken",JSON.stringify(CloudAPI.config.apiToken))},CloudAPI.cleanupApiToken=function(){CloudAPI.removeFromStorage("SkyVR_apiToken"),CloudAPI.config.apiToken=null,$.ajaxSetup({crossDomain:!0,cache:!1,beforeSend:function(e,t){e.setRequestHeader("Authorization","")}})},CloudHelpers.containsPageParam("svcp_host")?CloudAPI.setURL(CloudAPI.pageParams.svcp_host):CloudAPI.getFromStorage("CloudAPI_svcp_host")?CloudAPI.setURL(CloudAPI.getFromStorage("CloudAPI_svcp_host")):CloudAPI.setURL(("file:"==window.location.protocol?"http":window.location.protocol)+"//"+window.location.host.toString()+"/"),CloudAPI.events={},CloudAPI.events.listeners={},CloudAPI.events.names=["CAMERA_INFO_CHANGED"],CloudAPI.events.on=function(e,t,a){-1!=CloudAPI.events.names.indexOf(e)?(CloudAPI.events.listeners[e]||(CloudAPI.events.listeners[e]={}),CloudAPI.events.listeners[e][t]=a):console.error("[CLOUDAPI] Could not find event with name "+e)},CloudAPI.events.off=function(e,t){-1!=CloudAPI.events.names.indexOf(e)&&CloudAPI.events.listeners[e]?CloudAPI.events.listeners[e][t]?delete CloudAPI.events.listeners[e][t]:console.error("[CLOUDAPI] Could not find event with name "+e+" by id "+t):console.error("[CLOUDAPI] Could not find event with name "+e)},CloudAPI.events.trigger=function(e,a){if(-1!=CloudAPI.events.names.indexOf(e)){if(CloudAPI.events.listeners[e]){var r=CloudAPI.events.listeners[e];setTimeout(function(){for(var t in r)try{r[t](a)}catch(e){console.error("[CLOUDAPI] error on execute callback event ("+t+")",e)}},1)}}else console.error("[CLOUDAPI] Could not find event with name "+e)},window.CloudReturnCode={},CloudReturnCode.OK={name:"OK",code:-5049,text:"Success"},CloudReturnCode.OK_COMPLETIONPENDING={name:"OK_COMPLETIONPENDING",code:1,text:"Operation Pending"},CloudReturnCode.ERROR_NOT_CONFIGURED={name:"ERROR_NOT_CONFIGURED",code:-2,text:"Object not configured"},CloudReturnCode.ERROR_NOT_IMPLEMENTED={name:"ERROR_NOT_IMPLEMENTED",code:-1,text:"Function not implemented"},CloudReturnCode.ERROR_NO_MEMORY={name:"ERROR_NO_MEMORY",code:-12,text:"Out of memory"},CloudReturnCode.ERROR_ACCESS_DENIED={name:"ERROR_ACCESS_DENIED",code:-13,text:"Access denied"},CloudReturnCode.ERROR_BADARGUMENT={name:"ERROR_BADARGUMENT",code:-22,text:"Invalid argument"},CloudReturnCode.ERROR_STREAM_UNREACHABLE={name:"ERROR_STREAM_UNREACHABLE",code:-5049,text:"The stream specified is not reachable. Please check source URL or restart the stream"},CloudReturnCode.ERROR_EXPECTED_FILTER={name:"ERROR_EXPECTED_FILTER",code:-5050,text:"Expected filter"},CloudReturnCode.ERROR_NO_CLOUD_CONNECTION={name:"ERROR_NO_CLOUD_CONNECTION",code:-5051,text:"No cloud connection (has not conenction object or token is invalid)"},CloudReturnCode.ERROR_WRONG_RESPONSE={name:"ERROR_WRONG_RESPONSE",code:-5052,text:"Response from cloud expected in json, but got something else"},CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED={name:"ERROR_SOURCE_NOT_CONFIGURED",code:-5053,text:"Source not configured"},CloudReturnCode.ERROR_INVALID_SOURCE={name:"ERROR_INVALID_SOURCE",code:-5054,text:"Invalid source"},CloudReturnCode.ERROR_RECORDS_NOT_FOUND={name:"ERROR_RECORDS_NOT_FOUND",code:-5055,text:"Records are not found"},CloudReturnCode.ERROR_STREAM_UNREACHABLE_HLS={name:"ERROR_STREAM_UNREACHABLE_HLS",code:-5056,text:"The stream specified is not reachable (HLS)."},CloudReturnCode.ERROR_NOT_FOUND_HLS_PLUGIN={name:"ERROR_NOT_FOUND_HLS_PLUGIN",code:-5057,text:"HLS plugin not found."},CloudReturnCode.ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS={name:"ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS",code:-5058,text:"Could not decode stream or could not set cookie for streaming server (please allow cookie)."},CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR={name:"ERROR_WEBRTC_SERVER_ERROR",code:-5059,text:"Unable to connect to server. Please check that you added an exception for the certificate, and that the port is available."},CloudReturnCode.ERROR_CAMERA_OFFLINE={name:"ERROR_CAMERA_OFFLINE",code:-5060,text:"Video source is offline"},CloudReturnCode.PLAYER_NOT_SUPPORTED={name:"PLAYER_NOT_SUPPORTED",code:-5061,text:"Player not supported"},CloudReturnCode.NOT_SUPPORTED_FORMAT={name:"NOT_SUPPORTED_FORMAT",code:-5062,text:"Not supported format"},CloudReturnCode.ERROR_HLS_ENDED={name:"ERROR_HLS_ENDED",code:-5063,text:"The stream is ended (HLS)."},CloudReturnCode.ERROR_INVALID_ACCESS_TOKEN_FORMAT={name:"ERROR_INVALID_ACCESS_TOKEN_FORMAT",code:-5064,text:"Invalid access token format"},CloudReturnCode.ERROR_CHANNEL_NOT_FOUND={name:"ERROR_CHANNEL_NOT_FOUND",code:-5065,text:"Channel is not found"},CloudReturnCode.ERROR_NETWORK_ERROR={name:"ERROR_NETWORK_ERROR",code:-5066,text:"Network error"},CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED={name:"ERROR_ACCESS_TOKEN_REQUIRED",code:-5067,text:"Access token is required"},CloudReturnCode.ERROR_ACCESS_TOKEN_EXPIRED={name:"ERROR_ACCESS_TOKEN_EXPIRED",code:-5068,text:"Access token is expired"},CloudReturnCode.ERROR_NOT_AUTHORIZED={name:"ERROR_NOT_AUTHORIZED",code:-5401,text:"Failed authorization on cloud (wrong credentials)"},CloudReturnCode.ERROR_NOT_FOUND={name:"ERROR_NOT_FOUND",code:-5404,text:"Not found object"},window.CloudCameraPrivacyFilter={},CloudCameraPrivacyFilter.PS_OWNER_NOT_PUBLIC={name:"PS_OWNER_NOT_PUBLIC",code:0,text:"My cameras which not public"},CloudCameraPrivacyFilter.PS_OWNER={name:"PS_OWNER",code:1,text:"Only my cameras"},CloudCameraPrivacyFilter.PS_PUBLIC_NOT_OWNERS={name:"PS_PUBLIC_NOT_OWNERS",code:2,text:"Public cameras exclude my"},CloudCameraPrivacyFilter.PS_PUBLIC={name:"PS_PUBLIC",code:3,text:"All public cameras"},CloudCameraPrivacyFilter.PS_OWNERS_PUBLIC={name:"PS_OWNERS_PUBLIC",code:4,text:"My public cameras"},CloudCameraPrivacyFilter.PS_ALL={name:"PS_ALL",code:5,text:"All cameras"},window.CloudCameraRecordingMode={},CloudCameraRecordingMode.CONTINUES={name:"CONTINUES",code:0},CloudCameraRecordingMode.BY_EVENT={name:"BY_EVENT",code:1},CloudCameraRecordingMode.NO_RECORDING={name:"NO_RECORDING",code:2},CloudCameraRecordingMode.SERVER_BY_EVENT={name:"SERVER_BY_EVENT",code:3},window.CloudCameraStatus={},CloudCameraStatus.ACTIVE={name:"ACTIVE",code:0},CloudCameraStatus.UNAUTHORIZED={name:"UNAUTHORIZED",code:1},CloudCameraStatus.INACTIVE={name:"INACTIVE",code:2},CloudCameraStatus.INACTIVE_BY_SCHEDULER={name:"INACTIVE_BY_SCHEDULER",code:3},CloudCameraStatus.OFFLINE={name:"OFFLINE",code:4},window.CloudTrialConnection=function(){var n=this;n.mAPI=null,n.AccountProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//cnvrclient2.videoexpertsgroup.com/",n.setAccpUrl=function(e){n.AccountProviderUrl=e},n.setSvcpUrlBase=function(e){n.ServiceProviderUrl=e},n.setApiConfig=function(e,t,a){n.ApiHost=e,n.ApiPort=t,n.ApiSecurePort=a},n.setCamConfig=function(e,t,a){n.CamHost=e,n.CamPort=t,n.CamSecurePort=a},n.open=function(e){var t=CloudHelpers.promise();return n.TrialKey=e,n.RequestData={username:n.TrialKey,password:n.TrialKey,cloud_token:!0},n._asyncLogin(t),t},n.isOpened=function(){return null!=n.mAPI},n.close=function(){n.mAPI=null},n._getAPI=function(){return n.mAPI},n.getUserInfo=function(){var r=CloudHelpers.promise();return n.isOpened()?n.mAPI.getAccountInfo().done(function(a){n.mAPI.getAccountCapabilities().done(function(e){var t=new CloudUserInfo(n,a,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},n.getServerTimeDiff=function(){return n.mAPI.diffServerTime},n._asyncLogin=function(a){CloudHelpers.request({url:n.AccountProviderUrl+"api/v1/account/login/",type:"POST",data:JSON.stringify(n.RequestData),contentType:"application/json"}).done(function(e){if(e.cloud_token&&e.cloud_token.token){var t=CloudHelpers.parseUri(e.svcp_auth_app_url).host;t=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+t+"/",n.mAPI=new CloudAPI(e.cloud_token,n.ServiceProviderUrl||t),n.mAPI.getServerTime().done(function(){a.resolve()}).fail(function(e){a.reject(e)})}else console.warn("Try again after 1 sec"),setTimeout(function(){n._asyncLogin(a)},1e3)}).fail(function(e){console.error(e),a.reject(e)})}},window.CloudTokenConnection=function(e){var o=this;o.mAPI=null,o.options=e,o.ServiceProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+(o.options.cloud_domain?o.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")+"/",o.open=function(e,t,a){var r={token:e,expire:t,type:"api"};a&&(o.ServiceProviderUrl=a);var n=CloudHelpers.promise();return o.mAPI=new CloudAPI(r,o.ServiceProviderUrl),o.mAPI.getServerTime().done(function(){n.resolve()}).fail(function(e){n.reject(e)}),n},o.isOpened=function(){return null!=o.mAPI},o.close=function(){o.mAPI=null},o._getAPI=function(){return o.mAPI},o.getUserInfo=function(){var r=CloudHelpers.promise();return o.isOpened()?o.mAPI.getAccountInfo().done(function(a){o.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(o,a,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},o.getServerTimeDiff=function(){return o.mAPI.diffServerTime}},window.CloudShareConnection=function(e){var n=this;n.options=e,n.mAPI=null,n.ServiceProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+(n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")+"/",n.open=function(e){var t={token:e,expire:"",type:"share"},a=CloudHelpers.promise();return n.mAPI=new CloudAPI(t,n.ServiceProviderUrl),n.mAPI.getServerTime().done(function(){a.resolve()}).fail(function(e){a.reject(e)}),a},n.updateToken=function(e){n.mAPI&&(n.mAPI.token=e)},n.isOpened=function(){return null!=n.mAPI},n.close=function(){n.mAPI=null},n._getAPI=function(){return n.mAPI},n.getUserInfo=function(){var r=CloudHelpers.promise();return n.isOpened()?n.mAPI.getAccountInfo().done(function(a){n.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(n,a,e);r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},n.getServerTimeDiff=function(){return n.mAPI.diffServerTime}},window.CloudUserConnection=function(){var r,n,o=this;o.mAPI=null,o.AccountProviderUrl=("file:"==window.location.protocol?"http:":window.location.protocol)+"//cnvrclient2.videoexpertsgroup.com/",o.open=function(e,t){r=e,n=t;var a=CloudHelpers.promise();return o.RequestData={username:r,password:n,cloud_token:!0},o._asyncLogin(a),a},o.isOpened=function(){return null!=o.mAPI},o.close=function(){o.mAPI=null},o._getAPI=function(){return o.mAPI},o.getUserInfo=function(){var r=CloudHelpers.promise();return o.isOpened()?o.mAPI.getAccountInfo().done(function(a){o.mAPI.getAccountCapabilities().done(function(e){console.warn("caps:",e);var t=new CloudUserInfo(o,a,e);r.resolve(t)}).fail(function(e){if(500==e.status){var t=new CloudUserInfo(o,a);r.resolve(t)}else CloudHelpers.handleError(e,r)})}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},o.getServerTimeDiff=function(){return o.mAPI.diffServerTime},o._asyncLogin=function(a){CloudHelpers.request({url:o.AccountProviderUrl+"api/v1/account/login/",type:"POST",data:JSON.stringify(o.RequestData),contentType:"application/json"}).done(function(e){if(e.cloud_token&&e.cloud_token.token){var t=CloudHelpers.parseUri(e.svcp_auth_app_url).host;t=("file:"==window.location.protocol?"http:":window.location.protocol)+"//"+t+"/",o.mAPI=new CloudAPI(e.cloud_token,t),o.mAPI.getServerTime().done(function(){a.resolve()}).fail(function(e){a.reject(e)})}else console.warn("Try again after 1 sec"),setTimeout(function(){o._asyncLogin(a)},1e3)}).fail(function(e){console.error(e),a.reject(e)})}},window.CloudUserInfo=function(e,t,a){var r,n,o,i,s,l,c,u,d,m=this,f=e;function p(e,t){n=t,o=(r=e).id,i=e.email,s=e.first_name,l=e.last_name,c=e.preferred_name,t?(u=t.cameras_creation.limits.total_cameras,t.cameras_creation.limits.hosted_cameras,d=t.cameras_creation.created.total_cameras,t.cameras_creation.created.hosted_cameras):d=u=0}p(t,a),m._getConn=function(){return f},m._origJsonAccount=function(){return r},m._origJsonCapabilities=function(){return n},m.getID=function(){return o},m.getEmail=function(){return i},m.getFirstName=function(){return s},m.getLastName=function(){return l},m.getPreferredName=function(){return c},m.getCameraLimit=function(){return u},m.getCameraCreated=function(){return d},m.refresh=function(){var a=CloudHelpers.promise();return f&&f.isOpened()?f._getAPI().getAccountInfo().done(function(t){f._getAPI().getAccountCapabilities().done(function(e){p(t,e),a.resolve()}).fail(function(e){500==e.status?p(t):CloudHelpers.handleError(e,a)})}).fail(function(e){CloudHelpers.handleError(e,a)}):a.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),a}},window.CloudCamera=function(e,t){var a=this;a.type="camera";var r,n,o,i,s,l,c,u,d,m,f,p,h,v,g,C,y,A,_,E=e,P=t.id,b=t.cmngrid;function S(e){o=(r=e).login,i=e.password,n=e.url,m=e.name,l=e.timezone,s=e.status,c=e.latitude,u=e.longitude,f=e.rec_mode,p="on"==e.rec_status,d=e.delete_at,h=e.brand,v=e.group_name,g=e.fw_version,y=e.model,e.serial_number,A=e.uuid,C=e.led,_=!!e.public&&e.public}var T={};S(t),a._getConn=function(){return console.log("mConn = "+E),E},a._origJson=function(){return r},a.getID=function(){return P},a.getRecStatus=function(){console.warn("TODO")},a.hasPTZ=function(){console.warn("TODO")},a.getURL=function(){return n},a.setURL=function(e){n=e,T.url=e},a.getURLLogin=function(){return o},a.setURLLogin=function(e){o=e,T.login=e},a.getURLPassword=function(){return i},a.setURLPassword=function(e){i=e,T.password=e},a.getDeleteAt=function(){return d},a.getTimezone=function(){return l},a.setTimezone=function(e){l=e,T.timezone=e},a.isPublic=function(){return _},a.setPublic=function(e){_=e,T.public=e},a.getStatus=function(){var e=s.toUpperCase();return CloudCameraStatus[e]?CloudHelpers.copy(CloudCameraStatus[e]):(console.error("Unknown camera status"),null)},a.getName=function(){return m},a.setName=function(e){m=e,T.name=e},a.getLatitude=function(){return c},a.setLatitude=function(e){c=e,T.latitude=e},a.getLongitude=function(){return u},a.setLongitude=function(e){u=e,T.longitude=e},a.isRecording=function(){return p},a.getCameraManagerID=function(){return b},a.getBrand=function(){return h},a.getGroupName=function(){return v},a.getFirmwareVersion=function(){return g},a.getModel=function(){return y},a.getUUID=function(){return A},a.getLed=function(){return C},a.setRecordingMode=function(e){e.name==CloudCameraRecordingMode.CONTINUES.name?T.rec_mode="on":e.name==CloudCameraRecordingMode.BY_EVENT.name?T.rec_mode="by_event":e.name==CloudCameraRecordingMode.NO_RECORDING.name?T.rec_mode="off":e.name==CloudCameraRecordingMode.SERVER_BY_EVENT.name?T.rec_mode="server_by_event":console.error("[CloudCamera] Unknown mode of recording")},a.getRecordingMode=function(){return"on"==f?CloudHelpers.copy(CloudCameraRecordingMode.CONTINUES):"by_event"==f?CloudHelpers.copy(CloudCameraRecordingMode.BY_EVENT):"off"==f?CloudHelpers.copy(CloudCameraRecordingMode.NO_RECORDING):"server_by_event"===f?CloudHelpers.copy(CloudCameraRecordingMode.SERVER_BY_EVENT):void console.error("[CloudCamera] Unknown mode of recording")},a.save=function(){var t=CloudHelpers.promise();return E._getAPI().updateCamera(P,T).done(function(e){S(e),T.timezone?E._getAPI().updateCameraManager(b,{timezone:T.timezone}).done(function(){l=T.timezone,T={},t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):(T={},t.resolve())}).fail(function(e){CloudHelpers.handleError(e,t)}),t},a.getPreview=function(){var a=CloudHelpers.promise();if(!E||!E.isOpened())return a.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),a;var r=E._getAPI().diffServerTime;return E._getAPI().cameraPreview(P).done(function(t){console.log(t);var e=CloudHelpers.parseUTCTime(t.time);curr_time=CloudHelpers.getCurrentTimeUTC()+r,60<(curr_time-e)/1e3?E._getAPI().cameraUpdatePreview(P).done(function(e){a.resolve(t.url)}).fail(function(e){CloudHelpers.handleError(e,a)}):a.resolve(t.url)}).fail(function(e){CloudHelpers.handleError(e,a)}),a},a.getTimeline=function(o,i){var s=CloudHelpers.promise();if(!E||!E.isOpened())return s.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),s;var e=CloudHelpers.formatUTCTime(o),t=CloudHelpers.formatUTCTime(i);return E._getAPI().storageTimeline(P,e,t,4).done(function(e){var t={};t.start=o,t.end=i,t.periods=[];var a=e.objects[0][4];for(var r in a){var n={};n.start=CloudHelpers.parseUTCTime(a[r][0]),n.end=n.start+1e3*a[r][1],t.periods.push(n)}s.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,s)}),s},a.getTimelineDays=function(e){var r=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().storageActivity(P,e).done(function(e){var t=[];for(var a in e.objects)t.push(CloudHelpers.parseUTCTime(e.objects[a]+"T00:00:00"));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},a.getCameraUsage=function(){var t=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().cameraUsage(P).done(function(e){t.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t};var w="COMMON_SHARING_TOKEN";function M(e){var t={};return t.token=e,t.camid=P,t.access="watch",E.ServiceProviderUrl&&(t.svcp=E.ServiceProviderUrl),E.ApiHost&&(t.api=E.ApiHost),E.ApiPort&&80!=E.ApiPort&&(t.api_p=E.ApiPort),E.ApiSecurePort&&443!=E.ApiSecurePort&&(t.api_sp=E.ApiSecurePort),CloudHelpers.base64_encode(JSON.stringify(t))}a.enableSharing=function(){var n=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().getCameraSharingTokensList(P).done(function(e){var t=!1;for(var a in e.objects){var r=e.objects[a];if(r.name==w)return t=!0,void(1==r.enabled?n.resolve(M(r.token)):E._getAPI().updateCameraSharingToken(P,r.id,{enabled:!0}).done(function(e){n.resolve(M(r.token))}).fail(function(e){CloudHelpers.handleError(e,n)}))}t||E._getAPI().creareCameraSharingToken(P,w,["live","play","clipsplay"]).done(function(e){n.resolve(M(e.token))}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}):n.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),n},a.disableSharing=function(e){var r=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().getCameraSharingTokensList(P).done(function(e){for(var t in e.objects){var a=e.objects[t];if(a.name==w)return!0,void E._getAPI().updateCameraSharingToken(P,a.id,{enabled:!1}).done(function(e){console.log(e),r.resolve()}).fail(function(e){CloudHelpers.handleError(e,r)})}r.reject()}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r},a.createClip=function(e,t,a,r,n){var o=CloudHelpers.promise();if(!E||!E.isOpened())return o.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),o;var i=CloudHelpers.formatUTCTime(t),s=CloudHelpers.formatUTCTime(a),l=CloudHelpers.formatUTCTime(r);return E._getAPI().createClip(P,e,i,s,l,n).done(function(e){o.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,o)}),o},a.getClip=function(e,t){var a=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().getClip(e,t).done(function(e){a.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,a)}):a.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),a};var R="COMMON_SHARING_TOKEN_FOR_STREAM";function I(e){var t={};return t.token=e,t.camid=P,t.cmngrid=b,t.access="all",t.api_p=80,t.api_sp=443,t.cam="cam.skyvr.videoexpertsgroup.com",t.cam_p=8888,t.cam_sp=8883,E.ServiceProviderUrl&&(t.svcp=E.ServiceProviderUrl),E.ApiHost&&(t.api=E.ApiHost),E.ApiPort&&80!=E.ApiPort&&(t.api_p=E.ApiPort),E.ApiSecurePort&&443!=E.ApiSecurePort&&(t.api_sp=E.ApiSecurePort),E.CamHost&&(t.cam=E.CamHost),E.CamPort&&(t.cam_p=E.CamPort),E.CamSecurePort&&(t.cam_sp=E.CamSecurePort),CloudHelpers.base64_encode(JSON.stringify(t))}a.enableSharingForStream=function(){var n=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().getCameraSharingTokensList(P).done(function(e){var t=!1;for(var a in e.objects){var r=e.objects[a];if(r.name==R)return t=!0,void(1==r.enabled?n.resolve(I(r.token)):E._getAPI().updateCameraSharingToken(P,r.id,{enabled:!0}).done(function(e){n.resolve(I(r.token))}).fail(function(e){CloudHelpers.handleError(e,n)}))}t||E._getAPI().creareCameraSharingToken(P,R,["all"]).done(function(e){n.resolve(I(e.token))}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}):n.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),n},a.getStreamingURL=function(){var t=CloudHelpers.promise();return E&&E.isOpened()?E._getAPI().getCameraStreamingURLs(P).done(function(e){t.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},a.setPublishPassword=function(e){T.publish_password=e}},window.CloudCameraListFilter=function(){var n=this;n.filterParams={detail:"detail",limit:50},n.setLimit=function(e){n.filterParams.limit=e},n.setOffset=function(e){n.filterParams.offset=e},n.setName=function(e){void 0!==e?n.filterParams.name=e:delete n.filterParams.name},n.setPartOfName=function(e){void 0!==e?n.filterParams.name__icontains=e:delete n.filterParams.name__icontains},n.sortByName=function(e){n.filterParams.order_by=(e?"-":"")+"name"},n.sortByDate=function(e){n.filterParams.order_by=(e?"-":"")+"created"},n.setOwner=function(e){console.warn("setPublic is deprecated"),void 0!==e?n.filterParams.is_owner=e:delete n.filterParams.is_owner},n.setPublic=function(e){console.warn("setPublic is deprecated"),void 0!==e?n.filterParams.public=e:delete n.filterParams.public},n.setForStream=function(e){void 0!==e&&void 0!==e?n.filterParams.url__isnull=e:delete n.filterParams.url__isnull},n.setPrivacy=function(e){void 0!==e&&e.name?"PS_OWNER_NOT_PUBLIC"==e.name?(n.filterParams.public=!1,n.filterParams.is_owner=!0):"PS_OWNER"==e.name?(delete n.filterParams.public,n.filterParams.is_owner=!0):"PS_PUBLIC_NOT_OWNERS"==e.name?(n.filterParams.public=!0,n.filterParams.is_owner=!1):"PS_PUBLIC"==e.name?(n.filterParams.public=!0,delete n.filterParams.is_owner):"PS_OWNERS_PUBLIC"==e.name?(n.filterParams.public=!0,n.filterParams.is_owner=!0):("PS_ALL"==e.name||console.error("Unknown privacy filter"),delete n.filterParams.public,delete n.filterParams.is_owner):(console.error("Unknown privacy filter"),delete n.filterParams.public,delete n.filterParams.is_owner)},n.setURL=function(e){void 0!==e?n.filterParams.url=e:delete n.filterParams.url},n.setLatLngBounds=function(e,t,a,r){console.warn("[CloudCamerasListFilter] SetLatLngBounds, TODO test -1 < lat,lang < 1"),e<=t&&(n.filterParams.latitude__gte=e,n.filterParams.latitude__lte=t),a<=r&&(n.filterParams.longitude__gte=a,n.filterParams.longitude__lte=r)},n._values=function(){return n.filterParams}},window.CloudCameraList=function(e){var i=this,s=e;i.getCamera=function(e){var t=CloudHelpers.promise();return s&&s.isOpened()?s._getAPI().getCamera(e).done(function(e){t.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},i.createCamera=function(e,t,a){var r=CloudHelpers.promise();if(!s||!s.isOpened())return r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r;var n={url:e,login:t,password:a};return s._getAPI().createCamera(n).done(function(e){r.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,r)}),r},i.createCameraForStream=function(){var t=CloudHelpers.promise();if(!s||!s.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;return s._getAPI().createCamera({}).done(function(e){t.resolve(new CloudCamera(s,e))}).fail(function(e){CloudHelpers.handleError(e,t)}),t},i.findOrCreateCamera=function(e){var n=CloudHelpers.promise(),t=new CloudCameraListFilter;t.setOwner(!0);var o=CloudHelpers.splitUserInfoFromURL(e);return t.setURL(o.url),o.login=o.login||"",s._getAPI().camerasList(t._values()).done(function(e){var t=!1;for(var a in e.objects){var r=e.objects[a];if(r.login=r.login||"",r.login==o.login){t=!0,n.resolve(new CloudCamera(s,r));break}}t||i.createCamera(o.url,o.login,o.password).done(function(e){n.resolve(e)}).fail(function(e){CloudHelpers.handleError(e,n)})}).fail(function(e){CloudHelpers.handleError(e,n)}),n},i.getCameraList=function(e){var r=CloudHelpers.promise();return(e=e||new CloudCameraListFilter)._values?s&&s.isOpened()?s._getAPI().camerasList(e._values()).done(function(e){var t=[];for(var a in e.objects)t.push(new CloudCamera(s,e.objects[a]));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}):r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION):(console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),r.reject(CloudReturnCode.ERROR_EXPECTED_FILTER)),r},i.getCameraListLight=function(e){var t=CloudHelpers.promise();if(!(e=e||new CloudCameraListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),t.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),t;if(!s||!s.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;var a=e._values();return delete filterMap.detail,s._getAPI().camerasList(a).done(function(e){t.resolve(e.objects)}).fail(function(e){CloudHelpers.handleError(e,t)}),t},i.deleteCamera=function(e){var t=CloudHelpers.promise();return s&&s.isOpened()?s._getAPI().deleteCamera(e).done(function(){t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t}},window.CloudSession=function(e,t){var a=this;a.type="session";var r,n,o,i,s,l,c,u,d,m,f,p,h,v,g,C,y,A=e,_=t.id,E=0,P=0,b=0;function S(e){n=(r=e).active,o=e.title,e.preview&&(i=e.preview.url),e.live_urls&&(g=e.live_urls.rtmp,C=e.live_urls.hls,y=e.live_urls.expire),c=e.latitude,u=e.longitude,s=e.streaming,l=e.public,d=e.start,m=e.end,f=e.has_records,e.statistics&&(P=e.statistics.peak_live||0,b=e.statistics.playback||0,E=e.statistics.live||0),v=e.author?e.author.preferred_name:"unknown",e.access&&(p=-1!=e.access.indexOf("all"),h=-1!=e.access.indexOf("watch"))}i="";S(t),a._getConn=function(){return A},a._origJson=function(){return r},a.hasAccessAll=function(){return p},a.hasAccessWatch=function(){return p||h},a.getID=function(){return _},a.isOnline=function(){return n},a.getTitle=function(){return o},a.getAuthorPreferredName=function(){return v},a.getStatisticsLive=function(){return E},a.getStatisticsPeakLive=function(){return P},a.getStatisticsPlayback=function(){return b},a.getStartTime=function(){return null==d?(console.error("[CloudSession] #"+_+" Start time is null"),0):CloudHelpers.parseUTCTime(d)},a.getEndTime=function(){return null==d?(console.error("[CloudSession] #"+_+" End time is null but session is mActive: "+n),0):CloudHelpers.parseUTCTime(m)},a.getPreview=function(){return i},a.getLatitude=function(){return c},a.getLongitude=function(){return u},a.isStreaming=function(){return s},a.isPublic=function(){return l},a.hasRecords=function(){return f},a.getLiveUrl_Rtmp=function(){return g},a.getLiveUrl_HLS=function(){return C},a.getLiveUrl_Expire=function(){return y},a.refresh=function(){var t=CloudHelpers.promise();return A._getAPI().getCamsess(_).done(function(e){S(e),t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}),t}},window.CloudSessionListFilter=function(){var n=this;n.filterParams={limit:50,order_by:"-start"},n.setLimit=function(e){n.filterParams.limit=e},n.setOffset=function(e){n.filterParams.offset=e},n.setTitle=function(e){n.filterParams.title__icontains=e},n.setStartLessThen=function(e){n.filterParams.start__lte=e},n.setHasRecords=function(e){"any"==e||("yes"==e?(n.filterParams.has_records=!0,n.filterParams.active=!1):"no"==e?(n.filterParams.has_records=!1,n.filterParams.active=!1):console.error("[CloudSessionListFilter] setHasRecords, expected 'any', 'yes' or 'no'"))},n.setStreaming=function(e){"any"==e||("yes"==e?(n.filterParams.streaming=!0,n.filterParams.camera_online=!0,n.filterParams.active=!0):"no"==e?(n.filterParams.streaming=!1,delete n.filterParams.camera_online,n.filterParams.active=!1):console.error("[CloudSessionListFilter] setStreaming, expected 'any', 'yes' or 'no'"))},n.setAuthorName=function(e){n.filterParams.author_name__icontains=e},n.setAuthorID=function(e){e?n.filterParams.author_id=e:delete n.filterParams.author_id},n.setAuthorPreferredName=function(e){e?n.filterParams.author_preferred_name__icontains=e:delete n.filterParams.author_preferred_name__icontains},n.setWithDetails=function(){console.warn("[CloudSessionListFilter] 'setWithDetails' not supported anymore. Please use getSessionList or getSessionListLight")},n.setOnline=function(e){console.warn("[CloudSessionListFilter] 'setOnline' not supported anymore")},n.setPublic=function(e){"any"==e||("yes"==e?n.filterParams.public=!0:"no"==e?n.filterParams.public=!1:console.error("[CloudSessionListFilter] setOnline, expected 'any', 'yes' or 'no'"))},n.setLatLngBounds=function(e,t,a,r){e<=t?(n.filterParams.latitude__gte=e,n.filterParams.latitude__lte=t):console.error("[CloudCamerasListFilter] latitude_max must be greater or equal to latitude_min"),a<=r?(n.filterParams.longitude__gte=a,n.filterParams.longitude__lte=r):console.error("[CloudCamerasListFilter] longitude_max must be greater or equal to longitude_min")},n._values=function(){var e={};for(var t in n.filterParams)e[t]=n.filterParams[t];return e}},window.CloudSessionList=function(e){var n=e;this.getSession=function(e){var t=CloudHelpers.promise();return n&&n.isOpened()?n._getAPI().getCamsess(e).done(function(e){t.resolve(new CloudSession(n,e))}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t},this.getSessionList=function(e){var r=CloudHelpers.promise();if(!(e=e||new CloudSessionListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),r.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),r;if(!n||!n.isOpened())return r.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),r;var t=e._values();return t.detail="detail",n._getAPI().getCamsessList(t).done(function(e){var t=[];for(var a in e.objects)t.push(new CloudSession(n,e.objects[a]));r.resolve(t)}).fail(function(e){CloudHelpers.handleError(e,r)}),r},this.getSessionListLight=function(e){var t=CloudHelpers.promise();if(!(e=e||new CloudSessionListFilter)._values)return console.error(CloudReturnCode.ERROR_EXPECTED_FILTER),t.reject(CloudReturnCode.ERROR_EXPECTED_FILTER),t;if(!n||!n.isOpened())return t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t;var a=e._values();return delete a.detail,n._getAPI().getCamsessList(a).done(function(e){t.resolve(e.objects)}).fail(function(e){CloudHelpers.handleError(e,t)}),t},this.deleteSession=function(e){var t=CloudHelpers.promise();return n&&n.isOpened()?n._getAPI().deleteCamsess(e).done(function(){t.resolve()}).fail(function(e){CloudHelpers.handleError(e,t)}):t.reject(CloudReturnCode.ERROR_NO_CLOUD_CONNECTION),t}},window.CloudPlayerEvent={},CloudPlayerEvent.CONNECTING={name:"CONNECTING",code:0,text:"Connection is establishing"},CloudPlayerEvent.CONNECTED={name:"CONNECTED",code:1,text:"Connection is established"},CloudPlayerEvent.PLAYED={name:"PLAYED",code:2,text:"Player changes state to PLAY."},CloudPlayerEvent.PAUSED={name:"PAUSED",code:3,text:"Player state is PAUSE."},CloudPlayerEvent.CLOSED={name:"CLOSED",code:6,text:"Player state is CLOSED."},CloudPlayerEvent.SEEK_COMPLETED={name:"SEEK_COMPLETED",code:17,text:"setPosition() is successfully finished."},CloudPlayerEvent.ERROR={name:"ERROR",code:105,text:"Player is disconnected from media stream due to an error"},CloudPlayerEvent.SOURCE_CHANGED={name:"SOURCE_CHANGED",code:3e3,text:"setSource() is successfully finished."},CloudPlayerEvent.POSITION_JUMPED={name:"POSITION_JUMPED",code:3001,text:"Position was changed by player (possible that player did not found records)."},CloudPlayerEvent.RANGE_ENDED={name:"RANGE_ENDED",code:4455,text:"The player reached the end of the range when playing"},CloudPlayerEvent.CHANNEL_STATUS={name:"CHANNEL_STATUS",code:4456,text:"When channel status"},CloudPlayerEvent.USER_CLICKED_ON_TIMELINE={name:"USER_CLICKED_ON_TIMELINE",code:4457,text:"When user click on timeline."},CloudPlayerEvent.CHANGED_CONTROLS={name:"CHANGED_CONTROLS",code:4458,text:"Event when controls changes"},CloudPlayerEvent.TIMELINE_END_UPDATED={name:"TIMELINE_END_UPDATED",code:4459,text:"Event when timeline end updated"},CloudPlayerEvent.ACCESS_TOKEN_EXPIRED_IN_5MIN={name:"ACCESS_TOKEN_EXPIRED_IN_5MIN",code:4460,text:"Access token expired in 5 minutes"},window._cloudPlayers=window._cloudPlayers||{},window.CloudPlayer=function(o,e){var g=this;g.options=e=e||{},g.elid=o;var m=null,a=null,t=!0,n=0,r=!0,i=!1,s=!1,l=!1,f=CloudHelpers.createCallbacks(),C="",c=null,u=null,d=null,p=null,h=null,v=null,y=null,A=!1,_=null,E=null,P=null,b=null,S=null,T=null,w=null,M=!0,R=0,I=null,k=null;if(g.timePolingLiveUrls=15e3,g.player=document.getElementById(o),_cloudPlayers[o])return _cloudPlayers[o];var O=null,N=null,D=-1,L=-1,x={w:0,h:0};if(CloudHelpers.isChrome()&&!CloudHelpers.isMobile()?(videojs.options.hls=videojs.options.hls||{},videojs.options.html5.nativeAudioTracks=!0,videojs.options.html5.nativeVideoTracks=!1,videojs.options.hls.overrideNative=!1):(videojs.options.hls=videojs.options.hls||{},videojs.options.html5.nativeAudioTracks=!1,videojs.options.html5.nativeVideoTracks=!1,videojs.options.hls.overrideNative=!0),videojs.options.hls.enableLowInitialPlaylist=!0,videojs.options.suppressNotSupportedError=!1,null==g.player)return console.error("[CloudPlayer] Not found element"),null;if("DIV"!=g.player.tagName)return console.error("[CloudPlayer] Expected DIV tag but got "+g.player.tagName),null;var U=-1,H=0,z=2e3,j=5e3,B=null,F=null;g.m={},g.m.mute=!1,g.m.waitSourceActivation=e.waitSourceActivation||0,g.m.useTimezone=e.useTimezone,g.m.useTimezone&&console.warn("[CloudPlayer] useTimezone: "+g.m.useTimezone),g.m.waitSourceActivation<0&&(console.warn("[CloudPlayer] option waitSourceActivation must be greater than -1"),g.m.waitSourceActivation=0),g.m.useNativeHLS=e.useNativeHLS||!1,g.m.backwardAudio=!1,g.m.backwardAudio=e.backwardAudio||null!=g.player.getAttribute("backward-audio")||g.m.backwardAudio,g.defualtAutohide=CloudHelpers.isMobile()?0:3e3,void 0!==e.autohide?g.m.autohide=e.autohide:g.m.autohide=g.defualtAutohide,e.trasholdPlaybackInMs&&(R=e.trasholdPlaybackInMs,console.log("[CloudPlayer] applied option trasholdPlaybackInMs "+e.trasholdPlaybackInMs)),g.mPlayerFormat="html5";var W="";if(e.preferredPlayerFormat)g.mPreferredPlayerFormat=e.preferredPlayerFormat,W=e.preferredPlayerFormat;else try{W=localStorage.getItem("preferred_player_format")}catch(e){console.error("[CloudPlayer] error load format: ",e)}if("webrtc"==W||"html5"==W||"flash"==W?g.mPlayerFormat=W:console.warn("[CloudPlayer] Unknown player format: ",W,", html5 is used by default"),e.useOnlyPlayerFormat){var G=e.useOnlyPlayerFormat;if("webrtc"!==G&&"html5"!==G&&"flash"!==G)console.error("Wrong value of useOnlyPlayerFormat, expected 'webrtc' or 'html5' or 'flash'");else{g.mPlayerFormat=G,b=G;try{localStorage.setItem("preferred_player_format",G)}catch(e){}}}void 0!==e.mute&&(g.m.mute=!0===e.mute),g.swf_backwardaudio="",g.player.classList.add("cloudplayer"),g.player.classList.add("green"),g.player.classList.add("black"),g.player.innerHTML='<div class="cloudplayer-loader" style="display: inline-block"></div><div class="cloudplayer-screenshot-loading" style="display: none">\t\t<div class="cloudplayer-screenshot-loading">     </div></div><div class="cloudplayer-error" style="display: none">\t<div class="cloudplayer-error-text" style="display: none"></div></div><div class="cloudplayer-ptz"><div class="ptz-controls">\t<div class="ptz-arrow ptz-top"></div>\t<div class="ptz-arrow ptz-right"></div>\t<div class="ptz-arrow ptz-bottom"></div>\t<div class="ptz-arrow ptz-left"></div><div class="ptz-zoom">\t<div class="ptz-zoom-plus"></div>\t<div class="ptz-zoom-minus"></div></div></div><div class="ptz-presets"><h4>Presets</h4><ul class="presets-list"><li data-presetNo="1">1</li><li data-presetNo="2">2</li><li data-presetNo="3">3</li><li data-presetNo="4">4</li><li data-presetNo="5">5</li></ul></div></div><div class="cloudplayer-controls-zoom-container"><div class="cloudplayer-controls-zoom-position">\t\t<div class="cloudplayer-zoom-position-cursor"></div></div><div class="cloudplayer-controls-zoom">\t<div class="cloudplayer-zoom-up"></div>\t<div class="cloudplayer-zoom-progress zoom10x"></div>\t<div class="cloudplayer-zoom-down"></div></div></div><div class="cloudplayer-watermark"></div><div class="cloudplayer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudplayer-selectcliptime">    <table><tr><td>Before<br/><span>(sec.)</span></td><td>Date/Time</td><td>After<br/><span>(sec.)</span></td></tr>    <tr><td><input class="clipbefore" type="number" min=1 max=3600 value="10"></td><td class="clipdt"></td><td><input class="clipafter" type="number" min=1 max=3600 value="10"></td></tr>    <tr><td colspan="3"><div class="clipcreatebtn">Create clip &gt;</div></td></tr></table></div><div class="cloudplayer-info"><div class="cloudplayer-info-main">\t\t<div class="cloudplayer-info-title">Settings</div>\t\t<div class="cloudplayer-info-container">\t\t<div class="cloudplayer-info-player-mode" style="'+(null!==b?"disabled":"")+'"> Preferred format: \t\t<div class="selected-format"></div></div>\t\t<div class="cloudplayer-info-player-dewarping enabled"  style="">Dewarping: \t\t<div class="selected-dewarping">Off</div></div>\t\t<div class="cloudplayer-info-player-speed enabled">Speed: \t\t<div class="selected-speed">1x</div></div>\t\t\x3c!-- div class="cloudplayer-info-latency">Player Latency: \t\t\t<div class="cloudplayer-info-latency-minimal">Minimal Latency</div>\t\t\t/  \t\t<div class="cloudplayer-info-latency-smoothless">Maximum Smoothness</div>\t\t</div --\x3e\t\t\x3c!-- div class="cloudplayer-info-latency-not-supported">Player Latency: Setting is not available for HTML5 player</div --\x3e\t\t<div class="cloudplayer-info-bufferlength"></div>\t\t<div class="cloudplayer-info-audio-stream">Audio stream: \t\t\t<div class="cloudplayer-info-audio-stream-on">On</div>\t\t\t/  \t\t<div class="cloudplayer-info-audio-stream-off">Off</div>\t\t</div>\t\t<div class="cloudplayer-info-playerversion">Version: '+CloudSDK.version+" ("+CloudSDK.datebuild+')</div>\t\t<div class="cloudplayer-info-playertype">Used player:</div></div></div><div class="cloudplayer-info-setting mode-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Preferred format</div>\t\t<div class="cloudplayer-info-container">\t\t<div class="cloudplayer-player-mode cloudplayer-webrtc-mode" style="display: none">'+(e.alt_protocol_names?"Low latency":"WebRTC")+'</div> \t\t<div class="cloudplayer-player-mode cloudplayer-flash-mode selected">'+(e.alt_protocol_names?"Standard":"RTMP")+'</div> \t\t<div class="cloudplayer-player-mode cloudplayer-html5-mode">'+(e.alt_protocol_names?"Reliable":"HLS")+'</div>\t\t</div></div><div class="cloudplayer-info-setting dewarping-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Dewarping</div>\t\t<div class="cloudplayer-info-container">\t\t\t<div class="cloudplayer-player-mode cloudplayer-dewarping-mode selected" data-dewarping="0">Off</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-dewarping-mode" data-dewarping="1">On</div>\t\t</div></div><div class="cloudplayer-info-setting speed-select">\t\t<div class="cloudplayer-info-title"><span class="back"></span>Speed</div>\t\t<div class="cloudplayer-info-container">\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.125">0.125x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.25">0.25x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="0.5">0.5x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode selected" data-speed="1">1x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="2">2x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="4">4x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="8">8x</div>\t\t\t<div class="cloudplayer-player-mode cloudplayer-speed-mode" data-speed="16">16x</div>\t\t</div></div></div><div class="cloudplayer-backwardaudio-container">'+(g.m.backwardAudio?'<object data="'+g.swf_backwardaudio+'" type="application/x-shockwave-flash" id="backwardaudio_swf_single" align="top">\t\t<param name="movie" value="'+g.swf_backwardaudio+'" />\t\t<embed type="application/x-shockwave-flash" src="'+g.swf_backwardaudio+'">\t\t<param name="allowScriptAccess" value="always"/>\t\t<param value="allowNetworking" value="all"/>\t\t<param name="menu" value="true" />\t\t<param name="wmode" value="transparent"/>\t\t\x3c!-- param name="bgcolor" value="#ffffff" / --\x3e\t\t<param name="menu" value="false" /></object>':"")+'</div><div class="cloudplayer-calendar-container"></div><div class="cloudplayer-live-container"></div><div class="cloudplayer-controls-container"><div class="cloudplayer-timeline-container"></div><div class="cloudplayer-controls">\t<div class="cloudplayer-play" style="display: none"></div>\t<div class="cloudplayer-stop" style="display: none"></div>\t<div class="cloudplayer-pause hidden"></div>\t<div class="cloudplayer-volume-mute"></div>\t<div class="cloudplayer-volume-container">\t\t<input type="range" min="0" max="100" step="1" data-buffer="0" id="volume" class="cloudplayer-volume" data-rangeSlider>\t\t<output></output>\t</div>\t<div class="cloudplayer-time"></div>\t<div class="cloudplayer-volume-down"></div>\t<div class="cloudplayer-volume-progress vol7"></div>\t<div class="cloudplayer-volume-up"></div>\t<div class="cloudplayer-microphone"></div>\t<div class="cloudplayer-right-divider"></div>\t<div class="cloudplayer-get-clip" style="display: none"></div>\t<div class="cloudplayer-get-shot" style="display: none"></div>\t<div class="cloudplayer-single-element-divider"></div>\t<div class="cloudplayer-settings"></div>\t<div class="cloudplayer-show-zoom"></div>\t<div class="cloudplayer-show-ptz"></div>\t<div class="cloudplayer-fullscreen"></div></div></div><div class="cloudcameracalendar-content"></div><div class="cloudplayer-big-play-button" style="display: none"></div><canvas class="cloudplayer-stub-snapshot" style="width:100%; height:100%; display:none;"></canvas><canvas class="cloudplayer-snapshot hidden"></canvas><div class="cloudplayer-share-clip" style="width:100%; height:100%; display:none;"></div><div class="allvideotags" style="width:100%; height:100%;" >\t<video crossorigin="anonymous" id="'+o+'_vjs" class="video-js" preload="auto" class="video-js vjs-default-skin vjs-live vjs-fill" \t\tcontrols width="100%" height="100%"\t\t muted='+g.m.mute+' autoplay=true preload playsinline="true"></video><video crossorigin="anonymous" id="'+o+'_nv1" class="cloudplayer-native-video '+o+'_nv1" autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+o+'_nv2" class="cloudplayer-native-video '+o+'_nv2" autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+o+'_native_hls" class="cloudplayer-native-hls" muted='+g.m.mute+' autoplay=true preload  playsinline="true" ></video><video crossorigin="anonymous" id="'+o+'_webrtc" class="cloudplayer-webrtc" muted='+g.m.mute+' preload  playsinline="true" ></video></div><div class="cloudplayer-black-screen" style="display: none">\t\t<div class="cloudplayer-watermark"></div>\t\t<div class="cloudplayer-sdkversion">SDK '+CloudSDK.version+"</div></div>",g.vjs=videojs(o+"_vjs",{controls:!1}),g.vjs.on("error",function(e){if($e(),null!=g.vjs.error()){var t=g.vjs.error();g.isLive()?4!=t.code||CloudHelpers.supportFlash()||CloudHelpers.isMobile()||"flash"!=g.mPlayerFormat?3==t.code&&CloudHelpers.isMobile()?g._showConsoleError(CloudReturnCode.ERROR_COULD_NOT_DECODE_STREAM_OR_COULD_NOT_SET_COOKIE_HLS):g._showConsoleError({name:"VIDEOJS_ERROR",text:"Code "+t.code+": "+t.message,code:-6e3}):g._showConsoleError({name:"REQUIRE_FLASH",text:"Please install and enable <a target='_black' href='https://get.adobe.com/flashplayer/'>Adobe Flash Player</a> and try again",code:-6001}):g._showConsoleError({name:"VIDEOJS_ERROR",text:"Code "+t.code+": "+t.message,code:-6e3})}g._hideSnapshot(!1),g.stop("by_vjs_error"),setTimeout(function(){g.play()},1e3)});var Y=null,q=null;M?(Y=new CloudPlayerNativeVideo(o+"_nv1"),q=new CloudPlayerNativeVideo(o+"_nv2")):Y=g.vjs;var V=null;g.time=0;var K=g.player,Z=g.player.getElementsByClassName("cloudplayer-controls")[0],J=g.player.getElementsByClassName("cloudplayer-volume")[0],X=g.player.getElementsByClassName("cloudplayer-controls-zoom-container")[0],Q=g.player.getElementsByClassName("cloudplayer-controls-zoom")[0],ee=g.player.getElementsByClassName("cloudplayer-controls-zoom-position")[0],te=g.player.getElementsByClassName("cloudplayer-controls-container")[0],ae=g.player.getElementsByClassName("cloudplayer-show-zoom")[0],re=g.player.getElementsByClassName("cloudplayer-show-ptz")[0],ne=g.player.getElementsByClassName("cloudplayer-get-shot")[0],oe=g.player.getElementsByClassName("cloudplayer-get-clip")[0],ie=g.player.getElementsByClassName("cloudplayer-ptz")[0],se=g.player.getElementsByClassName("cloudplayer-play")[0],le=g.player.getElementsByClassName("cloudplayer-info")[0],ce=g.player.getElementsByClassName("clipcreatebtn")[0],ue=g.player.getElementsByClassName("cloudplayer-stop")[0],de=g.player.getElementsByClassName("cloudplayer-pause")[0],me=g.player.getElementsByClassName("cloudplayer-loader")[0],fe=g.player.getElementsByClassName("cloudplayer-error")[0],pe=g.player.getElementsByClassName("cloudplayer-error-text")[0],he=g.player.getElementsByClassName("cloudplayer-time")[0],ve=g.player.getElementsByClassName("clipdt")[0],ge=g.player.getElementsByClassName("cloudplayer-big-play-button")[0],Ce=(c=g.player.getElementsByClassName("cloudplayer-webrtc")[0],p=g.player.getElementsByClassName("cloudplayer-native-hls")[0],v=g.player.getElementsByClassName(o+"_nv1")[0],y=g.player.getElementsByClassName(o+"_nv2")[0],g.player.getElementsByClassName("cloudplayer-info-playertype")[0]),ye=g.player.getElementsByClassName("cloudplayer-settings")[0],Ae=(g.player.getElementsByClassName("cloudplayer-info-close")[0],g.player.querySelectorAll(".cloudplayer-info-title .back")),_e=g.player.getElementsByClassName("cloudplayer-info-player-mode")[0],Ee=g.player.querySelector(".cloudplayer-info-player-speed"),Pe=g.player.getElementsByClassName("selected-format")[0],be=g.player.querySelector(".cloudplayer-info-player-speed.enabled .selected-speed"),Se=g.player.querySelector(".cloudplayer-info-player-dewarping.enabled .selected-dewarping"),Te=g.player.getElementsByClassName("cloudplayer-webrtc-mode")[0],we=g.player.getElementsByClassName("cloudplayer-flash-mode")[0],Me=g.player.getElementsByClassName("cloudplayer-html5-mode")[0],Re=(S=g.player.getElementsByClassName("cloudcameracalendar-content")[0],g.player.getElementsByClassName("cloudplayer-calendar-container")[0]),Ie=g.player.getElementsByClassName("ptz-left")[0],ke=g.player.getElementsByClassName("ptz-right")[0],Oe=g.player.getElementsByClassName("ptz-top")[0],Ne=g.player.getElementsByClassName("ptz-bottom")[0],De=g.player.getElementsByClassName("ptz-zoom-plus")[0],Le=g.player.getElementsByClassName("ptz-zoom-minus")[0],xe=g.player.getElementsByClassName("cloudplayer-calendar-container")[0],Ue=g.player.getElementsByClassName("cloudplayer-live-container")[0],He=g.player.querySelectorAll(".cloudplayer-speed-mode"),ze=g.player.querySelectorAll(".cloudplayer-dewarping-mode"),je=g.player.getElementsByClassName("cloudplayer-share-clip")[0];if(void 0!==je)new CloudShareClipController(je,g._shareClipCallback);for(var Be=He.length-1;0<=Be;Be--)He[Be].onclick=qe;for(var Fe=ze.length-1;0<=Fe;Fe--)ze[Fe].onclick=Ve;"undefined"!=typeof rangeSlider&&rangeSlider.create(J);var We=document.querySelectorAll("[data-rangeSlider]");function Ge(e){var t=e.value;e.parentNode.getElementsByTagName("output")[0].innerHTML=t+"%"}for(var Ye=We.length-1;0<=Ye;Ye--)Ge(We[Ye]);function qe(){for(var e=He.length-1;0<=e;e--)He[e].classList.remove("selected");this.classList.add("selected"),be.textContent=this.textContent,function(e){for(var t=K.getElementsByClassName("cloudplayer-native-video"),a=0;a<t.length;a++)t[a].defaultPlaybackRate=t[a].playbackRate=e}(this.dataset.speed)}function Ve(){for(var e=ze.length-1;0<=e;e--)ze[e].classList.remove("selected");this.classList.add("selected"),Se.textContent=this.textContent,1==this.dataset.dewarping?g.pano.start():g.pano.stop()}for(Array.prototype.slice.call(document.querySelectorAll('input[type="range"]')).forEach(function(e){e.addEventListener("input",function(e){Ge(e.target)},!1)}),Ye=0;Ye<Ae.length;Ye++)Ae[Ye].onclick=function(){K.classList.remove("showing-format-selection"),K.classList.remove("showing-dewarping-selection"),K.classList.remove("showing-speed-selection")};function Ke(){fe.style.display="none",pe.style.display="none"}function Ze(){1==g.mShowedBigPlayButton?$e():t||(me.style.display="inline-block",t=!0)}function $e(){t&&(me.style.display="none",t=!1)}function Je(e){e=e||{},Te.style.display=e.rtc||e.webrtc?"":"none",we.style.display="none",Me.style.display=e.hls?"":"none",Te.classList.remove("selected"),we.classList.remove("selected"),Me.classList.remove("selected"),"webrtc"==g.mPlayerFormat?(Te.classList.add("selected"),Pe.textContent=Te.textContent):"flash"==g.mPlayerFormat?(we.classList.add("selected"),Pe.textContent=we.textContent):"html5"==g.mPlayerFormat&&(Me.classList.add("selected"),Pe.textContent=Me.textContent)}g.onDocumentClick=function(e){if(!(le.contains(e.target)||ye==e.target||ye.contains(e.target)||S==e.target||S.contains(e.target)||ne==e.target||oe==e.target||ae==e.target||ae.contains(e.target)||X==e.target||X.contains(e.target)||Re==e.target||Re.contains(e.target))&&(g.player.classList.remove("showing-zoom","showing-settings"),g.calendar)){g.calendar.hideCalendar();var t=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];t&&t.classList.remove("shadowed")}},document.addEventListener("click",g.onDocumentClick),ye.onclick=function(){if(g.player.classList.toggle("showing-settings"),g.player.classList.remove("showing-zoom"),g.player.getElementsByClassName("cloudplayer-selectcliptime")[0].style.display="none",g.calendar){g.calendar.hideCalendar();var e=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];e&&e.classList.remove("shadowed")}},Pe.onclick=function(){K.classList.toggle("showing-format-selection")},be.onclick=function(){K.classList.toggle("showing-speed-selection")},Se.onclick=function(){K.classList.toggle("showing-dewarping-selection")},Ie.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("left")){e.cameraPtzExecute(g.mSrc.getID(),{action:"left",timeout:1e4}).done(function(e){console.log("shifted to left")}).fail(function(e){console.error(e)})}},ke.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("right")){e.cameraPtzExecute(g.mSrc.getID(),{action:"right",timeout:1e4}).done(function(e){console.log("shifted to right")}).fail(function(e){console.error(e)})}},Oe.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("top")){e.cameraPtzExecute(g.mSrc.getID(),{action:"top",timeout:1e4}).done(function(e){console.log("shifted to up")}).fail(function(e){console.error(e)})}},Ne.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("bottom")){e.cameraPtzExecute(g.mSrc.getID(),{action:"bottom",timeout:1e4}).done(function(e){console.log("shifted to down")}).fail(function(e){console.error(e)})}},De.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("zoom_in")){e.cameraPtzExecute(g.mSrc.getID(),{action:"zoom_in",timeout:1e4}).done(function(e){console.log("Zoomed in")}).fail(function(e){console.error(e)})}},Le.onmousedown=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("zoom_out")){e.cameraPtzExecute(g.mSrc.getID(),{action:"zoom_out",timeout:1e4}).done(function(e){console.log("Zoomed out")}).fail(function(e){console.error(e)})}},De.onmouseup=Le.onmouseup=Ie.onmouseup=ke.onmouseup=Oe.onmouseup=Ne.onmouseup=function(){var e=m._getAPI();if(null!=e&&g.PTZActions&&g.PTZActions.includes("stop")){e.cameraPtzExecute(g.mSrc.getID(),{action:"stop",timeout:1e3}).done(function(e){console.log("stop move")}).fail(function(e){console.error(e)})}},ae.onclick=function(){if(g.player.classList.toggle("showing-zoom"),g.player.classList.remove("showing-settings"),g.player.getElementsByClassName("cloudplayer-selectcliptime")[0].style.display="none",g.calendar){g.calendar.hideCalendar();var e=g.player.getElementsByClassName("cloudcameratimeline-calendar")[0];e&&e.classList.remove("shadowed")}},re.onclick=function(){K.classList.toggle("showing-ptz")},ne.onclick=function(){g._getSnapshot()},ce.onclick=function(){var e=g.player.getElementsByClassName("cloudplayer-selectcliptime")[0];e.style.display="none";var t=e.getElementsByClassName("clipbefore")[0],a=e.getElementsByClassName("clipafter")[0];isNaN(t.value)||isNaN(a.value)?alert('"Before" and "after" fields must contain a number'):(t=parseInt(t.value),a=parseInt(a.value),t<0||a<0?alert('"Before" and "after" fields must be above or equal 0'):t+a<10?alert("Min clip length is 10 seconds"):3600<t+a?alert("Max clip length is 1 hour (3600 seconds)"):(a=3600<a?3600:a,g._getShareClip(t,a)))},oe.onclick=function(){if(ut)alert("Please wait until your previous clip making will completely finished");else if(-1!=U){var e=g.player.getElementsByClassName("cloudplayer-selectcliptime")[0];"block"==e.style.display?e.style.display="none":(e.style.display="block",g.player.classList.remove("showing-zoom","showing-settings")),console.log("<binary> TODO: get clip here")}else alert("Select a position with the recorded video on the timeline")},Te.onclick=function(){void 0===e.useOnlyPlayerFormat&&(g.setPlayerFormat("webrtc"),g.play())},we.onclick=function(){void 0===e.useOnlyPlayerFormat&&(g.setPlayerFormat("flash"),g.play())},Me.onclick=function(){void 0===e.useOnlyPlayerFormat&&(g.setPlayerFormat("html5"),g.play())},CloudHelpers.isMobile()&&(we.style.display="none"),Je();var Xe=g.player.getElementsByClassName("cloudplayer-black-screen")[0];function Qe(){Xe.style.display=""}$e(),g._showerror=function(e){console.error(e),g._setError(e),g.showErrorText(e.text),console.error(e.text),f.executeCallbacks(CloudPlayerEvent.ERROR,e)},g._showConsoleError=function(e){console.error(e),console.error(e.text)};var et=30,tt=15,at=null;function rt(){var e=0;"camera"==g.mSrc.type&&g.m.useTimezone?e=CloudHelpers.getOffsetTimezone(g.m.useTimezone):"camera"==g.mSrc.type&&(e=CloudHelpers.getOffsetTimezone(g.mSrc.getTimezone()));var t=new Date;t.setTime(t.getTime()+e);var a=t.getUTCHours(),r="";return g.options.timelineampm&&(r=12<=a?" pm":" am",a=0==a?12:12<a?a-12:a)," "+("0000"+t.getUTCFullYear()).slice(-4)+"-"+("00"+(t.getUTCMonth()+1)).slice(-2)+"-"+("00"+t.getUTCDate()).slice(-2)+" "+("00"+a).slice(-2)+":"+("00"+t.getUTCMinutes()).slice(-2)+":"+("00"+t.getUTCSeconds()).slice(-2)+r}function nt(){console.log("before play"),g._hideSnapshot(!0)}function ot(){clearInterval(T),he.innerHTML=""}function it(){console.warn("[PLAYER] Start poling player time"),clearInterval(T),T=setInterval(function(){if(i&&!r){var e=0;if("camera_records"==at)e=B.startUTC+1e3*O.currentTime();else if("camera_live"==at)if("webrtc0"==C||"webrtc2"==C)e=c?c.currentTime:0;else if("native-hls"==C)e=p?p.currentTime:0;else{try{e=1e3*g.vjs.currentTime()}catch(e){console.error("Ignore: ",e)}try{t=g.vjs.videoHeight(),a=g.vjs.videoWidth(),x.w==a&&x.h==t||(setTimeout(function(){var e=g.vjs.el();if(e){var t=e.getElementsByTagName("object")[0];t&&(t.style.width="calc(100% - 5px)",setTimeout(function(){t.style.width=""},1e3))}},1e3),x.w=a,x.h=t)}catch(e){}}else try{e=1e3*g.vjs.currentTime()}catch(e){console.error("Ignore: ",e)}e==g.time?(Ze(),n++,0==g.time&&et<n?(g.stop("by_poling_time_1"),"webrtc"===g.mPlayerFormat?(g.stop("by_setError"),g.play()):(g.count_ERROR_STREAM_UNREACHABLE=1+(0|g.count_ERROR_STREAM_UNREACHABLE),3<g.count_ERROR_STREAM_UNREACHABLE?(g._showerror(CloudReturnCode.ERROR_STREAM_UNREACHABLE),g.count_ERROR_STREAM_UNREACHABLE=0):(console.warn("[PLAYER] stream unreachable: restart count"+g.count_ERROR_STREAM_UNREACHABLE),g.stop("by_setError"),g.play()))):0!=g.time&&tt<n?(console.warn("Restart player"),g.stop("by_poling_time_2"),-1!=U&&g.time>U&&(U=Math.floor(g.time)),g.play()):console.warn("[PLAYER] Wait stream "+n)):(g.count_ERROR_STREAM_UNREACHABLE=0,n=0,g.mShowedBigPlayButton,ge.style.display="none","camera_records"==at?(g.time=e,U=g.time,he.innerHTML=function(e){var t=0;"camera"==g.mSrc.type&&g.m.useTimezone?t=CloudHelpers.getOffsetTimezone(g.m.useTimezone):"camera"==g.mSrc.type&&(t=CloudHelpers.getOffsetTimezone(g.mSrc.getTimezone()));var a=new Date;a.setTime(e+t);var r=a.getUTCHours(),n="";return g.options.timelineampm&&(n=12<=r?" pm":" am",r=0==r?12:12<r?r-12:r)," "+("0000"+a.getUTCFullYear()).slice(-4)+"-"+("00"+(a.getUTCMonth()+1)).slice(-2)+"-"+("00"+a.getUTCDate()).slice(-2)+" "+("00"+r).slice(-2)+":"+("00"+a.getUTCMinutes()).slice(-2)+":"+("00"+a.getUTCSeconds()).slice(-2)+n}(g.time),ve.innerHTML=he.innerHTML):"camera_live"==at?(g.time=e,he.innerHTML=rt(),g.isRange()&&CloudHelpers.getCurrentTimeUTC()>L&&(ot(),g.stop("by_ended_timerange2"),f.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{}))):(g.time=-1==U?1e3*g.vjs.currentTime():B.startUTC+1e3*g.vjs.currentTime(),he.innerHTML=rt()),$e(),Ke()),g.isRange()&&g.time>L&&(U=D,ot(),g.stop("by_ended_timerange"),f.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{}))}else $e();var t,a},1e3)}function st(){if(null!=B){var o=B.endUTC,e=CloudHelpers.formatUTCTime(o-5*CloudHelpers.ONE_SECOND);if(F=null,g.isRange()&&L<e)return;if(null==m._getAPI())return;m._getAPI().storageRecordsFirst(g.mSrc.getID(),e,3).done(function(e){if(0==e.meta.total_count)F=null;else for(var t=e.objects.length,a=0;a<t;a++){var r=e.objects[a];if(r.size<500)console.error("mNextPlayRecord less than 500 bytes, skip ",r);else if(r.startUTC=CloudHelpers.parseUTCTime(r.start),r.endUTC=CloudHelpers.parseUTCTime(r.end),r.endUTC>o&&r.startUTC<o&&console.warn("[CloudPlayer] found trashold segment in "+(r.startUTC-o)+" ms, segment",r),r.startUTC>=o-R&&null==F){var n=(F=e.objects[a]).url;0==n.indexOf("http://")&&(n=n.replace("http://",("file:"==location.protocol?"http:":location.protocol)+"//")),N.reset(),N.src([{src:n,type:"video/mp4"}]),N.off("loadeddata"),N.on("loadeddata",function(){N.pause()});break}}})}else F=null}function lt(e){g.mSrc?(n=0,"camera"==g.mSrc.type?function(s){if("camera"==g.mSrc.type){g.updateAudioCaps&&g.updateAudioCaps(g.mSrc.getID()),Je(),at="camera_records";var l=U,e=CloudHelpers.formatUTCTime(l-2*CloudHelpers.ONE_MINUTE);null!=m._getAPI()&&m._getAPI().storageRecordsFirst(g.mSrc.getID(),e,25).done(function(e){if(s==V){var t=e.objects.length,a=B=null;Qe();for(var r=0,n=0;n<t;n++)if(rec=e.objects[n],rec.size<500)console.error("Record less than 500 bytes will be skip ",rec);else if(rec.startUTC=CloudHelpers.parseUTCTime(rec.start),rec.endUTC=CloudHelpers.parseUTCTime(rec.end),null==a&&rec.startUTC>l&&(a=rec,console.log("firstRecordAfterT selected ",a)),rec.startUTC>l&&r++,!(l>rec.endUTC||l<rec.startUTC)){if(null==B&&l>=rec.startUTC&&l<=rec.endUTC){B=rec;break}if(g.isRange()){if(rec.startUTC>L)break;if(null==B&&l<rec.startUTC&&rec.startUTC<L){B=rec,l=rec.startUTC;break}}}var o=!1;if(null==B&&null!=a&&(!g.isRange()||g.isRange()&&a.startUTC<L)&&(l=(B=a).startUTC,o=!0),g.isRange()||null!=B||0!=r){if(null==B)return $e(),g._showerror(CloudReturnCode.ERROR_RECORDS_NOT_FOUND),void ot();if(s==V){if(g.isRange()&&L<l)return $e(),ot(),g.stop("by_ended_time_range_2"),void f.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{});o&&(g.time=l,f.executeCallbacks(CloudPlayerEvent.POSITION_JUMPED,{new_pos:l})),O=Y,N=q,M?(O.el().style.display="block",N.el().style.display="none",g.vjs.el().style.display="none",O.onAutoplayBlocked=g.playbackAutoplayBlocked):(O.el().style.display="",N.el().style.display="none"),st(),O.off("loadeddata"),O.ready(function(){var e=B.url;0==e.indexOf("http://")&&(e=e.replace("http://",("file:"==location.protocol?"http:":location.protocol)+"//")),O.src([{src:e,type:"video/mp4"}]);var t=l-B.startUTC,a=B.endUTC-B.startUTC;console.log(B),console.log("mCurrentRecord_vjs: "+t+" / "+a),O.currentTime(Math.floor(t/1e3)),O.play()}),O.off("ended"),N.off("ended"),O.on("ended",i),N.on("ended",i),it()}else console.warn("_uniqPlay not current [[_loadCameraRecords fail]]")}}else console.warn("_uniqPlay not current [[_loadCameraRecords fail]]");function i(){if(console.warn("ended"),g.isRange()&&null==F)return console.warn("stop player"),$e(),ot(),g.stop("by_ended_time_range_3"),void f.executeCallbacks(CloudPlayerEvent.RANGE_ENDED,{});if(null!=F){var e=O;O=N,N=e,M?(O.el().style.display="block",N.el().style.display="none",g.vjs.el().style.display="none"):(O.el().style.display="",N.el().style.display="none"),B=F,F=null,O.ready(function(){O.play()}),st()}}})}else g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)}(e):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)):g._showerror(CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED)}function ct(){function e(){CloudHelpers.isIOS()||CloudHelpers.isAndroid(),CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed&&g.mPlayerFormat;g.vjs.play(),ot(),it()}console.log("[PLAYER] _vjs_play_live, mEvent: ",a),ge.style.display="none",CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed&&"html5"==g.mPlayerFormat?CloudHelpers.checkAutoplay(e):e()}g.showErrorText=function(e){$e(),fe.style.display="block",pe.style.display="inline-block",pe.innerHTML=e,Qe()},g.getCalendarContent=function(){return S},g.setAccessToken=function(e){I=e},g.checkTokenExpire=function(){var e=CloudHelpers.getCurrentTimeUTC(),t=CloudHelpers.parseUTCTime(k)-e;t<3e5?f.executeCallbacks(CloudPlayerEvent.ACCESS_TOKEN_EXPIRED_IN_5MIN,t):setTimeout(function(){g.checkTokenExpire()},5e3)},g.setAccessTokenExpire=function(e){null!=(k=e)&&void 0!==k&&setTimeout(function(){g.checkTokenExpire()},5e3)},g.setSource=function(e){if(Ke(),clearInterval(_),g.mSrc=e,m=null==g.mSrc?(se.style.display="none",null):(se.style.display="inline-block",e._getConn()),g.isRange()){var t=CloudHelpers.getCurrentTimeUTC();D<t&&t<L?g.setPosition(CloudPlayer.POSITION_LIVE):g.setPosition(D)}else g.setPosition(CloudPlayer.POSITION_LIVE);f.executeCallbacks(CloudPlayerEvent.SOURCE_CHANGED);var a=document.querySelector(".cloudplayer");if(a){a.classList.remove("showing-ptz");var r=g.player.getElementsByClassName("cloudplayer-show-ptz")[0],n=g.player.getElementsByClassName("cloudplayer-get-clip")[0],o=g.player.getElementsByClassName("cloudplayer-get-shot")[0];if(g.mSrc._origJson().access.indexOf("all")<0?(r.style.display="none",n.style.display="none"):g.options.disableGetClip&&0!=g.options.disableGetClip||(n.style.display="block"),g.options.disableGetShot&&0!=g.options.disableGetShot||(o.style.display="block"),m){var i=g.player.getElementsByClassName("ptz-top")[0],s=g.player.getElementsByClassName("ptz-bottom")[0],l=g.player.getElementsByClassName("ptz-left")[0],c=g.player.getElementsByClassName("ptz-right")[0],u=g.player.getElementsByClassName("ptz-zoom-plus")[0],d=g.player.getElementsByClassName("ptz-zoom-minus")[0];m._getAPI().cameraPtz(g.mSrc.getID()).done(function(e){console.log(e);var t=e.actions;void 0!==(g.PTZActions=t)?(r.style.display="block",i.style.display=-1<t.indexOf("top")?"block":"none",s.style.display=-1<t.indexOf("bottom")?"block":"none",l.style.display=-1<t.indexOf("left")?"block":"none",c.style.display=-1<t.indexOf("right")?"block":"none",u.style.display=-1<t.indexOf("zoom_in")?"block":"none",d.style.display=-1<t.indexOf("zoom_out")?"block":"none"):r.style.display="none"}).fail(function(e){console.log(e),r.style.display="none"})}}},g.getSource=function(){return g.mSrc},g.removeCallback=function(e){f.removeCallback(e)},g.addCallback=function(e,t){f.addCallback(e,t)},g.onTimelineEndUpdate=function(){-1==U&&r&&"block"==fe.style.display&&(console.warn("TODO Restart live if some errors happends"),g.play())},g.playbackAutoplayBlocked=function(){if(-1!=U){ot();try{Y.pause()}catch(e){console.warn("_vjs_play: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,ge.style.display="block",ge.onclick=function(e){a=e,ge.style.display="none";var t=O.el().getElementsByTagName("video")[0];t&&(t.setAttribute("webkit-playsinline",!0),t.setAttribute("playsinline",!0)),!1,n=0,O.play(),ot(),it()}}else console.warn("Skip error player already in live mode")},g.setPlayerFormat=function(e){if("webrtc"==(e=e.toLowerCase())||"flash"==e||"html5"==e){g.mPlayerFormat=e;try{localStorage.setItem("preferred_player_format",g.mPlayerFormat)}catch(e){console.error("[CloudPlayer] error save format: ",e)}Je()}else console.error("Player format expected 'webrtc' or 'flash' or 'html5'")},g.getPlayerFormat=function(){return sMode};var ut=null;if(g._shareClipCallback=function(e,t,a){var r=g.player.getElementsByClassName("cloudplayer-get-clip")[0];if(e?("CloudShareClip in process.."===t&&alert("The video is being prepared ..."),r.classList.add("inprocess")):(null!=ut&&(clearInterval(ut),ut=null),r.classList.remove("step1"),r.classList.remove("step2"),r.classList.remove("step3"),r.classList.remove("step4"),r.classList.remove("inprocess")),void 0!==a){console.log("ShareClipInfo: "+a.url);var n=document.createElement("a");n.setAttribute("href",a.url),n.click()}else console.log("ShareClipInfo: "+t)},g._getShareClip=function(e,t){var a=g.mSrc,r=U;if(-1!=r){r-=1e3*t;var n=g.player.getElementsByClassName("cloudplayer-share-clip")[0];void 0!==n&&void 0!==a&&I&&void 0!==I&&(n.createClip(a,I,g._shareClipCallback,r,1e3*(t+e)),ut=setInterval(function(){var e=g.player.getElementsByClassName("cloudplayer-get-clip")[0];e.classList.contains("inprocess")?e.classList.contains("step1")?(e.classList.remove("step1"),e.classList.add("step2")):e.classList.contains("step2")?(e.classList.remove("step2"),e.classList.add("step3")):e.classList.contains("step3")?(e.classList.remove("step3"),e.classList.add("step4")):(e.classList.contains("step4")&&e.classList.remove("step4"),e.classList.add("step1")):(e.classList.remove("step1"),e.classList.remove("step2"),e.classList.remove("step3"),e.classList.remove("step4"))},500))}else alert("Select a position with the recorded video on the timeline")},g._onResize=function(){var e=g.player.getElementsByClassName("cloudplayer-snapshot")[0],t=g.player.getElementsByClassName("allvideotags")[0];void 0!==e&&(e.setAttribute("width",t.clientWidth),e.setAttribute("height",t.clientHeight))},g._onResize(),window.addEventListener("resize",g._onResize),g._getSnapshot=function(){if(g.player){for(var e=g.player.getElementsByClassName("cloudplayer-stub-snapshot")[0],t=null,a=g.player.getElementsByTagName("video"),r=0;r<a.length;r++){var n=a[r],o=n.currentStyle?n.currentStyle.display:getComputedStyle(n,null).display,i=n.parentElement.currentStyle?n.parentElement.currentStyle.display:getComputedStyle(n.parentElement,null).display;if(n.classList.contains("vjs-tech")&&(o=i),"block"===o||"inline-block"===o){t=n;break}}if(null!=t){var s=t.videoWidth,l=t.videoHeight;if(0<s&&0<l&&(e.setAttribute("width",s),e.setAttribute("height",l),context=e.getContext("2d"),null!=context)){context.fillRect(0,0,s,l),context.drawImage(t,0,0,s,l);var c=document.createElement("a");c.setAttribute("download","snapshot.png"),e.toBlob(function(e){var t=URL.createObjectURL(e);c.setAttribute("href",t),c.click()})}}}},g._hideSnapshot=function(e){if(g.player){var t=g.player.getElementsByClassName("cloudplayer-snapshot")[0];e?$(t).addClass("hidden"):$(t).removeClass("hidden");for(var a=null,r=g.player.getElementsByTagName("video"),n=0;n<r.length;n++){var o=r[n],i=o.currentStyle?o.currentStyle.display:getComputedStyle(o,null).display,s=o.parentElement.currentStyle?o.parentElement.currentStyle.display:getComputedStyle(o.parentElement,null).display;if(o.classList.contains("vjs-tech")&&(i=s),"block"===i||"inline-block"===i){a=o;break}}if(null!=a){var l,c,u=0,d=0,m=l=a.videoWidth,f=c=a.videoHeight,p=t.getAttribute("width"),h=t.getAttribute("height"),v=m/f;1<=v?(u=0,d=(h-(c=(l=p)/v))/2):(d=0,u=(p-(l=(c=h)*v))/2),console.log("Snapshot resolution: "+l+"x"+c+" for:"+C),context=t.getContext("2d"),null!=context&&(context.fillRect(u,d,l,c),context.drawImage(a,u,d,l,c))}}},g.setPosition=function(e){(U=e)==CloudHelpers.POSITION_LIVE?A=!0:g.time=e},void 0!==e.position&&g.setPosition(U),g.getPosition=function(){return i?-1==U?"webrtc0"!=C&&"webrtc2"!=C||!c||0==c.currentTime?"native-hls"==C&&p&&0!=p.currentTime?CloudHelpers.getCurrentTimeUTC()+(m?m.getServerTimeDiff():0):"webrtc0"!=C&&"webrtc2"!=C&&g.vjs&&0!=g.vjs.currentTime()?CloudHelpers.getCurrentTimeUTC()+(m?m.getServerTimeDiff():0):0:CloudHelpers.getCurrentTimeUTC()+(m?m.getServerTimeDiff():0):0==g.time?U:Math.floor(g.time):0},g.isLive=function(){return-1==U&&!r},g.play=function(e){i&&g.stop("by_play"),"camera"==g.mSrc.type?(V=Math.random(),a=e,console.warn("[PLAYER] mUniqPlay: "+V),de.classList.remove("hidden"),de.classList.remove("play"),se.style.display="none",s=!(i=!(r=!1)),ot(),it(),g._reset_players(),Ke(),g.isRange()&&-1==U&&CloudHelpers.getCurrentTimeUTC()>L&&(U=D),g.isRange()&&L<U&&(U=D),-1==U?(!function(e){if(e==V){if(!g.mSrc)return console.error("[CloudPlayer] source not set"),g.setError(100);if("active"!=g.mSrc._origJson().status)return 0==g.m.waitSourceActivation&&(g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),f.executeCallbacks(CloudPlayerEvent.CHANNEL_STATUS,{status:"offline"})),_t(e);n=0,"camera"==g.mSrc.type?(_t(e),g._polingLoadCameraLiveUrl(e)):(console.error("[CloudPlayer] invalid source"),g.setError(100))}else console.warn("_uniqPlay not current [cameraLiveUrls fail]")}(V),f.executeCallbacks(CloudPlayerEvent.POSITION_JUMPED,{new_pos:CloudHelpers.getCurrentTimeUTC()})):(console.warn("Try load records from "+CloudHelpers.formatUTCTime(U)),lt(V)),Ze()):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE)},g.pause=function(e){r=!1,0==s?(i=!(s=!0),de.classList.add("play"),-1==U?"webrtc"==g.mPlayerFormat?null!=u?u.pause():null!=d&&d.pause():g.vjs.pause():(Y.pause(),q.pause())):(i=!(s=!1),de.classList.remove("play"),-1==U?"webrtc"==g.mPlayerFormat?null!=u?u.play():null!=d&&d.play():g.vjs.play():(Y.play(),q.play()))},g.stop=function(e){console.log("[PLAYER] stop called "+e),A=s=i=!(r=!(V=null)),("by_webrtc2_error"===e||"by_webrtc0_error"===e||"by_setError"===e&&"webrtc"===g.mPlayerFormat)&&(g.mPlayerFormat="html5"),console.log("[PLAYER] self.stop: somebody call"),g._reset_players(),null!=v&&(v.style.display="none"),null!=y&&(y.style.display="none"),null!=u&&(u.stopWS(),c.style.display="none"),null!=d&&(d.stopWS(),c.style.display="none"),null!=h&&(h.stop(),p.style.display="none"),ue.style.display="none",se.style.display="inline-block",de.classList.add("hidden"),ot(),clearInterval(w),g._stopPolingMediaTicket(),$e()},g.close=function(){g.stop("by_close"),clearInterval(g.currentTime),clearInterval(_)},g.destroy=function(){document.removeEventListener("click",g.onDocumentClick),g.stop("by_destroy"),clearInterval(g.currentTime),clearInterval(_),g.vjs.dispose(),delete window._cloudPlayers[g.elid],g.player.onwebkitfullscreenchange=null,g.player.onmozfullscreenchange=null,g.player.onfullscreenchange=null,g.player.onfullscreenchange=null,g.f_callbackFullscreenFunc&&(g.f_callbackFullscreenFunc=null)},g.error=function(){return g.mLastError||-1},g.onError=function(e){E=e},g.onChannelStatus=function(e){P=e},g._setError=function(e){setTimeout(function(){g.stop("by_setError")},10),g.mLastError=e,E&&(f.executeCallbacks(CloudPlayerEvent.ERROR,e),setTimeout(function(){E(g,e)},10))},g.setRange=function(e,t){console.warn("[PLAYER] setRange"),D=e,L=t},void 0!==e.range){var dt=parseInt(e.range.min,10),mt=parseInt(e.range.max,10);g.setRange(dt,mt)}function ft(e,t,a){for(var r in e)a(e[r],t)}function pt(){g.currentZoom=0;var e=g.player.getElementsByClassName("cloudplayer-controls-zoom")[0],a=g.player.getElementsByClassName("cloudplayer-controls-zoom-position")[0],t=g.player.getElementsByClassName("cloudplayer-zoom-up")[0],r=g.player.getElementsByClassName("cloudplayer-zoom-down")[0],n=g.player.getElementsByClassName("cloudplayer-zoom-progress")[0],p=g.player.getElementsByClassName("cloudplayer-zoom-position-cursor")[0],h=[];h.push(document.getElementById(o+"_vjs")),h.push(v),h.push(y),h.push(g.player.getElementsByClassName("cloudplayer-webrtc")[0]),g.options.disableZoomControl&&1==g.options.disableZoomControl&&(ae.style.display="none",e.style.display="none"),g.zoomCursorDownBool=!1,g.zoomCursorX=0,g.zoomCursorY=0,g.zoomCursorWidth=176,g.zoomCursorHeight=160,g.zoomControlsWidth=0,g.zoomControlsHeight=0,g.setNewZoom=function(e){if(30<=e&&(e=30),e<=10&&(e=10),g.currentZoom!=e){g.currentZoom=e;var t="scale("+g.currentZoom/10+")";ft(h,t,function(e,t){e.style.transform=t}),p.style.transform="scale("+10/g.currentZoom+")",n.className=n.className.replace(/zoom\d+x/g,"zoom"+Math.ceil(g.currentZoom)+"x"),a.style.display=10==g.currentZoom?"none":"",p.style.left="",p.style.top="",ft(h,"",function(e,t){e.style.left=t,e.style.top=t})}},g.setNewZoom(10),g.zoomUp=function(){g.setNewZoom(g.currentZoom+5)},g.zoomDown=function(){g.setNewZoom(g.currentZoom-5)},g.zoomProgressDownBool=!1,g.zoomProgressDown=function(e){g.zoomProgressDownBool=!0},g.zoomProgressMove=function(e){if(1==g.zoomProgressDownBool){var t=e.pageY-CloudHelpers.getAbsolutePosition(e.currentTarget).y,a=n.offsetHeight,r=a/5;t=10*(Math.floor((a-t)/r)/2+1),g.setNewZoom(t)}},g.zoomProgressLeave=function(e){g.zoomProgressDownBool=!1},g.zoomProgressUp=function(e){if(1==g.zoomProgressDownBool){var t=e.pageY-CloudHelpers.getAbsolutePosition(e.currentTarget).y,a=n.offsetHeight,r=a/5;t=10*(Math.floor((a-t)/r)/2+1),g.setNewZoom(t)}g.zoomProgressDownBool=!1},g.zoomCursorDown=function(e){void 0===e.pageX&&(e.pageX=e.touches[0].pageX),void 0===e.pageY&&(e.pageY=e.touches[0].pageY),g.zoomCursorX=e.pageX,g.zoomCursorY=e.pageY,g.zoomCursorWidth=p.offsetWidth,g.zoomCursorHeight=p.offsetHeight,g.zoomControlsWidth=a.offsetWidth,g.zoomControlsHeight=a.offsetHeight,g.zoomCursorDownBool=!0},g.zoomCursorUp=function(e){console.log("zoomCursorUp"),g.zoomCursorDownBool=!1},g.zoomCursorMove=function(e){if(1==g.zoomCursorDownBool){void 0===e.pageX&&(e.pageX=e.touches[0].pageX),void 0===e.pageY&&(e.pageY=e.touches[0].pageY);var t=g.zoomCursorX-e.pageX,a=g.zoomCursorY-e.pageY;g.zoomCursorX=e.pageX,g.zoomCursorY=e.pageY;var r=p.offsetLeft-t,n=p.offsetTop-a,o=g.zoomControlsWidth-g.zoomCursorWidth*(10/g.currentZoom),i=g.zoomControlsHeight-g.zoomCursorHeight*(10/g.currentZoom),s=-1*o/2,l=o/2,c=-1*i/2,u=i/2;r<s&&(r=s),n<c&&(n=c),l<=r&&(r=l),u<=n&&(n=u),p.style.left=r+"px",p.style.top=n+"px";var d=g.currentZoom/10-1,m=Math.floor(r/o*d*-100),f=Math.floor(n/i*d*-100);g.vjs.videoHeight(),g.vjs.videoWidth();ft(h,m+"%",function(e,t){e.style.left=t}),ft(h,f+"%",function(e,t){e.style.top=t})}},t.onclick=g.zoomUp,r.onclick=g.zoomDown,p.addEventListener("mousedown",g.zoomCursorDown,!1),p.addEventListener("mousemove",g.zoomCursorMove,!1),p.addEventListener("mouseleave",g.zoomCursorUp,!1),p.addEventListener("mouseup",g.zoomCursorUp,!1),p.addEventListener("touchstart",g.zoomCursorDown,!1),p.addEventListener("touchmove",g.zoomCursorMove,!1),p.addEventListener("touchend",g.zoomCursorUp,!1),n.addEventListener("mousedown",g.zoomProgressDown,!1),n.addEventListener("mousemove",g.zoomProgressMove,!1),n.addEventListener("mouseleave",g.zoomProgressLeave,!1),n.addEventListener("mouseup",g.zoomProgressUp,!1)}function ht(){var e=g.player.getElementsByClassName("cloudplayer-volume-mute")[0],t=g.player.getElementsByClassName("cloudplayer-volume-down")[0],a=g.player.getElementsByClassName("cloudplayer-volume-progress")[0],r=g.player.getElementsByClassName("cloudplayer-volume-up")[0],n=g.player.getElementsByClassName("cloudplayer-volume-container")[0],o=g.player.getElementsByClassName("cloudplayer-volume")[0];function i(e){var t=0==e;player_native_hls=document.getElementById(g.elid+"_native_hls"),player_vjs=document.getElementById(g.elid+"_vjs"),player_nv1=document.getElementById(g.elid+"_nv1"),player_nv2=document.getElementById(g.elid+"_nv2"),player_webrtc=document.getElementById(g.elid+"_webrtc"),null!=player_native_hls&&"undefined"!=typeof player_native_hls&&(player_native_hls.muted=t),null!=player_vjs&&"undefined"!=typeof player_vjs&&(player_vjs.muted=t),null!=player_nv1&&"undefined"!=typeof player_nv1&&(player_nv1.muted=t),null!=player_nv2&&"undefined"!=typeof player_nv2&&(player_nv2.muted=t),g.vjs.muted(t),g.vjs.volume(e),Y.volume(e),q.volume(e),null!=c&&(null!=player_webrtc&&"undefined"!=typeof player_webrtc&&(player_webrtc.muted=t),c.volume=e)}if(g.m=g.m||{},g.m.volume=.5,e.style.display="inline-block",g.m.mute?(n.style.display="none",e.classList.add("unmute")):(n.style.display="flex",e.classList.remove("unmute")),g.mute=function(){g.isAudioChannelExists()&&(g.m.mute=!g.m.mute,g.m.mute?(n.style.display="none",e.classList.add("unmute")):(n.style.display="flex",e.classList.remove("unmute")),i(g.m.mute?0:""+g.m.volume.toFixed(1)))},g.volume=function(e){if(g.isAudioChannelExists())return null==e?g.m.volume:(e=(e=1<e?1:e)<0?0:e,g.m.volume=Math.ceil(10*e)/10,i(g.m.mute?0:g.m.volume.toFixed(1)),void(a.className=a.className.replace(/vol\d+/g,"vol"+Math.ceil(10*g.m.volume))))},g.volup=function(){g.isAudioChannelExists()&&(Math.round(10*g.m.volume)<10&&(g.m.volume=g.m.volume+.1,i(g.m.mute?0:g.m.volume.toFixed(1)),a.className=a.className.replace(/vol\d+/g,"vol"+Math.ceil(10*g.m.volume))))},g.voldown=function(){g.isAudioChannelExists()&&(0<Math.round(10*g.m.volume)&&(g.m.volume=g.m.volume-.1,i(g.m.mute?0:g.m.volume.toFixed(1)),a.className=a.className.replace(/vol\d+/g,"vol"+Math.floor(10*g.m.volume))))},e.onclick=g.mute,t.onclick=g.voldown,r.onclick=g.volup,o.addEventListener("input",function(e){g.player.getElementsByClassName("cloudplayer-volume")[0]&&g.volume(e.target.value/100)}),g.vjs.ready(function(){g.isAudioChannelExists()&&(g.vjs.muted(!0),g.volume(g.m.volume))}),g.isAudioChannelExists()||(t.style.display="none",a.style.display="none",r.style.display="none",e.style.display="none"),g.options.disableAudioControl&&1==g.options.disableAudioControl)return g.m.volume=1,g.m.mute=!1,e.style.display="none",t.style.display="none",a.style.display="none",r.style.display="none",n.style.display="none",void(o.style.display="none")}function vt(e,t){if(t.rtc){console.warn("webrtc0 - depracated"),C="webrtc0",Ce.innerHTML="Used player: WebRTC (v0)";var a="https:"==location.protocol?"wss://":"ws://",r=location.hostname,n=8080;m.ServiceProviderUrl;if(t.rtc){var o=CloudHelpers.parseUri(t.rtc).protocol;"http"==o||"ws"==o?a="ws://":"https"==o||"wss"==o?a="wss://":console.warn("Unknown protocol in '"+t+"'"),r=CloudHelpers.parseUri(t.rtc).host,n=CloudHelpers.parseUri(t.rtc).port}var i=a+r+":"+n+"/";g.vjs.el().style.display="none",p.style.display="none",c.style.display="block",window.CloudPlayerWebRTC0?((u=new CloudPlayerWebRTC0(c,i,t.rtmp)).onAutoplayBlocked=g.WebRTC2_autoplayBlocked,u.onServerError=function(e){console.error("[WebRTC0] Event error ",e),g._showerror(CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR),g.stop("by_webrtc0_error")},u.startWS(),it()):console.error("Not found module CloudPlayerWebRTC0")}else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function gt(e,t){if(t.webrtc)if(C="webrtc2",Ce.innerHTML="Used player: WebRTC (v2)",g.vjs.el().style.display="none",p.style.display="none",c.style.display="block",window.CloudPlayerWebRTC2){var a=CloudHelpers.promise();0<CloudHelpers.compareVersions(CloudPlayerWebRTC2.version,t.webrtc.version)?(console.warn("Expected version webrtc.version (v"+t.webrtc.version+")  mismatch with included CloudPlayerWebRTC (v"+CloudPlayerWebRTC2.version+")"),a=CloudHelpers.requestJS(t.webrtc.scripts.player,function(e){for(e=e.replace("CloudPlayerWebRTC =","CloudPlayerWebRTC2 =");-1!==e.indexOf("CloudPlayerWebRTC.");)e=e.replace("CloudPlayerWebRTC.","CloudPlayerWebRTC2.");return e})):a.resolve(),a.done(function(){console.log("[PLAYER] ",t.webrtc.connection_url),(d=new CloudPlayerWebRTC2(c,t.webrtc.connection_url,t.webrtc.ice_servers,{send_video:!1,send_audio:!1})).onAutoplayBlocked=g.WebRTC2_autoplayBlocked,d.onServerError=function(e){console.error("[WebRTC2] Event error ",e),g._showerror(CloudReturnCode.ERROR_WEBRTC_SERVER_ERROR),g.stop("by_webrtc2_error")},d.startWS(),it()})}else console.error("Not found module CloudPlayerWebRTC2");else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function Ct(e,t){if(t.rtmp){Ce.innerHTML="Used player: Flash",g.vjs.ready(function(){console.log("[PLAYER] Set url (rtmp): "+t.rtmp),g.vjs.options().flash.swf=CloudSDK.flashswf||"swf/video-js-by-vxg-buff200.swf",g.vjs.src([{src:t.rtmp,type:"rtmp/mp4"}]),CloudHelpers.isFireFox()?console.warn("in firefox not good solution for a hiding adobe flash player"):Xe.style.display="block"}),g.vjs.off("ended"),g.vjs.on("ended",function(){g.stop("by_rtmp_ended")});var a=!1;g.vjs.off("loadeddata"),g.vjs.on("loadeddata",function(){console.warn("loadeddata"),a=!0,Qe(),e==V?($e(),pt(),ht(),ct()):console.warn("[PLAYER]  _uniqPlay not current [loadeddata]")}),g.vjs.on("playing",function(){nt()}),g.vjs.off("loadedmetadata"),g.vjs.on("loadedmetadata",function(){console.warn("loadedmetadata")}),setTimeout(function(){console.log("[PLAYER] Set url (rtmp) 2: "+t.rtmp),a||g.vjs.src([{src:t.rtmp,type:"rtmp/mp4"}])},5e3),ot(),it(),CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed?ct():g.vjs.play()}else g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function yt(e,t){var a;t.hls?g.m.useNativeHLS?(a=t).hls?(C="native-hls",Ce.innerHTML="Used player: NativeHLS",g.vjs.el().style.display="none",c.style.display="none",p.style.display="block",window.CloudPlayerNativeHLS?((h=new CloudPlayerNativeHLS(p,a.hls)).play(),nt(),it()):console.error("[PLAYER]  Not found module CloudPlayerNativeHLS")):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT):(Ce.innerHTML="Used player: HTML5 (hls)",C="hls",console.log("[PLAYER] Set url (hls): "+t.hls),clearInterval(w),function e(t,a){if(a==V){var r=new XMLHttpRequest;r.open("GET",t.hls),r.onload=function(){if(a==V)if(200===r.status){if(a!=V)return;g._applyMediaTiket(t.hls,t.expire),g.vjs.src([{src:t.hls,type:"application/x-mpegURL"}]),r=null}else if(404===r.status){if(a!=V)return void console.warn("[VXGCLOUDPLAYER] polingHLSList, camid was changed stop poling hls list, currentCmaID="+g.mSrc.getID());if(et<++n)return g.count_ERROR_STREAM_UNREACHABLE=1+(0|g.count_ERROR_STREAM_UNREACHABLE),void(3<g.count_ERROR_STREAM_UNREACHABLE?(g._showerror(CloudReturnCode.ERROR_STREAM_UNREACHABLE_HLS),g.count_ERROR_STREAM_UNREACHABLE=0):(g.stop(),g.play()));setTimeout(function(){console.warn("Wait one sec "+t.hls),r=null,e(t,a)},1e3)}else console.error("Unhandled");else console.warn("_uniqPlay not current [_polingCameraHLSList 2]")},r.send()}else console.warn("_uniqPlay not current [_polingCameraHLSList]")}(t,e),g.vjs.off("ended"),g.vjs.on("ended",function(){g.stop("by_hls_ended"),g._showerror(CloudReturnCode.ERROR_HLS_ENDED)}),l="",g.vjs.off("loadeddata"),g.vjs.on("loadeddata",function(){console.warn("loadeddata"),Qe(),e==V?($e(),pt(),ht(),ct(),CloudHelpers.isSafari()&&(l="loadeddata")):console.warn("_uniqPlay not current [loadeddata]")}),g.vjs.off("loadedmetadata"),g.vjs.on("loadedmetadata",function(){}),g.vjs.off("playing"),g.vjs.on("playing",function(){CloudHelpers.isSafari()&&"loadeddata"===l&&(l="playing"),nt()}),g.vjs.off("pause"),g.vjs.on("pause",function(){CloudHelpers.isSafari()&&"playing"===l&&(l="pause",ct())}),ot(),it(),CloudHelpers.isChrome()&&!CloudHelpers.autoPlayAllowed?ct():g.vjs.play()):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}function At(a){if(null!=V&&a!=V)return console.warn("[_polingCameraStatus] _uniqPlay not current 1"),void clearInterval(_);if(!g.mSrc)return console.warn("[_polingCameraStatus] no source"),void clearInterval(_);if("camera"!=g.mSrc.type)return console.warn("[_polingCameraStatus] no type camera"),void clearInterval(_);var e=g.mSrc.getID(),r=g.mSrc._origJson().status;m._getAPI().getCamera2(e,{}).done(function(e){var t=e.status;if(null!=V&&a!=V)return console.warn("[_polingCameraStatus] _uniqPlay not current (2) "+a+"!="+V),void clearInterval(_);"active"!==t&&0!=g.m.waitSourceActivation&&H>g.m.waitSourceActivation&&(g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),H=0),r!=t&&(console.warn("switched camera status: from "+r+" to "+t+" mLiveModeAutoStart: "+A),g.mSrc._origJson().status=t,A&&("active"==t?g.play():(g.stop("by_poling_camera_status"),g._showerror(CloudReturnCode.ERROR_CAMERA_OFFLINE),_t(a))),f.executeCallbacks(CloudPlayerEvent.CHANNEL_STATUS,{status:t}),P&&setTimeout(function(){P(g,t)},10))}).fail(function(e){console.error("[_polingCameraStatus] ",e),g.mSrc._origJson().status="error"})}function _t(t){setTimeout(function(){A=!0,clearInterval(_),At(t),H=100;var e=3e3;e="active"==g.mSrc._origJson().status?j:z,_=setInterval(function(){0<H&&(H+=e),At(t)},e)},100)}g.isRange=function(){return-1!=D&&-1!=L},g.resetRange=function(){console.warn("[PLAYER] resetRange"),L=D=-1},g._showZoomControl=function(e){Q.style.display=e?ae.style.display="block":ae.style.display="none"},pt(),g.isAudioChannelExists=function(){return!0},g.updateAudioStream=function(){el_info_audio_stream.style.display="none",m._getAPI().cameraMediaStreams(g.currentCamID).done(function(e){if(e.mstreams_supported&&1<e.mstreams_supported.length){for(var t in el_info_audio_stream.style.display="block",g.mstreams.audio_on="",g.mstreams.audio_off="",g.mstreams.current=e.live_ms_id,e.mstreams_supported)e.mstreams_supported[t].as_id&&e.mstreams_supported[t].vs_id?g.mstreams.audio_on=e.mstreams_supported[t].id:e.mstreams_supported[t].vs_id&&(g.mstreams.audio_off=e.mstreams_supported[t].id);g.mstreams.audio_on==g.mstreams.current?el_info_audio_stream_on.classList.add("selected"):g.mstreams.audio_off==g.mstreams.current&&el_info_audio_stream_off.classList.add("selected")}else el_info_audio_stream.style.display="none";g.isAudioChannelExists()}).fail(function(e){console.error(e),el_info_audio_stream.style.display="none"})},ht(),g.WebRTC0_autoplayBlocked=function(){ot();try{u.stopWS()}catch(e){console.warn("WebRTC0_autoplayBlocked: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,ge.style.display="block",ge.onclick=function(e){a=e,ge.style.display="none",!1,n=0,g.play()}},g.WebRTC2_autoplayBlocked=function(){ot();try{d.stopWS()}catch(e){console.warn("WebRTC2_autoplayBlocked: skip error",e)}n=0,console.warn("_vjs_play. is mobile or autoplay not allowed. show big button"),!0,ge.style.display="block",ge.onclick=function(e){a=e,ge.style.display="none",!1,n=0,g.play()}},g._polingLoadCameraLiveUrl=function(a){a==V?"camera"==g.mSrc.type?(g.updateAudioCaps&&g.updateAudioCaps(g.mSrc.getID()),at="camera_live",C="",m._getAPI().cameraLiveUrls(g.mSrc.getID()).done(function(e){if(a==V){Je(e);var t=1;e.webrtc&&(t=e.webrtc.version.split(".")[0],t=parseInt(t,10)),e.hls||e.rtmp||(b="webrtc"),null===b?("webrtc"==g.mPlayerFormat&&(e.rtc&&CloudHelpers.supportWebRTC()?vt(0,e):e.webrtc&&2===t&&CloudHelpers.supportWebRTC()?gt(0,e):yt(a,e)),"flash"==g.mPlayerFormat&&(CloudHelpers.useHls()?yt(a,e):Ct(a,e)),"html5"==g.mPlayerFormat&&yt(a,e)):"flash"===b?Ct(a,e):"html5"===b?yt(a,e):e.rtc&&"webrtc"===b?vt(0,e):e.webrtc&&2===t&&"webrtc"===b?gt(0,e):g._showerror(CloudReturnCode.NOT_SUPPORTED_FORMAT)}else console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl.done]")}).fail(function(e){console.error(e),a==V?e.status&&503==e.status&&++n<g.timePolingLiveUrls?setTimeout(function(){g._polingLoadCameraLiveUrl(a)},1e3):console.error(e):console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl.fail]")})):g._showerror(CloudReturnCode.ERROR_INVALID_SOURCE):console.warn("_uniqPlay not current [_polingLoadCameraLiveUrl]")},g._reset_players=function(){console.log("_reset_players"),g.vjs.reset(),g.vjs.controls(!1),g.vjs.muted(!0),g.vjs.autoplay(!0),g.vjs.volume(0),g.vjs.el().style.display="",Y.reset(),Y.el().style.display="none",q.reset(),q.el().style.display="none",g.volume(g.m.volume),ot(),g._stopPolingMediaTicket()},g.isPlaying=function(){return i},g.set_controls_opacity=function(e){Z.style.opacity!=e&&f.executeCallbacks(CloudPlayerEvent.CHANGED_CONTROLS,{opacity:e}),Z.style.opacity=e,Q.style.opacity=e,ee.style.opacity=e,te.style.opacity=e,le.style.opacity=e,S.style.opacity=e,ie.style.opacity=e,X.style.opacity=e,xe.style.opacity=e,Ue.style.opacity=e;var t=g.player.getElementsByClassName("cloudplayer-selectcliptime")[0];parseInt(e)||(t.style.display="none")},g.restartTimeout=function(){g.m.autohide<0?g.set_controls_opacity("0"):0!=g.m.autohide?(g.set_controls_opacity("1"),clearTimeout(g.timeout),g.timeout=setTimeout(function(){g.set_controls_opacity("0")},g.m.autohide)):g.set_controls_opacity("1")},g.restartTimeout(),g.player.addEventListener("mousemove",g.restartTimeout,!0),g.player.addEventListener("touchmove",g.restartTimeout,!0),g.player.addEventListener("touchstart",g.restartTimeout,!0),se.onclick=function(){g.play("by_button_click")},de.onclick=function(){g.pause("by_button_click")},ue.onclick=function(){g.stop("by_button_click")},g.size=function(e,t){console.error("[CloudPlayer] size not support")},g.setFullscreenCallback=function(e){g.f_callbackFullscreenFunc=e},g.initFullscreenControls=function(){var e,t,a,r,n=g.player.getElementsByClassName("cloudplayer-fullscreen")[0];g.changedFullscreen=function(){console.log("changedFullscreen: "+document.webkitIsFullScreen),document.webkitIsFullScreen?(e=g.player.style.height,t=g.player.style.width,r=g.player.style.maxHeight,a=g.player.style.maxWidth,g.player.style.height="100%",g.player.style.width="100%",g.player.style.maxHeight="100%",g.player.style.maxWidth="100%",console.log("changedFullscreen -> fullscreen"),screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape")):(g.player.style.height=e,g.player.style.width=t,g.player.style.maxHeight=r,g.player.style.maxWidth=a,console.log("changedFullscreen -> NOT fullscreen")),g.f_callbackFullscreenFunc&&g.f_callbackFullscreenFunc()},g.player.onwebkitfullscreenchange=g.changedFullscreen,g.player.onmozfullscreenchange=g.changedFullscreen,g.player.onfullscreenchange=g.changedFullscreen,g.fullscreen=function(){console.log("fullscreen: clicked"),1==document.webkitIsFullScreen?document.webkitCancelFullScreen():document.mozFullScreen?document.mozCancelFullScreen():document.msFullscreenElement&&null!=document.msFullscreenElement?document.msExitFullscreen():g.player.mozRequestFullScreen?g.player.mozRequestFullScreen():g.player.requestFullscreen?g.player.requestFullscreen():g.player.webkitRequestFullscreen?g.player.webkitRequestFullscreen():g.player.msRequestFullscreen&&g.player.msRequestFullscreen()},n.onclick=g.fullscreen},g.initFullscreenControls(),g.initHLSMechanism=function(){g._applyMediaTiket=function(e,t){console.log("media-tiсket: old = "+g.hls_mediaticket_value),-1!=e.indexOf("?")&&(g.hls_mediaticket_value="?"+e.split("?")[1]),Date.parse(t+"Z"),console.log("media-tiсket: new = "+g.hls_mediaticket_value)},g._stopPolingMediaTicket=function(){clearInterval(g._polingMediaTicketInterval)}},g.initHLSMechanism(),(window._cloudPlayers[o]=g).pano=CloudPano(g.player.getElementsByClassName("allvideotags")[0],g),g.enableSpeedSetting=function(){Ee.classList.add("enabled")},g.disableSpeedSetting=function(){Ee.classList.remove("enabled")},g.enableModeSetting=function(){_e.classList.add("enabled")},g.disableModeSetting=function(){_e.classList.remove("enabled")},void 0!==g.mPreferredPlayerFormat?g.disableModeSetting():g.enableModeSetting()},CloudPlayer.POSITION_LIVE=-1;var CloudShareClipModel=function(e){this.controller=e,this.camera=null,this.accessToken=null};CloudShareClipModel.prototype.createClip=function(e,t,a,r,n,o){if(null!=e){this.camera=e,this.accessToken=t;var i=this;this.camera.createClip(a,r,n,o,this.accessToken).done(function(e){var t=e.id,a=e.status;"pending"===a?setTimeout(function(){i.clipStatus(t)},3e3):"done"===a?i.controller.processDone(a,e):i.controller.processDone(a)}).fail(function(e){i.controller.processDone("error")})}},CloudShareClipModel.prototype.clipStatus=function(a){var r=this;this.camera&&void 0!==this.camera&&this.camera.getClip(a,this.accessToken).done(function(e){console.log("Clip Status OK:"+e.status);var t=e.status;""===t||"pending"===t?setTimeout(function(){r.clipStatus(a)},3e3):"done"===t?r.controller.processDone(t,e):r.controller.processDone(t)}).fail(function(e){r.controller.processDone("error")})};var CloudShareClipView=function(e){this.element=e};CloudShareClipView.prototype.initDraw=function(e){this.element.innerHTML='<div class= "CloudShareClipContainer"></div>';this.element;this.container=this.element.getElementsByClassName("CloudShareClipContainer")[0],this.render(e)},CloudShareClipView.prototype.render=function(e){},CloudShareClipView.prototype.showWait=function(e){var t=this.container;e?$(t).addClass("waitdata"):$(t).removeClass("waitdata")};var CloudShareClipController=function(e){void 0!==e&&(this.callback_func=null,this.inProcess=!1,this.clModel=new CloudShareClipModel(this),this.clView=new CloudShareClipView(e),this.clView.element.createClip=this.createClip.bind(this),this.clView.initDraw(this))};CloudShareClipController.prototype.processDone=function(e,t){this.inProcess=!1,this.callback_func&&this.callback_func(this.inProcess,e,t)},CloudShareClipController.prototype.createClip=function(e,t,a,r,n){if(void 0!==a&&(this.callback_func=a),this.inProcess)return console.warn("CloudShareClip in process.."),void(this.callback_func&&this.callback_func(this.inProcess,"CloudShareClip in process.."));this.inProcess=!0,this.callback_func&&this.callback_func(this.inProcess,"CloudShareClip started"),void 0===n&&(n=2e4);var o=r+n,i="clip_"+r,s=(new Date).getTime()+9e5;console.log("DEBUG create clip "+e.getName()+" time:"+r+" dur:"+n),this.clModel.createClip(e,t,i,r,o,s)},CloudShareClipController.prototype.showWait=function(e){console.log("DEBUG swhoWait "+e),this.clView.showWait(e)},window.CloudPlayerNativeHLS=function(e,t){var a=e,r=t;console.warn("[NativeHLS] canPlay: application/vnd.apple.mpegurl => ",a.canPlayType("application/vnd.apple.mpegurl")),console.warn("[NativeHLS] canPlay: application/x-mpegURL => ",a.canPlayType("application/x-mpegURL")),console.warn("[NativeHLS] canPlay: video/mp4 => ",a.canPlayType("video/mp4")),this.play=function(){0<a.children.length&&a.removeChild(a.children[0]);var e=document.createElement("source");e.src=r,e.type="video/mp4",a.append(e),a.load()},this.stop=function(){0<a.children.length&&a.removeChild(a.children[0])},a.addEventListener("abort",function(){console.warn("[NativeHLS] abort")},!0),a.addEventListener("canplay",function(){console.warn("[NativeHLS] canplay")},!0),a.addEventListener("canplaythrough",function(){console.warn("[NativeHLS] canplaythrough")},!0),a.addEventListener("durationchange",function(){console.warn("[NativeHLS] durationchange")},!0),a.addEventListener("emptied",function(){console.warn("[NativeHLS] emptied")},!0),a.addEventListener("encrypted",function(){console.warn("[NativeHLS] encrypted")},!0),a.addEventListener("ended",function(){console.warn("[NativeHLS] ended")},!0),a.addEventListener("error",function(e,t){console.error("[NativeHLS] error ",e),console.error("[NativeHLS] error ",t)},!0),a.addEventListener("interruptbegin",function(){console.warn("[NativeHLS] interruptbegin")},!0),a.addEventListener("interruptend",function(){console.warn("[NativeHLS] interruptend")},!0),a.addEventListener("loadeddata",function(){console.warn("[NativeHLS] loadeddata"),a.play()},!0),a.addEventListener("loadedmetadata",function(){console.warn("[NativeHLS] loadedmetadata")},!0),a.addEventListener("loadstart",function(){console.warn("[NativeHLS] loadstart")},!0),a.addEventListener("mozaudioavailable",function(){console.warn("[NativeHLS] mozaudioavailable")},!0),a.addEventListener("pause",function(){console.warn("[NativeHLS] pause")},!0),a.addEventListener("play",function(){console.warn("[NativeHLS] play")},!0),a.addEventListener("playing",function(){console.warn("[NativeHLS] playing")},!0),a.addEventListener("progress",function(){console.warn("[NativeHLS] progress")},!0),a.addEventListener("ratechange",function(){console.warn("[NativeHLS] ratechange")},!0),a.addEventListener("seeked",function(){console.warn("[NativeHLS] seeked")},!0),a.addEventListener("seeking",function(){console.warn("[NativeHLS] seeking")},!0),a.addEventListener("stalled",function(){console.warn("[NativeHLS] stalled")},!0),a.addEventListener("suspend",function(){console.warn("[NativeHLS] suspend")},!0),a.addEventListener("timeupdate",function(){console.warn("[NativeHLS] timeupdate")},!0),a.addEventListener("volumechange",function(){console.warn("[NativeHLS] volumechange")},!0),a.addEventListener("waiting",function(){console.warn("[NativeHLS] waiting")},!0)},window.CloudPlayerNativeVideo=function(e){var a=document.getElementById(e),t=null,r=this,n="[NativeVideo] ",o=0,i=null;r.onAutoplayBlocked=function(){},r.on=function(e,t){"error"==e?i=t:"loadeddata"==e?a.onloadeddata=t:"ended"==e?a.onended=t:"autoplay_blocked"==e?t:console.error(n+"ON Unknown "+e)},r.off=function(e){"loadeddata"==e?a.onloadeddata=null:"ended"==e?a.onended=null:console.error(n+"OFF Unknown "+e)},r.ready=function(e){e(),console.log(n+"TODO ready")},r.muted=function(e){a.muted=e,console.log(n+"TODO muted")},r.volume=function(e){if(void 0===e)return a.volume;a.volume=e},r.reset=function(){console.warn(n,"reset"),!0,o=0,a.pause(),null!=t&&t.removeAttribute("src"),a.load()},r.controls=function(e){console.log(n+"TODO controls")},r.autoplay=function(e){1==e&&console.error(n+"Not supported autoplay")},r.el=function(){return a},r.src=function(e){null==t&&(t=document.createElement("source"),a.appendChild(t)),a.pause(),a.currentTime=0,t.setAttribute("src",e[0].src),a.load()},r.currentTime=function(e){return void 0!==e?(o=e,void(a.currentTime=e)):a.currentTime||o},r.play=function(){var e,t;e=a.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(n+"checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(n+"_checkAutoPlay: error.name:","NotAllowedError"),r.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(n+"_checkAutoPlay: AbortError (Safari)"),r.onAutoplayBlocked()):(console.error(e),console.error(n+"checkAutoplay: happened something else"))}).then(function(){console.log(n+"checkAutoplay: then")}):console.error(n+"checkAutoplay: could not work in your browser ",e)},r.pause=function(){a.pause()},a.addEventListener("abort",function(){},!0),a.addEventListener("canplay",function(){},!0),a.addEventListener("canplaythrough",function(){},!0),a.addEventListener("durationchange",function(){},!0),a.addEventListener("emptied",function(){},!0),a.addEventListener("encrypted",function(){},!0),a.addEventListener("ended",function(){console.warn(n+"ended")},!0),a.addEventListener("error",function(e,t){console.error(n+"err0 ",e),null!=i&&i(e)},!0),a.addEventListener("interruptbegin",function(){},!0),a.addEventListener("interruptend",function(){},!0),a.addEventListener("loadeddata",function(){a.currentTime=o},!0),a.addEventListener("loadedmetadata",function(){},!0),a.addEventListener("loadstart",function(){},!0),a.addEventListener("mozaudioavailable",function(){},!0),a.addEventListener("pause",function(){},!0),a.addEventListener("play",function(){},!0),a.addEventListener("playing",function(){},!0),a.addEventListener("progress",function(){},!0),a.addEventListener("ratechange",function(){},!0),a.addEventListener("seeked",function(){},!0),a.addEventListener("seeking",function(){},!0),a.addEventListener("stalled",function(){},!0),a.addEventListener("suspend",function(){},!0),a.addEventListener("timeupdate",function(){},!0),a.addEventListener("volumechange",function(){},!0),a.addEventListener("waiting",function(){},!0)},window.CloudPlayerWebRTC0=function(e,t,a){var r,n=e,o=t,i=a,s=null,l="[WEBRTC0] ",c={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:turn.vxg.io:3478?transport=udp"],username:"vxgturn",credential:"vxgturn"}]},u=this,d=Math.floor(8990*Math.random()+10).toString();u.onWsError=function(e){console.error(e)},u.onAutoplayBlocked=function(){console.error(l+"onAutoplayBlocked")},CloudHelpers.isSafari()&&navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(e){console.log(l+"Camera permission granted")}).catch(function(e,t){console.error(e,t)}),u.pause=function(){n&&n.src&&n.pause()},u.play=function(){n&&n.src&&n.play()},u.resetState=function(){r.close()},u.handleIncomingError=function(e){console.error(l+"IncomingError: ",e),resetState()},u.resetVideoElement=function(){n.pause(),n.src="",n.load()},u.onIncomingSDP=function(e){e.sdp=e.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f"),console.log(l+"Incoming SDP is "+JSON.stringify(e)),s.setRemoteDescription(e).then(function(){console.log("Remote SDP set"),"offer"==e.type&&(console.log(l+"Got SDP offer, creating answer"),s.createAnswer().then(u.onLocalDescription).catch(function(e){console.error("[WEBRTC0] createAnswer: ",e)}))}).catch(function(e){console.error(l+"setRemoteDescription: ",e)})},u.onLocalDescription=function(e){console.log(l+"Got local description: "+JSON.stringify(e)),s.setLocalDescription(e).then(function(){var e,t;console.log(l+"Sending SDP answer"),sdp={sdp:s.localDescription},r.send(JSON.stringify(sdp)),console.warn(l+"Streaming (1)"),e=n.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(l+"_checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(l+"_checkAutoPlay: error.name:","NotAllowedError"),u.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(l+"_checkAutoPlay: AbortError (Safari)"),u.onAutoplayBlocked()):(console.error(e),console.error(l+"checkAutoplay: happened something else"))}).then(function(){console.log(l+"checkAutoplay: then")}):console.error(l+"_checkAutoplay: could not work in your browser ",e)})},u.onIncomingICE=function(e){console.log(l+"Incoming ICE: "+JSON.stringify(e));var t=new RTCIceCandidate(e);s.addIceCandidate(t).catch(function(e){console.error(l+"addIceCandidate ",e)})},u.onServerMessage=function(t){switch(console.log(l+"Received "+t.data),t.data){case"HELLO":return void console.log(l+"Registered with server, waiting for stream");default:if(t.data.startsWith("ERROR"))return void u.handleIncomingError(t.data);try{msg=JSON.parse(t.data)}catch(e){return void(e instanceof SyntaxError?handleIncomingError("Error parsing incoming JSON: "+t.data):handleIncomingError("Unknown error parsing response: "+t.data))}null==s&&u.createCall(msg),null!=msg.sdp?u.onIncomingSDP(msg.sdp):null!=msg.ice?u.onIncomingICE(msg.ice):u.handleIncomingError("Unknown incoming JSON: "+msg)}},u.stopWS=function(){r.close()},u.onServerClose=function(e){u.resetVideoElement(),null!=s&&(s.close(),s=null)},u.onServerError=function(e){console.error("[WEBRTC0] Unable to connect to server, did you add an exception for the certificate?")},u.onRemoteStreamAdded=function(e){videoTracks=e.stream.getVideoTracks(),audioTracks=e.stream.getAudioTracks(),0<videoTracks.length?(console.log("[WEBRTC0] Incoming stream: "+videoTracks.length+" video tracks and "+audioTracks.length+" audio tracks"),n.srcObject=e.stream):u.handleIncomingError("[WEBRTC0] Stream with unknown tracks added, resetting")},u.errorUserMediaHandler=function(){console.error("[WEBRTC0] Browser doesn't support getUserMedia!")},u.createCall=function(e){connect_attempts=0,(s=new RTCPeerConnection(c)).onaddstream=u.onRemoteStreamAdded,e.sdp||console.log("[WEBRTC0] WARNING: First message wasn't an SDP message!?"),s.onicecandidate=function(e){null!=e.candidate?r.send(JSON.stringify({ice:e.candidate})):console.error("[WEBRTC0] ICE Candidate was null, done")},console.log("[WEBRTC0] Created peer connection for call, waiting for SDP")},u.startWS=function(){if(u.connect_attempts++,3<u.connect_attempts)console.error("[WEBRTC0] Too many connection attempts, aborting. Refresh page to try again");else{console.log("[WEBRTC0] Connecting to server..."),loc=null,(r=new WebSocket(o)).addEventListener("open",function(e){r.send("HELLO "+d),console.log(l+"Registering with server"),r.send("SPAWN "+i)}),r.addEventListener("error",u.onServerError),r.addEventListener("message",u.onServerMessage),r.addEventListener("close",u.onServerClose)}}},window.CloudPlayerWebRTC2=function(e,t,a,r){r=r||{};var o=this,i="[WEBRTC2] ";console.log(i,r);var s=e,l="",n=t||"",c=r.send_video||!1,u=r.send_audio||!1,d={},m={iceServers:a||[]},f=!1,p=null;function h(){console.warn(i+"loadeddata"),console.warn(i+"currentTime = "+s.currentTime)}o.onWsError=function(e){console.error("[WEBRTC2] onWsError, ",e)},o.resetState=function(){p.close()},o.handleIncomingError=function(e){console.error("[WEBRTC2] ERROR: ",e),o.resetState()},o.pause=function(){s&&s.srcObject&&s.pause()},o.play=function(){s&&s.srcObject&&s.play()},o.reset=function(){s&&s.srcObject&&(s.pause(),s.srcObject=null,l="",s.load())},o.el=function(){return s},o.onAutoplayBlocked=function(){console.error(i+"onAutoplayBlocked")},o.initCalbacks=function(){s&&s.addEventListener("loadeddata",h,!0)},o.removeCalbacks=function(){s&&s.removeEventListener("loadeddata",h,!0)},o.createWatchingConnection=function(t){connect_attempts=0,console.assert(!(t in d)),objPeer=new RTCPeerConnection(m),objPeer.strPeerUID=t,d[t]=objPeer,objPeer.onaddstream=o.onRemoteStreamAdded,objPeer.onicecandidate=function(e){null!=e.candidate?p.send(JSON.stringify({to:t,ice:e.candidate})):console.error("[WEBRTC2] ICE Candidate was null, done")},console.log("[WEBRTC2] Created peer connection for call, waiting for SDP")},o.getUserMediaConstraints=function(){var e={};e.audio=u,e.video=c;try{console.warn(i+"getSupportedConstraints: ",navigator.mediaDevices.getSupportedConstraints())}catch(e){console.error(i+"error on getSupportedConstraints",e)}return e},o.createPublishingConnection=function(a){connect_attempts=0,console.assert(!(a in d)),f=!0,u||c?navigator.mediaDevices.getUserMedia(o.getUserMediaConstraints()).then(function(e){console.log("[WEBRTC2] Local stream successfully received");var t=new RTCPeerConnection(m);t.strPeerUID=a,(d[a]=t).onaddstream=o.onRemoteStreamAdded,t.onicecandidate=function(e){null!=e.candidate?p.send(JSON.stringify({to:a,ice:e.candidate})):console.error("[WEBRTC2] ICE Candidate was null, done")},t.onconnectionstatechange=function(e){console.error("[WEBRTC2] Connection state changed "+t.connectionState)},console.log("[WEBRTC2] Created peer connection for publishing"),t.addStream(e),console.log("[WEBRTC2] Local SDP set"),t.createOffer().then(function(e){t.setLocalDescription(e),console.log("[WEBRTC2] Sending SDP offer"),sdp={to:a,sdp:e},p.send(JSON.stringify(sdp)),console.warn("[WEBRTC2] Streaming (1)")}).catch(function(e){console.error("[WEBRTC2] error on createOffer ",e)})}).catch(function(e,t){console.error("[WEBRTC2] error on getUserMedia a1 = ",e),console.error("[WEBRTC2] error on getUserMedia a2 = ",t)}):console.error("[WEBRTC2] Publisher must send audio or video stream")},o.onIncomingSDP=function(a,r,n){n.sdp=n.sdp.replace(/profile-level-id=[^;]+/,"profile-level-id=42e01f"),console.log("[WEBRTC2] Incoming SDP from "+a+": "+JSON.stringify(n)),r.setRemoteDescription(n).then(function(){console.log("[WEBRTC2] Remote SDP set"),f?(console.assert("answer"===n.type),console.log("[WEBRTC2] Got SDP answer from "+a)):(console.assert("offer"===n.type),console.log("[WEBRTC2] Got SDP offer from "+a),onLocalDescription=function(e){console.log("[WEBRTC2] Got local description: "+JSON.stringify(e)),r.setLocalDescription(e).then(function(){var e,t;console.log("[WEBRTC2] Sending SDP answer to "+a),n={to:a,sdp:r.localDescription},p.send(JSON.stringify(n)),console.warn("[WEBRTC2] Streaming (2)"),e=s.play(),t="",window.Promise&&(t=window.Promise.toString()),-1!==t.indexOf("function Promise()")||-1!==t.indexOf("function ZoneAwarePromise()")?e.catch(function(e){console.error(i+"_checkAutoplay, error:",e),"NotAllowedError"==e.name?(console.error(i+"_checkAutoPlay: error.name:","NotAllowedError"),o.onAutoplayBlocked()):"AbortError"==e.name&&CloudHelpers.isSafari()?(console.error(i+"_checkAutoPlay: AbortError (Safari)"),o.onAutoplayBlocked()):(console.error(e),console.error(i+"checkAutoplay: happened something else"))}).then(function(){console.log(i+"checkAutoplay: then")}):console.error(i+"_checkAutoplay: could not work in your browser ",e)})},c||u?(console.log("[WEBRTC2] Watcher is configured to send stream"),navigator.mediaDevices.getUserMedia({audio:u,video:c}).then(function(e){r.addStream(e),console.log("[WEBRTC2] Local SDP set, creating answer"),r.createAnswer().then(onLocalDescription).catch(function(e){console.error("[WEBRTC2] error on createAnswer (1) ",e)})})):(console.log("[WEBRTC2] Creating answer without stream sending"),r.createAnswer().then(onLocalDescription).catch(function(e){console.error("[WEBRTC2] error on createAnswer (2) ",e)})))}).catch(function(e){console.error("[WEBRTC2] error on setRemoteDescription ",e)})},o.onIncomingICE=function(e,t,a){console.log("[WEBRTC2] Incoming ICE from "+e+": "+JSON.stringify(a));var r=new RTCIceCandidate(a);t.addIceCandidate(r).catch(function(e){console.error("[WEBRTC2] error on addIceCandidate ",e)})},o.onServerMessage=function(t){if(console.log("[WEBRTC2] Received "+t.data),t.data.startsWith("HELLO"))console.log("[WEBRTC2] Registered with server, waiting for stream");else{if(t.data.startsWith("SESSION_STARTED")){var e=t.data.split(" ")[1];return console.log("[WEBRTC2] Publisher "+e+" is going to start session"),void o.createWatchingConnection(e)}if(t.data.startsWith("SESSION_STOPPED")){e=t.data.split(" ")[1];return console.log("[WEBRTC2] Session of publisher "+e+" is terminated"),void(e in d&&(d[e]&&(d[e].close(),d[e]=null),delete d[e],s&&l===e&&o.reset()))}if(t.data.startsWith("START_SESSION")){e=t.data.split(" ")[1];return console.log("[WEBRTC2] Watcher "+e+" has come and awaiting for publishing"),void o.createPublishingConnection(e)}if(t.data.startsWith("ERROR"))o.handleIncomingError(t.data);else{var a=null,r="",n=null;try{r=(a=JSON.parse(t.data)).from,n=d[r]}catch(e){return void(e instanceof SyntaxError?o.handleIncomingError("Error parsing incoming JSON: "+t.data):o.handleIncomingError("Unknown error parsing response: "+t.data))}null!=a.sdp?o.onIncomingSDP(r,n,a.sdp):null!=a.ice?o.onIncomingICE(r,n,a.ice):o.handleIncomingError("Unknown incoming JSON: "+a)}}},o.stopWS=function(){p.close(),o.removeCalbacks()},o.onServerClose=function(e){for(strSessionPartnerPeerUID in console.error("[WEBRTC2] Closed WebRTC ",e),o.reset(),d)d[strSessionPartnerPeerUID]&&(d[strSessionPartnerPeerUID].close(),d[strSessionPartnerPeerUID]=null);d={}},o.onServerError=function(e){console.error("[WEBRTC2] Unable to connect to server, did you add an exception for the certificate?",e)},o.onRemoteStreamAdded=function(e){videoTracks=e.stream.getVideoTracks(),audioTracks=e.stream.getAudioTracks(),0<videoTracks.length||0<audioTracks.length?(console.log("[WEBRTC2] Incoming stream: "+videoTracks.length+" video tracks and "+audioTracks.length+" audio tracks"),s&&""===l&&(s.srcObject=e.stream,l=e.currentTarget.strPeerUID)):o.handleIncomingError("[WEBRTC2] Stream with unknown tracks added, resetting")},o.errorUserMediaHandler=function(){console.error("[WEBRTC2] Browser doesn't support getUserMedia!")},o.startWS=function(){if(o.connect_attempts++,3<o.connect_attempts)console.error("[WEBRTC2] Too many connection attempts, aborting. Refresh page to try again");else{console.log("[WEBRTC2] Connecting to server..."),(p=new WebSocket(n)).addEventListener("open",function(e){p.send("HELLO "+window.CloudPlayerWebRTC2.version),console.log("[WEBRTC2] Registering with server")}),p.addEventListener("error",o.onServerError),p.addEventListener("message",o.onServerMessage),p.addEventListener("close",o.onServerClose)}}},window.CloudPlayerWebRTC2.version="2.0.1",window.CloudCameraTimelineMode={},CloudCameraTimelineMode.MINUTES_MODE={name:"MINUTES_MODE",code:0},CloudCameraTimelineMode.HOUR_MODE={name:"HOUR_MODE",code:1},CloudCameraTimelineMode.HOURS_12_MODE={name:"HOURS_12_MODE",code:2},window.CloudCameraTimelineView=function(e,t,a){var A=this;t=A.options=t||{};var f=null,l=0,r=null,p=108e5,h={},n=0,v=!1,o=0,i=0,g=0,s=e,c=null,d=0,m=null,C=-1,y=-1,u=!1,_=0,E=0,P=!1,b=0,S=0,T=!1,w=null,M=null,R=null,I=CloudHelpers.createCallbacks(),k=null,O=null,N=null,D=null;function L(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}t.useTimezone&&(w=t.useTimezone,console.warn("[CloudTimeline] useTimezone: "+w)),void 0!==t.calendar&&(T=1==t.calendar),void 0!==t.polingRangeDataEveryInSec&&(M=parseInt(t.polingRangeDataEveryInSec));var x={HOURS_12_MODE:{len_ms:324e5,step_short:18e5,step_long:9e6},HOUR_MODE:{len_ms:54e5,step_short:3e5,step_long:18e5},MINUTES_MODE:{len_ms:9e5,step_short:6e4,step_long:3e5}},U=1086e4,H=L(x.MINUTES_MODE),z=document.createElement("div");z.classList.add("cloudcameratimeline"),z.classList.add("green"),z.classList.add("black"),N=a&&a.player?(k=a.player.getElementsByClassName("cloudplayer-timeline-container")[0],O=a.player.getElementsByClassName("cloudplayer-calendar-container")[0],a.player.getElementsByClassName("cloudplayer-live-container")[0]):(k=document.getElementsByClassName("cloudplayer-timeline-container")[0],O=document.getElementsByClassName("cloudplayer-calendar-container")[0],document.getElementsByClassName("cloudplayer-live-container")[0]),z.innerHTML='<div class="cloudcameratimeline-calendar" style="display: none"></div><div class="cloudcameratimeline-shift shift-minus">-1h</div><div class="cloudcameratimeline-left"></div><div class="cloudcameratimeline-content">\t\t<div class="cloudcameratimeline-scale"></div>\t\t<div class="cloudcameratimeline-data"></div>\t\t<div class="cloudcameratimeline-cursor"></div></div></div><div class="cloudcameratimeline-right"></div><div class="cloudcameratimeline-shift shift-plus">+1h</div><div class="cloudcameratimeline-goto-live disabled">Live</div>',A.left_border=Math.floor(CloudHelpers.getCurrentTimeUTC()-H.len_ms/2),A.right_border=Math.floor(A.left_border+H.len_ms);var j=z.getElementsByClassName("cloudcameratimeline-content")[0],B=z.getElementsByClassName("cloudcameratimeline-data")[0],F=z.getElementsByClassName("cloudcameratimeline-calendar")[0],W=z.getElementsByClassName("cloudcameratimeline-cursor")[0],G=z.getElementsByClassName("cloudcameratimeline-scale")[0],Y=z.getElementsByClassName("cloudcameratimeline-goto-live")[0],q=z.getElementsByClassName("cloudcameratimeline-left")[0],V=z.getElementsByClassName("cloudcameratimeline-right")[0],K=z.getElementsByClassName("shift-minus")[0],Z=z.getElementsByClassName("shift-plus")[0];O.appendChild(F),N.appendChild(Y),A.elem=document.getElementById(e),D=null!=A.elem&&"DIV"===A.elem.tagName?(A.elem.appendChild(z),A.elem):(k.appendChild(z),k);var $=null;function J(){o!=G.offsetWidth&&0!=G.offsetWidth&&(o=G.offsetWidth),i=o/(A.right_border-A.left_border),g=(A.right_border-A.left_border)/o}function X(e){var t=e;return t-=t%1e3,t-=t%p}function Q(){clearInterval(A._polingCursor),Y.classList.remove("now"),Y.classList.add("disabled")}function ee(){if(null!=f&&"camera"==f.type){var e=f.getID(),t=CloudHelpers.formatUTCTime(d);if(null==r._getAPI())return;r._getAPI().storageRecordsFirst(e,t,50).done(function(e){var t=!1;for(var a in e.objects){var r=e.objects[a],n=CloudHelpers.parseUTCTime(r.start),o=CloudHelpers.parseUTCTime(r.end),i=X(n);X(o);h[i]||(h[i]={status:1,data:[]});var s=0,l=0;for(var c in h[i].data){(u=h[i].data[c]).end>l&&(l=u.end),u.start<n&&n-2e3<u.end&&(o>u.end?(h[i].data[c].end=o,s=1,A._eventRedrawTimeline(),t=!0):s=2)}if(0==s&&l<o){var u={start:n,end:o};h[i].data.push(u),A._eventRedrawTimeline(),t=!0}d<o&&(d=o+CloudHelpers.ONE_SECOND)}t&&(I.executeCallbacks(CloudPlayerEvent.TIMELINE_END_UPDATED,{}),null!=m&&setTimeout(m.onTimelineEndUpdate,1))})}}function te(e){return Math.floor((e-A.left_border)*i)}function ae(e){if(e=e||{},null!=m&&null!=m.getSource()?m.isLive()?(Y.classList.remove("disabled"),Y.classList.add("now")):(Y.classList.remove("disabled"),Y.classList.remove("now")):(Y.classList.remove("now"),Y.classList.add("disabled")),n<A.left_border-1e3||n>A.right_border+1e3)"none"!=W.style.display&&(W.style.display="none");else if("inline-block"!=W.style.display&&(W.style.display="inline-block"),0!=n){var t=te(n);if(-5<t&&t<o)W.style.left=t+b+-10+"px",100*(o-t)/o<3&&("poling"!=e.sender&&"click"!=e.sender||A.isRange()||u||P||(console.log("[TIMELINE] Auto move if not user drag"),setTimeout(function(){console.log("[TIMELINE] mCursorPosition: "+n),A.moveToPosition(n)},100)));else"none"!=W.style.display&&(W.style.display="none")}else"none"!=W.style.display&&(W.style.display="none")}function re(){(new Date).getTime();var e=X(A.left_border),t=X(A.right_border)+p;if(t<e)return console.error("[ERROR] start must be more than end"),!1;if(A.isRange()){if(e<mRangeMin_Normalize)return console.error("[ERROR] Going beyond the range (start)"),!1;if(t>mRangeMax_Normalize)return console.error("[ERROR] Going beyond the range (end)"),!1}for(var a=B.getElementsByTagName("crect"),r=0,n=e;n<=t;n+=p){var o=h[n];if(o&&1==o.status)for(var i=0;i<o.data.length;i++)if(!(o.data[i].end<A.left_border||o.data[i].start>A.right_border)){var s=te(o.data[i].start),l=s+"px",c=te(o.data[i].end)-s+"px";if(r<a.length)a[r].style.display="",a[r].style.left=l,a[r].style.width=c,r++;else{var u='<crect style="left: '+l+"; width: "+c+'"></crect>';B.innerHTML+=u,r++}}}for(n=r;n<a.length;n++)"none"!=a[n].style.display&&(a[n].style.display="none")}function ne(t){var e=CloudHelpers.promise(),a=h[t];return a&&1==a.status?e.resolve():null!=f?(h[t]={},h[t].status=0,h[t].data=[],f.getTimeline(t,t+p).done(function(e){h[t]&&(h[t].status=1,h[t].data=e.periods),re()}).fail(function(){h[t]&&(h[t].status=-1),e.reject()})):e.reject(),e}function oe(t){f.getTimeline(t,t+p).done(function(e){(function(e,t){if(0==e.length&&0==t.length)return!1;for(var a=0;a<e.length;a++){for(var r=e[a],n=!1,o=0;o<t.length;o++){var i=t[o];r.start==i.start&&r.end==i.end&&(n=!0)}if(!n)return!0}for(o=0;o<t.length;o++){for(i=t[o],n=!1,a=0;a<e.length;a++)(r=e[a]).start==i.start&&r.end==i.end&&(n=!0);if(!n)return!0}return!1})(h[t].data,e.periods)&&(h[t].data=e.periods,re())})}function ie(){console.log("_reloadRangeData");var e=X(C),t=X(y)+p;if(null!=f)for(var a=e;a<=t;a+=p){var r=h[a];r&&1==r.status&&oe(a)}}function se(){console.log("_stopPolingRangeData"),clearInterval(R)}function le(){console.warn("_disposeTimeline"),d=0,h={},B.innerHTML="",Q(),clearInterval(c),se(),null!=$&&$.dispose()}function ce(){console.warn("_changedSource"),le(),null!=m?(f=m.getSource())?(l=w?CloudHelpers.getOffsetTimezone(w):CloudHelpers.getOffsetTimezone(f.getTimezone()),r=f._getConn(),null!=$&&$.setSource(f),Q(),A._polingCursor=setInterval(function(){null!=m?0!=m.getPosition()&&(n=m.getPosition()):n=0,ae({sender:"poling"})},1e3),clearInterval(c),d=CloudHelpers.getCurrentTimeUTC()-CloudHelpers.ONE_MINUTE,c=setInterval(ee,3e4),se(),null!=M&&A.isRange()&&(R=setInterval(function(){null!=f&&ie()},1e3*M))):(f=r=null,l=0):f=null,A.redrawTimeline({sender:"changed_source"})}function ue(e,t){console.warn("_playerEvent ",e),"SOURCE_CHANGED"==e.name?ce():"POSITION_JUMPED"==e.name&&(console.warn("POSITION_JUMPED",m),n=t.new_pos,ae({sender:"pos jumped"}),A.moveToPosition(t.new_pos))}function de(){b=0,"none"!=q.style.display&&(b+=80),S=0,"none"!=V.style.display&&(S+=80),0==b&&(b=80),0==S&&(S=80),j.style.width="calc(100% - "+(b+S)+"px)",j.style.left=b+"px",B.style.width="calc(100% - "+(b+S)+"px)",B.style.left=b+"px",G.style.width="calc(100% - "+(b+S)+"px)",G.style.left=b+"px"}if(F.onclick=function(){null!=$&&(console.log(m),m.player.classList.remove("showing-settings","showing-zoom"),$.toggleCalendar(F))},K.onclick=function(){var e=m.getPosition();0==e&&(e=CloudHelpers.getCurrentTimeUTC()),0!=e?(m.stop("by_timeline_2"),m.setPosition(e-36e5),A.moveToPosition(e-36e5),m.play()):console.log("Invalid current position")},Z.onclick=function(){if(1!=m.isLive()){var e=m.getPosition();0==e&&(e=CloudHelpers.getCurrentTimeUTC()),0!=e?(m.stop("by_timeline_2"),m.setPosition(e+36e5),A.moveToPosition(e+36e5),m.play()):console.log("Invalid current position ")}},Y.onclick=function(e){if(null!=m&&null!=m.getSource()){var t=Y.classList.value;-1==t.indexOf("now")&&-1==t.indexOf("disabled")&&(m.setPosition(CloudPlayer.POSITION_LIVE),m.play(e),A.moveToPosition(CloudHelpers.getCurrentTimeUTC())),-1!=t.indexOf("now")&&A.moveToPosition(CloudHelpers.getCurrentTimeUTC())}},J(),A.removeCallback=function(e){I.removeCallback(e)},A.addCallback=function(e,t){I.addCallback(e,t)},A.reloadRangeData=function(){ie()},A.hideCalendarButton=function(){"none"!=F.style.display&&(F.style.display="none"),de(),A.redrawTimeline()},A.showCalendarButton=function(){"none"==F.style.display&&(F.style.display=""),de(),A.redrawTimeline()},A.hideArrowsButtons=function(){"none"!=q.style.display&&(q.style.display="none"),"none"!=V.style.display&&(V.style.display="none"),de(),A.redrawTimeline()},A.showArrowsButtons=function(){"none"==q.style.display&&(q.style.display=""),"none"==V.style.display&&(V.style.display=""),de(),A.redrawTimeline()},A.hideShiftButtons=function(){"none"!=K.style.display&&(K.style.display="none"),"none"!=Z.style.display&&(Z.style.display="none"),de(),A.redrawTimeline()},A.showShiftButtons=function(){"none"==K.style.display&&(K.style.display=""),"none"==Z.style.display&&(Z.style.display=""),de(),A.redrawTimeline()},A.hideGotoLiveButton=function(){"none"!=Y.style.display&&(Y.style.display="none"),de(),A.redrawTimeline()},A.showGotoLiveButton=function(){"none"==Y.style.display&&(Y.style.display=""),de(),A.redrawTimeline()},A.setPlayer=function(e){le(),m&&m.removeCallback(s),e?(null!=(m=e)?T&&(($=new CloudCameraCalendarView(m.getCalendarContent(),t)).onChangeDate=function(e,t){null!=m?(m.setPosition(e-l),A.moveToPosition(e-l),m.play(t)):console.error("[TIMELINE] player is null")},A.calendar=$):console.error("[TIMELINE] player is null"),ce(),m.addCallback(s,ue),m.setFullscreenCallback(function(){console.warn("fullscreenCallback"),A.redrawTimeline()})):(m=null,ce())},A.setRange=function(e,t){console.warn("[TIMELINE] setRange todo"),C=e,y=t,mRangeMin_Normalize=X(e),mRangeMax_Normalize=X(t)+p,D.classList.add("range"),J();var a=y-C,r=C,n=y;if(a<=U)A.hideArrowsButtons(),A.hideShiftButtons(),H.len_ms=a,A.left_border=Math.floor(r),A.right_border=Math.floor(n);else{n=C+U,H.len_ms=U;var o=CloudHelpers.getCurrentTimeUTC();o<y&&C<o&&n<o&&(n=o+Math.floor(U/2),y<n&&(n=y),r=n-U),A.left_border=Math.floor(r),A.right_border=Math.floor(n)}A.redrawTimeline({sender:"animation"})},A.isRange=function(){return-1!=C&&-1!=y},A.resetRange=function(){console.warn("[TIMELINE] resetRange"),y=C=-1,D.classList.remove("range"),A.showArrowsButtons(),A.showShiftButtons(),J()},A.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"],A.dateFormat=function(e,t,a){var r="";if(A.isRange()){var n=(e=((e=Math.floor((e-C)/1e3))-e%60)/60)%60;r=("00"+(e-n)/60).slice(-2)+":"+("00"+n).slice(-2)}else{var o=new Date;o.setTime(e+l);var i=o.getUTCHours(),s="";a&&(s=12<=i?" pm":" am",i=0==i?12:12<i?i-12:i);r=("00"+i).slice(-2)+":"+("00"+o.getUTCMinutes()).slice(-2);r+=s,t&&(r+=" ("+o.getUTCDate()+" "+A.months[o.getUTCMonth()]+")")}return r},A._eventRedrawTimeline=function(){setTimeout(A.redrawTimeline,10)},A.redrawTimeline=function(e){if(e=e||{},v)console.warn("redrawTimeline busy");else{v=!0,J();var t=Math.floor(A.left_border/H.step_short),a=Math.floor(A.right_border/H.step_short)+1;A.isRange()&&(A.left_border<=C?q.classList.add("disabled"):q.classList.remove("disabled"),A.right_border>=y?V.classList.add("disabled"):V.classList.remove("disabled")),G.innerHTML='<vtext id="texttimelinetest"><vtext>';var r=document.getElementById("texttimelinetest");if(r){r.innerHTML=A.dateFormat(A.left_border,!1,!0===A.options.timelineampm);var n=r.clientWidth;r.innerHTML=A.dateFormat(A.left_border,!0,!0===A.options.timelineampm);for(var o=r.clientWidth,i=H.step_long;i<n*g;)i+=H.step_long;var s=2*i;G.innerHTML+="<hline></hline>";for(var l=t;l<a;l++){var c=l*H.step_short,u=te(c);if(c%H.step_long==0){var d=c%s==0,m=u-(d?o:n)/2;G.innerHTML+='<vline style="left: '+u+'px"></vline>',c%i==0&&(G.innerHTML+='<vtext style="left: '+m+'px">'+A.dateFormat(c,d,!0===A.options.timelineampm)+"</vtext>")}else G.innerHTML+='<vline style="left: '+u+'px"></vline>'}if(ae(e),null!=f)if(function(e,t){var a=X(e),r=X(t)+p;if(r<a)return console.error("[ERROR] start must be more than end"),!1;for(var n=!0,o=a;o<=r;o+=p)h[o]?1!=h[o].status&&(n=!1):n=!1;return n}(A.left_border,A.right_border))re();else{if(A.isRange()&&(A.left_border<mRangeMin_Normalize||A.right_border>mRangeMax_Normalize))return void(v=!1);!function(e,t){var a=X(e),r=X(t)+p;if(r<a)return console.error("[ERROR] start must be more than end");if(A.isRange()){if(e<mRangeMin_Normalize)return console.error("[ERROR] Going beyond the range (left)");if(r>mRangeMax_Normalize)return console.error("[ERROR] Going beyond the range (right)")}if(null!=f)for(var n=a;n<=r;n+=p){var o=h[n];(!o||o&&-1==o.status)&&ne(n)}}(A.left_border,A.right_border)}v=!1}}},A.redrawTimeline(),A.onTimeLineResize=function(){A.redrawTimeline()},window.addEventListener("resize",A.onTimeLineResize),A.animationTo=function(t,a,r){P=!0,r=r||H;var n=25,e=t-A.left_border,o=a-A.right_border;if(0==e&&0==o)return console.warn("Already in current position"),A.redrawTimeline({sender:"animation"}),void(P=!1);for(var i=r.step_short-H.step_short,s=r.step_long-H.step_long,l=0!=i&&0!=s,c=(A.left_border,A.right_border,[]),u=3.14/n,d=0,m=0;m<n;m++){d+=C=Math.sin(m*u),c.push({k:C})}var f=e/d,p=o/d,h=i/d,v=s/d,g=c[0].k;c[0].left=A.left_border+g*f,c[0].right=A.right_border+g*p,l&&(c[0].step_short=H.step_short+g*h,c[0].step_long=H.step_long+g*v);for(m=1;m<n;m++){var C=c[m].k;c[m].left=c[m-1].left+C*f,c[m].right=c[m-1].right+C*p,l&&(c[m].step_short=c[m-1].step_short+C*h,c[m].step_long=c[m-1].step_short+C*v)}c[n-1].left=t,c[n-1].right=a;var y=0;setTimeout(function e(){A.left_border=Math.floor(c[y].left),A.right_border=Math.floor(c[y].right),l&&(H.step_short=Math.floor(c[y].step_short),H.step_long=Math.floor(c[y].step_long)),A.redrawTimeline({sender:"animation"}),++y<n?setTimeout(e,10):(l&&(H=L(r)),A.left_border=t,A.right_border=a,A.redrawTimeline({sender:"animation"}),P=!1)},15)},A.fixBorderLimit=function(e,t){var a={};if(a.left=e,a.right=t,A.isRange())a.right>y&&(a.right=y,a.left=a.right-H.len_ms),a.left<C&&(a.left=C,a.right=a.left+H.len_ms);else{var r=CloudHelpers.getCurrentTimeUTC()+H.len_ms/2;if(a.right>r){var n=a.right-r;a.left=a.left-n,a.right=a.right-n}}return a},A.moveToRight=function(){var e=A.right_border-A.left_border;e=Math.floor(.75*e);var t=A.left_border+e,a=A.right_border+e,r=A.fixBorderLimit(t,a);A.animationTo(r.left,r.right)},V.onclick=A.moveToRight,A.moveToLeft=function(){var e=A.right_border-A.left_border;e=Math.floor(.75*e);var t=A.left_border-e,a=A.right_border-e,r=A.fixBorderLimit(t,a);A.animationTo(r.left,r.right)},q.onclick=A.moveToLeft,A.moveToPosition=function(e){console.log("moveToPosition");var t=Math.floor((A.right_border-A.left_border)/2),a=e-t,r=e+t;A.isRange()&&(a<C||y<r)?console.error("Can not move beyond range"):A.animationTo(a,r)},A.mousedown=function(e){if(!u){_=e.offsetX,E=e.offsetX,u=!0,j.style.cursor="move";try{window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(e){console.error(e)}}},A.mousemove=function(e){if(u&&!A.isRange()){var t=e.offsetX-E;if(void 0!==e.movementX&&(t=e.movementX),0!=t){var a=Math.floor(t*g);E+=t;var r=A.fixBorderLimit(A.left_border-a,A.right_border-a);A.left_border=r.left,A.right_border=r.right,A.redrawTimeline({sender:"mousemove"})}}},A.mouseup=function(e){u&&(j.style.cursor="default",u=!1)},A.mouseout=function(e){if(u){if(e.relatedTarget&&"CRECT"==e.relatedTarget.nodeName||e.target&&"CRECT"==e.target.nodeName)return;if(e.relatedTarget&&"cloudcameratimeline-cursor"==e.relatedTarget.className||e.target&&"cloudcameratimeline-cursor"==e.target.className)return;j.style.cursor="default",u=!1}},j.addEventListener("mousedown",A.mousedown),j.addEventListener("mousemove",A.mousemove),j.addEventListener("mouseup",A.mouseup),j.addEventListener("mouseout",A.mouseout),B.onclick=function(e){if(null!=m)if(null!=f){if(_==E){var t=e.currentTarget.getBoundingClientRect(),a=e.clientX-t.left,r=Math.floor(a*g);(r+=A.left_border)>=CloudHelpers.getCurrentTimeUTC()&&m?(n=CloudHelpers.getCurrentTimeUTC(),ae({sender:"click"}),m.stop("by_timeline_1"),m.setPosition(CloudPlayer.POSITION_LIVE),m.play(),I.executeCallbacks(CloudPlayerEvent.USER_CLICKED_ON_TIMELINE,{pos:CloudPlayer.POSITION_LIVE})):r&&m?(n=r,ae({sender:"click"}),m.stop("by_timeline_2"),m.setPosition(r),m.play(),I.executeCallbacks(CloudPlayerEvent.USER_CLICKED_ON_TIMELINE,{pos:r})):ae({sender:"click"})}}else console.log("[CloudCameraTimeline] source is null");else console.log("[CloudCameraTimeline] player is null")},A.setMode=function(e){var t=null;if(!x[e.name])return console.error("Unknown timeline mode"),-1;t=x[e.name];var a=(A.right_border-A.left_border)/2+A.left_border,r=L(t),n=t.len_ms/2;return A.animationTo(a-n,a+n,r),0},A.getMode=function(){return H},A.destroy=function(){if(window.removeEventListener("resize",A.onTimeLineResize),A.elem&&"DIV"===A.elem.tagName)for(;A.elem.firstChild;)A.elem.firstChild.remove();clearInterval(c)},void 0!==t.arrows&&(1==t.arrows?A.showArrowsButtons():A.hideArrowsButtons()),void 0!==t.gotoLive&&(1==t.gotoLive?A.showGotoLiveButton():A.hideGotoLiveButton()),void 0!==t.range){var me=t.range.min,fe=t.range.max;A.setRange(me,fe)}T?A.showCalendarButton():A.hideCalendarButton(),console.log("options: ",t)},window.CloudCameraCalendarView=function(e,t){var r=e;t=t||{};var o=this,a=null,y={},n=null,i=null,s=(new Date).getMonth(),l=(new Date).getFullYear(),c=100*l+s,u=100*l+s;function d(e,t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t%12]+" "+e}function A(e,t,a){return e+"-"+("00"+(t+1)).slice(-2)+"-"+("00"+a).slice(-2)}function m(e,t){var a=new Date;a.setFullYear(e),a.setMonth(t),a.setDate(1);var r=a.getDay(),n=(t-1+12)%12,o=0==t?e-1:e,i=(t+1+12)%12,s=11==t?e+1:e,l=new Date(s,i,0),c=l.getDate(),u=l.getDay(),d=new Date(o,n+1,0).getDate(),m=["Su","Mo","Tu","We","Th","Fr","Sa"],f=[];d=d-r+1;for(var p=0;p<r;p++)f.push({d:d,cl:"disabled",dt:A(s,i,d)}),d++;for(p=1;p<=c;p++)f.push({d:p,cl:"",dt:A(e,t,p)});var h=0;for(p=u+1;p<7;p++)h++,f.push({d:h,cl:"disabled",dt:A(s,i,h)});for(p=0;p<y.length;p++)for(var v=y[p],g=0;g<f.length;g++)f[g].dt===v&&(f[g].cl+="active-day");var C='<div class="cal-row week">';for(p=0;p<m.length;p++)C+='<div class="cal-day name">'+m[p]+"</div>";C+="</div>",C+='<div class="cal-row">';for(p=0;p<f.length;p++)p%7==0&&0<p&&(C+='</div><div class="cal-row">'),C+='<div class="cal-day '+f[p].cl+'" dt="'+f[p].dt+'">'+f[p].d+"</div>";return C+="</div>"}r.innerHTML='\t<div class="cloudcameracalendar-header">\t\t<div class="cloudcameracalendar-prev-month"></div>\t\t<div class="cloudcameracalendar-title">'+d(l,s)+"</div>\t\t<div class=\"cloudcameracalendar-next-month\"></div>\t</div>\t<div class='cloudcameracalendar-table'>"+m(l,s)+"\t</div>";r.getElementsByClassName("cloudcameracalendar-close")[0];var f=r.getElementsByClassName("cloudcameracalendar-prev-month")[0],p=r.getElementsByClassName("cloudcameracalendar-next-month")[0],h=r.getElementsByClassName("cloudcameracalendar-table")[0],v=r.getElementsByClassName("cloudcameracalendar-title")[0];o.renderContent=function(){v.innerHTML=d(l,s),h.innerHTML=m(l,s);for(var e=r.getElementsByClassName("active-day"),t=0;t<e.length;t++)e[t].onclick=function(e){var t=this.getAttribute("dt");o.onChangeDate&&o.onChangeDate(Date.parse(t),e)};var a=100*l+s;f.style.display=a<=c?"none":"",p.style.display=u<=a?"none":""},o.renderContent(),o.updateActivity=function(){if(null==a)return console.log("[CALENDAR] mConn is null"),y=[],void o.renderContent();mApi=a._getAPI(),mApi&&mApi.storageActivity(n,!0).done(function(e){i=new Date,y=e.objects;for(var t=0;t<y.length;t++){var a=y[t].split("-"),r=parseInt(a[1],10)-1,n=100*parseInt(a[0],10)+r;u=0==t?c=n:(c=Math.min(n,c),Math.max(n,u))}o.renderContent()})},o.setSource=function(e){s=(new Date).getMonth(),l=(new Date).getFullYear(),(i=null)!=e?(a=e._getConn(),n=e.getID(),CloudHelpers.getOffsetTimezone(e.getTimezone()),o.updateActivity()):(a=null,0,y=[],o.renderContent())},o.dispose=function(){a=null},f.onclick=function(){(s-=1)<0&&(s=11,l-=1),o.renderContent()},p.onclick=function(){11<(s+=1)&&(s=0,l+=1),o.renderContent()},o.isVisible=function(){return""!==r.style.display},o.showCalendar=function(){if(console.log("[CALENDAR] show"),r.style.display="block",null!=a)if(null!=i){var e=new Date;e.setUTCHours(24),e.setUTCMinutes(0),e.setUTCSeconds(0),(new Date).getTime()>e.getTime()&&i.getTime()<e.getTime()&&o.updateActivity()}else o.updateActivity();else o.renderContent()},o.hideCalendar=function(){console.log("[CALENDAR] hide"),r.style.display=""},o.toggleCalendar=function(e){console.log("[CALENDAR] toggle"),o.isVisible()?(o.hideCalendar(),e.classList.remove("shadowed")):(o.showCalendar(),e.classList.add("shadowed"))}},window.CloudSessionTimeline=function(e){var C=this,m=null,t={};function y(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}t.h12={to:"min",len_ms:324e5,step_short:18e5,step_long:9e6},t.hr={to:"h12",len_ms:54e5,step_short:3e5,step_long:18e5},t.min={to:"hr",len_ms:9e5,step_short:6e4,step_long:3e5};var A=y(t.min);if(C.elem=document.getElementById(e),null==C.elem)return console.error("[CloudPlayerTimeline] Not found element"),null;if("DIV"!=C.elem.tagName)return console.error("[CloudPlayerTimeline] Expected DIV tag but got "+C.elem.tagName),null;C.elem.classList.add("cloudplayertimeline"),C.elem.classList.add("green"),C.elem.classList.add("black"),C.elem.innerHTML='<div class="cloudplayertimeline-content">\t\t<div class="cloudplayertimeline-scale session"></div>\t\t<div class="cloudplayertimeline-data session"></div>\t\t<div class="cloudplayertimeline-cursor"></div></div>',C.left_border=CloudHelpers.getCurrentTimeUTC()-A.len_ms/2,C.right_border=C.left_border+A.len_ms,C.el_data=C.elem.getElementsByClassName("cloudplayertimeline-data")[0];var f=C.elem.getElementsByClassName("cloudplayertimeline-cursor")[0];function a(){clearInterval(C._polingCursor)}C.el_scale=C.elem.getElementsByClassName("cloudplayertimeline-scale")[0],C.setPlayer=function(e){a(),C.plr=e,C.plr&&(a(),C._polingCursor=setInterval(function(){var e=C.plr.getPosition();if((e<C.left_border||e>C.right_border)&&"none"!=f.style.display&&(f.style.display="none"),"inline-block"!=f.style.display&&(f.style.display="inline-block"),0!=e){var t=C.calcPosition(e)+50+"px";f.style.left=t}},1e3))},C.calcPosition=function(e){return Math.floor((e-C.left_border)*C.distPx)},C.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec"],C.dateFormat=function(e,t){var a=new Date;a.setTime(e);var r=("00"+a.getUTCHours()).slice(-2)+":"+("00"+a.getUTCMinutes()).slice(-2);return t&&(r+=" ("+a.getUTCDate()+" "+C.months[a.getUTCMonth()]+")"),r},C.redrawTimeline=function(){null!=(m=null!=C.plr?C.plr.getSource():null)&&(C.left_border=m.getStartTime(),C.right_border=m.getEndTime(),A.step_short=(C.right_border-C.left_border)/20),f.style.display="none",C.containerWidth=C.el_scale.offsetWidth,C.distPx=C.containerWidth/(C.right_border-C.left_border),C.distSec=(C.right_border-C.left_border)/C.containerWidth;var e=Math.floor(C.left_border/A.step_short),t=Math.floor(C.right_border/A.step_short)+1;C.el_data.innerHTML="",C.el_scale.innerHTML='<vtext id="texttimelinetest"><vtext>';var a=document.getElementById("texttimelinetest");a.innerHTML=C.dateFormat(C.left_border,!1);var r=a.clientWidth;a.innerHTML=C.dateFormat(C.left_border,!0);for(var n=a.clientWidth,o=A.step_long;r*C.distSec>o;)o+=A.step_long;var i=2*o;C.el_scale.innerHTML+="<hline></hline>";for(var s=e;s<t;s++){var l=s*A.step_short,c=C.calcPosition(l);if(l%A.step_long==0){var u=l%i==0,d=c-(u?n:r)/2;C.el_scale.innerHTML+='<vline style="left: '+c+'px"></vline>',l%o==0&&(C.el_scale.innerHTML+='<vtext style="left: '+d+'px">'+C.dateFormat(l,u)+"</vtext>")}else C.el_scale.innerHTML+='<vline style="left: '+c+'px"></vline>'}C.el_data.innerHTML="",null!=m&&m.getTimeline(C.left_border,C.right_border).done(function(e){var t=e.periods;C.el_data.innerHTML="";for(var a=0;a<t.length;a++){var r=C.calcPosition(t[a].start),n='<crect style="left: '+r+"px; width: "+(C.calcPosition(t[a].end)-r)+'px"></crect>';C.el_data.innerHTML+=n}}).fail(function(e){console.error(e)})},C.redrawTimeline(),window.addEventListener("resize",C.redrawTimeline),C.animationTo=function(e,t,a){a=a||A;for(var r=25,n=e-C.left_border,o=t-C.right_border,i=a.step_short-A.step_short,s=a.step_long-A.step_long,l=0!=i&&0!=s,c=[],u=[],d=[],m=[],f=3.14/r,p=0,h=0;h<r;h++){p+=v=Math.sin(h*f)}for(h=0;h<r;h++){var v=Math.sin(h*(3.14/r));c.push(v*(n/p)),u.push(v*(o/p)),l&&(d.push(v*(i/p)),m.push(v*(s/p)))}var g=0;setTimeout(function e(){C.left_border+=c[g],C.right_border+=u[g],l&&(A.step_short+=d[g],A.step_long+=m[g]),C.redrawTimeline(),++g<r?setTimeout(e,10):(l&&(A=y(a)),C.redrawTimeline())},15)},C.fixBorderLimit=function(e,t){var a={};a.left=e,a.right=t;var r=CloudHelpers.getCurrentTimeUTC()+A.len_ms/2;if(a.right>r){var n=a.right-r;a.left=a.left-n,a.right=a.right-n}return a},C._clickOnData=function(e){if(null!=C.plr)if(null!=m){var t=Math.floor(e.offsetX*C.distSec);(t+=C.left_border)&&C.plr&&(C.plr.stop("by_session_timeline_1"),C.plr.setPosition(t),C.plr.play())}else console.log("[CloudCameraTimeline] source is null");else console.log("[CloudCameraTimeline] player is null")},C.el_data.onclick=C._clickOnData,C._startMove=!1,C._lastMoveX=0,C.mousedown=function(e){C._lastMoveX=e.offsetX,C._startMove=!0,C.el_data.style.cursor="move"},C.mousemove=function(e){if(C._startMove){var t=e.offsetX-C._lastMoveX;if(0!=t){var a=Math.floor(t*C.distSec);C._lastMoveX=e.offsetX;var r=C.fixBorderLimit(C.left_border-a,C.right_border-a);C.left_border=r.left,C.right_border=r.right,C.redrawTimeline()}}},C.mouseup=function(e){C._startMove=!1,C.el_data.style.cursor="default"},C.el_data.addEventListener("mousedown",C.mousedown),C.el_data.addEventListener("mousemove",C.mousemove),C.el_data.addEventListener("mouseup",C.mouseup),C.el_data.addEventListener("mouseout",C.mouseup)},window.CloudSDK=window.CloudSDK||{},CloudSDK.version="3.1.6",CloudSDK.datebuild="210210",console.log("CloudSDK.version="+CloudSDK.version+"_"+CloudSDK.datebuild),window.CloudPlayerSDK=function(e,t){console.log(t);var o=this;o.options=t||{},o.player=null,o.conn=null,o.filter=null,o.cm=null,o.mCameraID=null;var i=CloudPlayer.POSITION_LIVE;if(o.camera=null,o.svcp_url=null,o.sharedKey=null,o.playerElementID=null,o.tokenExpire=null,window._CloudPlayerSDK=window._CloudPlayerSDK||{},!e||""===e)throw"Player container element ID is required.";if(o.playerElementID=e,-1===o.playerElementID.indexOf("%")&&(o.playerElementID=encodeURIComponent(o.playerElementID)),o.conn=new CloudShareConnection(o.options),window._CloudPlayerSDK[e])throw"Oops! CloudPlayerSDK instance with player element ID: "+e+" already exist. Try use another ID.";window._CloudPlayerSDK[e]={},o.player=new CloudPlayer(e,o.options),console.log("self.options: ",o.options),null!=o.options.timeline&&0!=o.options.timeline&&(o.timeline=new CloudCameraTimelineView(o.options.timeline,o.options,o.player),o.timeline.setPlayer(o.player),o.player.player.classList.add("with-timeline"),o.player.calendar=o.timeline.calendar,console.log(o.player)),o.setSource=function(t){if(!t||""===t)return o.player._showerror(CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED),CloudReturnCode.ERROR_ACCESS_TOKEN_REQUIRED;var e=!1,a=!1;try{var r=atob(t);if(r=JSON.parse(r),console.log("[CloudPlayerSDK] access_token: ",r),o.tokenExpire=null,r.expires)if(o.tokenExpire=r.expires,CloudHelpers.parseUTCTime(o.tokenExpire)-(new Date).getTime()<0)return o.player._showerror(CloudReturnCode.ERROR_ACCESS_TOKEN_EXPIRED),CloudReturnCode.ERROR_ACCESS_TOKEN_EXPIRED;if(r.token&&r.camid&&r.access&&""!==r.token&&""!==r.camid&&""!==r.access&&(o.sharedKey=r.token,o.mCameraID==r.camid&&(a=!0),o.mCameraID=r.camid),r.svcp&&""!=r.svcp&&(o.svcp_url==r.svcp&&(e=!0),o.svcp_url=r.svcp),r.api&&""!=r.api){var n="";n=("file:"==location.protocol?"http:":location.protocol)+"//"+r.api,"http:"==location.protocol||"file:"==location.protocol?n+=r.api_p?":"+r.api_p:"":"https:"==location.protocol&&(n+=r.api_sp?":"+r.api_sp:""),n+="/",r.path&&""!=r.path&&(n+=r.path,n+="/"),o.svcp_url==n&&(e=!0),o.svcp_url=n}}catch(e){o.player._showerror(CloudReturnCode.ERROR_INVALID_ACCESS_TOKEN_FORMAT)}a&&e?(console.log("DEBUG: Same camid and svcp for newly token"),o.conn.updateToken(o.sharedKey),o.player.setAccessToken(t),o.player.setAccessTokenExpire(o.tokenExpire)):(o.player.stop("by_plrsdk_3"),null!=o.svcp_url&&(o.conn.ServiceProviderUrl=o.svcp_url.replace("file://","https://")),o.conn.open(o.sharedKey).done(function(e){o.conn&&(o.cm=new CloudCameraList(o.conn),o.cm.getCamera(o.mCameraID).done(function(e){o.camera=e,o.player.setSource(o.camera),o.player.setAccessToken(t),o.player.setAccessTokenExpire(o.tokenExpire),console.log(o.camera),console.log(o.camera._origJson()),o.player.setPosition(i),o.timeline&&-1!=i&&o.timeline.moveToPosition(i),o.player.play()}).fail(function(e){console.log(e),o.player._showerror(CloudReturnCode.ERROR_CHANNEL_NOT_FOUND)}))}).fail(function(e){o.player._showerror(CloudReturnCode.ERROR_NETWORK_ERROR)}))},o.getSource=function(){return o.sharedKey?o.sharedKey:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.play=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.play()},o.stop=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.stop("by_plrsdk_1")},o.pause=function(){if(!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.close=function(){o.player.stop("by_plrsdk_2"),o.player.close(),o.player.player.innerHTML="",o.conn.close(),window._CloudPlayerSDK[e]&&delete window._CloudPlayerSDK[e]},o.destroy=function(){o.player.stop("by_plrsdk_2"),o.player.player.innerHTML="",o.player.destroy(),o.conn.close(),o.timeline&&o.timeline.destroy(),window._CloudPlayerSDK[o.playerElementID]&&delete window._CloudPlayerSDK[o.playerElementID]},o.isPlaying=function(){return o.camera?o.player.isPlaying():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.setPosition=function(e){if(i=e,!o.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;o.player.stop("by_plrsdk_2"),o.player.setPosition(e),o.timeline&&o.timeline.moveToPosition(parseInt(e)),o.player.play()},o.getPosition=function(){return o.camera?o.player.getPosition():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.showTimeline=function(e){return o.camera?o.timeline?(document.getElementById(o.options.timeline).style.display=e?"block":"hide",!0):(console.error(CloudReturnCode.ERROR_NOT_CONFIGURED.text),null):(console.error(CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED.text),null)},o.getChannelName=function(){return o.camera?o.camera.getName():CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},o.setRange=function(e,t){o.player.setRange(e,t),o.timeline&&o.timeline.setRange(e,t)},o.resetRange=function(){o.player.resetRange(),o.timeline&&o.timeline.resetRange()},o.showZoomControl=function(e){o.player&&o.player._showZoomControl(e)},o.mOnError_callback=null,o.onError=function(e){e?(o.mOnError_callback=e,o.player.onError(function(e,t){o.mOnError_callback(o,t)})):o.player.onError(null)},o.mOnChannelStatus_callback=null,o.onChannelStatus=function(e){if(!e)return o.mOnChannelStatus_callback=null,void o.player.onChannelStatus(null);o.mOnChannelStatus_callback=e,o.player.onChannelStatus(function(e,t){o.mOnChannelStatus_callback(o,t)})},o.addCallback=function(e,t){o.player.addCallback(e,t),o.timeline&&o.timeline.addCallback(e,t)},o.removeCallback=function(e){o.player.removeCallback(e),o.timeline&&o.timeline.removeCallback(e,func)}},window.StreamerSWF=window.StreamerSWF||{},StreamerSWF.elemId="streamer_swf",StreamerSWF.obj=void 0,StreamerSWF.log=function(e){console.log("[StreamerSWF] "+e)},StreamerSWF.warn=function(e){console.warn("[StreamerSWF] "+e)},StreamerSWF.error=function(e){console.error("[StreamerSWF] "+e)},StreamerSWF.startedPublish=function(){},StreamerSWF.stoppedPublish=function(){},StreamerSWF.showSecuritySettings=function(){},StreamerSWF.hideSecuritySettings=function(){},StreamerSWF.activityLevel=function(e){console.log("audio lvl "+e)},StreamerSWF.flash=function(){return StreamerSWF.obj?StreamerSWF.obj.vjs_activate||(StreamerSWF.obj=document.getElementById(StreamerSWF.elemId),StreamerSWF.obj||StreamerSWF.error("Element '"+StreamerSWF.elemId+"' not found"),StreamerSWF.log("reinit")):(StreamerSWF.obj=document.getElementById(StreamerSWF.elemId),StreamerSWF.obj||StreamerSWF.error("Element '"+StreamerSWF.elemId+"' not found"),StreamerSWF.log("Init")),StreamerSWF.obj},StreamerSWF.activate=function(e,t){var a=StreamerSWF.flash();if(a)if(a.vjs_activate){var r=StreamerSWF.private.is()||!1;a.vjs_activate(e,r,t)}else StreamerSWF.error("Function vjs_activate not found"),StreamerSWF.obj=void 0},StreamerSWF.support=function(){var e=StreamerSWF.flash();if(e)return e.vjs_support?e.vjs_support():(StreamerSWF.error("Function vjs_support not found"),void(StreamerSWF.obj=void 0))},StreamerSWF.status=function(){var e=StreamerSWF.flash();if(e)return e.vjs_status?e.vjs_status():(StreamerSWF.error("Function vjs_status not found"),void(StreamerSWF.obj=void 0))},StreamerSWF.deactivate=function(){var e=StreamerSWF.flash();e&&(e.vjs_deactivate?e.vjs_deactivate():(console.error("Function vjs_deactivate not found"),StreamerSWF.obj=void 0))},StreamerSWF.isActivated=function(){return"activated"==StreamerSWF.status()},StreamerSWF.isDeactivated=function(){return"deactivated"==StreamerSWF.status()},StreamerSWF.isTransitive=function(){return"transitive"==StreamerSWF.status()},StreamerSWF.private={},StreamerSWF.private.retry=function(e,t){var a=0,r=!1,n=window.setInterval(function(){e()&&(window.clearInterval(n),t(r)),50<a++&&(window.clearInterval(n),t(r=!0))},10)},StreamerSWF.private.isIE10OrLater=function(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var a=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);if(a&&10<=parseInt(a[1],10))return!0;var r=/edge/.exec(t);return!(!r||"edge"!=r[0])},StreamerSWF.private.detectPrivateMode=function(t){var a;if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){a=!1},function(e){console.log(e),a=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var r;try{r=window.indexedDB.open("test")}catch(e){a=!0}void 0===a&&StreamerSWF.private.retry(function(){return"done"===r.readyState},function(e){e||(a=!r.result)})}else if(StreamerSWF.private.isIE10OrLater(window.navigator.userAgent)){a=!1;try{window.indexedDB||(a=!0)}catch(e){a=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){a=!0}void 0===a&&(a=!1,window.localStorage.removeItem("test"))}StreamerSWF.private.retry(function(){return void 0!==a},function(e){t(a)})},StreamerSWF.private.is=function(){return void 0===StreamerSWF.private.is_&&console.error("[StreamerSWF.private] cannot detect"),StreamerSWF.private.is_},StreamerSWF.private.detectPrivateMode(function(e){void 0===(StreamerSWF.private.is_=e)?console.error("[StreamerSWF.private] cannot detect"):(StreamerSWF.private.is_=e,console.log(e?"[StreamerSWF.private] private":"[StreamerSWF.private] not private"))});var ptzconfig={xRot:-48.6,zRot:145,xScale:1,yScale:1,xShift:0,yShift:0,zCamShift:.2,zZoom:-.6,xLens:1,zLens:1,divider:4,src:document.currentScript.src.replace(/(\/[^\/]+)$/,"/")};function changepztconfig(e,t){ptzconfig[t]=e}function testplay(){$("#player1_vjs_html5_api").attr("src","/video.mp4"),player1_vjs_html5_api.play()}function testplay2(){$("#player1_vjs_html5_api").attr("src","/fisheye.mp4"),player1_vjs_html5_api.play()}window.CloudPano=function(n,e){var u=this;u.container=n,u.player=e,u.beMouseDown=!1,u.bezRot=u.bexRot=0,u.beX=u.beY=0,u.model={vertex:[],indices:[],texture:[]},u.load_model=function(){if(!u.textureBuffer){var t;try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{t=new XMLHttpRequest}catch(e){t=!1}}}t.onreadystatechange=function(){if(!u.textureBuffer&&4==t.readyState&&200==t.status){for(u.model=JSON.parse(t.response),u.model.indices=[],c=0,i=0;i<u.model.vertex.length;i+=3)u.model.indices.push(c++);u.vertexBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.vertexBuffer),u.gl.bufferData(u.gl.ARRAY_BUFFER,new Float32Array(u.model.vertex),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,null),u.indexBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,u.indexBuffer),u.gl.bufferData(u.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(u.model.indices),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,null),u.textureBuffer=u.gl.createBuffer(),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.textureBuffer),u.gl.bufferData(u.gl.ARRAY_BUFFER,new Float32Array(u.model.texture),u.gl.STATIC_DRAW),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,null),console.log("[CloudPlayer] vehicles count is "+u.model.vertex.length/3)}},t.open("GET",ptzconfig.src+"model.json",!0),t.send(null)}},u.mouseMoveHandler=function(e){var t=e.clientX,a=e.clientY;u.beMouseDown||1!=e.buttons||(u.bezRot=ptzconfig.zRot,u.bexRot=ptzconfig.xRot,u.beMouseDown=!0,u.beX=t,u.beY=a),0==e.buttons&&(u.beMouseDown=!1),u.beMouseDown&&(ptzconfig.zRot=u.bezRot+(u.beX-t)/5,ptzconfig.xRot=u.bexRot+(u.beY-a)/5,0<ptzconfig.xRot&&(ptzconfig.xRot=0),ptzconfig.xRot<-65.2&&(ptzconfig.xRot=-65.2))},u.mouseWheelHandler=function(e){var t=(e=e||window.event).deltaY||e.detail||e.wheelDelta;ptzconfig.zZoom-=t/1e3,.6<ptzconfig.zZoom&&(ptzconfig.zZoom=.6),ptzconfig.zZoom<-.6&&(ptzconfig.zZoom=-.6),e.preventDefault()},u.createGLContext=function(){var e=document.createElement("div");e.style.top="90px",e.style.position="absolute",e.style.color="black",e.style.fontSize="12px",e.innerHTML='            <span style="background:rgba(255,255,255,.7);padding:0 5px">Смещение камеры по вертикали</span><br/>               <input style="width:250px" id="zCamShift" type="range" min="-1" max="2" step=".01" value="'+ptzconfig.zCamShift+'" onchange="changepztconfig(this.value,\'zCamShift\')"><br/>            <span for="zZoom" style="background:rgba(255,255,255,.7);padding:0 5px">Приближение</span><br/>                    <input style="width:250px" id="zZoom" type="range" min="-5" max="2" step=".1" value="'+ptzconfig.zZoom+'" onchange="changepztconfig(this.value,\'zZoom\')"><br/>            <span for="xRot" style="background:rgba(255,255,255,.7);padding:0 5px">Наклон камеры вниз</span><br/>              <input style="width:250px" id="xRot" type="range" min="-120" max="0" step="5" value="'+ptzconfig.xRot+'" onchange="changepztconfig(this.value,\'xRot\')"><br/>            <span for="xScale" style="background:rgba(255,255,255,.7);padding:0 5px">Масштабирование текстуры по X</span><br/> <input style="width:250px" id="xScale" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.xScale+'" onchange="changepztconfig(this.value,\'xScale\')"><br/>            <span for="yScale" style="background:rgba(255,255,255,.7);padding:0 5px">Масштабирование текстуры по Y</span><br/> <input style="width:250px" id="yScale" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.yScale+'" onchange="changepztconfig(this.value,\'yScale\')"><br/>            <span for="xShift" style="background:rgba(255,255,255,.7);padding:0 5px">Смещение текстуры по X</span><br/>        <input style="width:250px" id="xShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.xShift+'" onchange="changepztconfig(this.value,\'xShift\')"><br/>            <span for="yShift" style="background:rgba(255,255,255,.7);padding:0 5px">Смещение текстуры по Y</span><br/>        <input style="width:250px" id="yShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.yShift+'" onchange="changepztconfig(this.value,\'yShift\')"><br/>            <span for="zLens" style="background:rgba(255,255,255,.7);padding:0 5px">Коррекция выпуклости линзы</span><br/>     <input style="width:250px" id="yShift" type="range" min="-2.5" max="2.5" step=".01" value="'+ptzconfig.zLens+'" onchange="changepztconfig(this.value,\'zLens\')"><br/>            <span for="xLens" style="background:rgba(255,255,255,.7);padding:0 5px">Коррекция масштаба линзы по X</span><br/>     <input style="width:250px" id="xLens" type="range" min=".5" max="2" step=".01" value="'+ptzconfig.xLens+'" onchange="changepztconfig(this.value,\'xLens\')"><br/>            <button onclick="testplay()">Проиграть тестовый пример</button>&nbsp;<button onclick="testplay2()">Проиграть второй пример</button>        ',u.canvas=document.createElement("canvas"),u.canvas.style.width="100%",u.canvas.style.height="100%",u.canvas.style.display="none",n.parentElement.insertBefore(canvas,n),u.canvas.setAttribute("width",n.parentElement.offsetWidth),u.canvas.setAttribute("height",n.parentElement.offsetHeight),u.canvas.addEventListener("mousemove",u.mouseMoveHandler),u.canvas.addEventListener("wheel",u.mouseWheelHandler);for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=0;a<t.length;++a){var r;try{r=u.canvas.getContext(t[a])}catch(e){continue}if(r)return r}throw new Error("WebGL is not supported!")},u.compileShader=function(t,e,a){var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e),t.compileShader(r),i(r);var n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,a),t.compileShader(n),i(n);var o=t.createProgram();return t.attachShader(o,r),t.attachShader(o,n),t.linkProgram(o),o;function i(e){if(!t.getShaderParameter(e,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(e))}},u.run=function(r){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(!n)throw new Error("do not support 'requestAnimationFram'");n(function e(t){o||(o=t);var a=t-o;o=t;r(a);n(e)});var o=null},u.ptz_enabled=!1,u.start=function(){u.load_model(),u.ptz_enabled=!0,u.canvas.style.display="block",u.container.style.visibility="hidden",u.container.style.position="fixed",u.container.style.top="0",u.container.style.height="1px",u.container.style.width="1px",u.container.style.zIndex="-1"},u.stop=function(){u.ptz_enabled=!1,u.canvas.style.display="none",u.container.style.visibility="",u.container.style.position="",u.container.style.top="",u.container.style.height="100%",u.container.style.width="100%",u.container.style.zIndex=""},u.model,u.gl=createGLContext();var t=u.compileShader(u.gl,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform float fCamShift;\n        uniform float zLens;\n        varying vec2 vTextureCoord;\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition.x, aVertexPosition.y, aVertexPosition.z*zLens+fCamShift, 1.0);\n            vTextureCoord = aTextureCoord;\n        }","        precision mediump float;\n        varying vec2 vTextureCoord;\n        uniform sampler2D uSampler;\n        uniform vec4 uScale;\n        void main(void) {\n            gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x / uScale.x + uScale.z, vTextureCoord.y / uScale.y + uScale.w));\n        }");function d(e){return e*Math.PI/180}return u.gl.useProgram(t),u.aVertexPosition=u.gl.getAttribLocation(t,"aVertexPosition"),u.aTextureCoord=u.gl.getAttribLocation(t,"aTextureCoord"),u.uSampler=u.gl.getUniformLocation(t,"uSampler"),u.uScale=u.gl.getUniformLocation(t,"uScale"),u.pMatrixUniform=u.gl.getUniformLocation(t,"uPMatrix"),u.mvMatrixUniform=u.gl.getUniformLocation(t,"uMVMatrix"),u.fCamShift=u.gl.getUniformLocation(t,"fCamShift"),u.zLens=u.gl.getUniformLocation(t,"zLens"),u.texture=function(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);var a=e.RGBA,r=e.RGBA,n=e.UNSIGNED_BYTE,o=new Uint8Array([0,0,0,255]);return e.texImage2D(e.TEXTURE_2D,0,a,1,1,0,r,n,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameterf(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameterf(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t}(gl),u.mvMatrix=glMatrix.mat4.create(),u.pMatrix=glMatrix.mat4.create(),u.run(function(e){if(u.ptz_enabled&&u.textureBuffer&&u.indexBuffer){for(var t,a,r,n,o,i,s,l=u.container.querySelectorAll("video"),c=0;c<l.length;++c)if("none"!=getComputedStyle(l[c],null).display&&"none"!=getComputedStyle(l[c].parentElement,null).display){t=l[c];break}a=u.gl,r=u.texture,n=t,o=a.RGBA,i=a.RGBA,s=a.UNSIGNED_BYTE,a.bindTexture(a.TEXTURE_2D,r),a.texImage2D(a.TEXTURE_2D,0,o,i,s,n),u.gl.clearColor(0,0,0,1),u.gl.enable(gl.DEPTH_TEST),u.gl.clear(u.gl.COLOR_BUFFER_BIT|u.gl.DEPTH_BUFFER_BIT),player.isPlaying()&&(u.gl.viewport(0,0,u.canvas.width,u.canvas.height),glMatrix.mat4.perspective(u.pMatrix,45,u.canvas.width/u.canvas.height,.1,100),glMatrix.mat4.identity(u.mvMatrix),glMatrix.mat4.translate(u.mvMatrix,u.mvMatrix,[0,0,ptzconfig.zZoom]),glMatrix.mat4.rotate(u.mvMatrix,u.mvMatrix,d(ptzconfig.xRot),[1,0,0]),glMatrix.mat4.rotate(u.mvMatrix,u.mvMatrix,d(ptzconfig.zRot),[0,0,1]),u.gl.enableVertexAttribArray(u.aVertexPosition),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.vertexBuffer),u.gl.vertexAttribPointer(aVertexPosition,3,u.gl.FLOAT,!1,0,0),u.gl.enableVertexAttribArray(u.aTextureCoord),u.gl.bindBuffer(u.gl.ARRAY_BUFFER,u.textureBuffer),u.gl.vertexAttribPointer(u.aTextureCoord,2,u.gl.FLOAT,!1,0,0),u.gl.activeTexture(u.gl.TEXTURE0),u.gl.bindTexture(u.gl.TEXTURE_2D,u.texture),u.gl.pixelStorei(u.gl.UNPACK_FLIP_Y_WEBGL,!0),u.gl.uniform1i(u.uSampler,0),u.gl.uniform4f(u.uScale,ptzconfig.xScale,ptzconfig.yScale,ptzconfig.xShift,ptzconfig.yShift),u.gl.bindBuffer(u.gl.ELEMENT_ARRAY_BUFFER,u.indexBuffer),u.gl.uniformMatrix4fv(u.pMatrixUniform,!1,u.pMatrix),u.gl.uniformMatrix4fv(u.mvMatrixUniform,!1,u.mvMatrix),u.gl.uniform1f(u.fCamShift,ptzconfig.zCamShift),u.gl.uniform1f(u.zLens,ptzconfig.zLens),u.gl.drawElements(u.gl.TRIANGLES,u.model.vertex.length/3,u.gl.UNSIGNED_SHORT,model.indices))}}),this},function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("rangeSlider",[],t):"object"==typeof exports?exports.rangeSlider=t():e.rangeSlider=t()}(window,function(){return function(a){var r={};function n(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}return n.m=a,n.c=r,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},t.delay=function(e,t){for(var a=arguments.length,r=Array(2<a?a-2:0),n=2;n<a;n++)r[n-2]=arguments[n];return setTimeout(function(){return e.apply(null,r)},t)},t.debounce=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100;return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return r.debouncing||(r.lastReturnVal=r.apply(window,t),r.debouncing=!0),clearTimeout(r.debounceTimeout),r.debounceTimeout=setTimeout(function(){r.debouncing=!1},n),r.lastReturnVal}};var r=t.isString=function(e){return e===""+e},o=(t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isNumberLike=function(e){return null!=e&&(r(e)&&isFinite(parseFloat(e))||isFinite(e))});t.getFirsNumberLike=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];if(!t.length)return null;for(var r=0,n=t.length;r<n;r++)if(o(t[r]))return t[r];return null},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.simpleExtend=function(e,t){var a={};for(var r in e)a[r]=e[r];for(var n in t)a[n]=t[n];return a},t.between=function(e,t,a){return e<t?t:a<e?a:e}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}(),l=n(a(2)),c=n(a(0));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}a(3);var i=new RegExp("/[\\n\\t]/","g"),u="rangeSlider",d=l.supportsRange(),m={polyfill:!0,root:document,rangeClass:"rangeSlider",disabledClass:"rangeSlider--disabled",fillClass:"rangeSlider__fill",bufferClass:"rangeSlider__buffer",handleClass:"rangeSlider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"],min:null,max:null,step:null,value:null,buffer:null,stick:null,borderRadius:10,vertical:!1},o=function(){function s(e,t){!function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this);var a=void 0,r=void 0,n=void 0;if(this.element=e,this.options=c.simpleExtend(m,t),this.polyfill=this.options.polyfill,this.vertical=this.options.vertical,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideStart=this.options.onSlideStart,this.onSlideEnd=this.options.onSlideEnd,this.onSlideEventsCount=-1,this.isInteractsNow=!1,this.needTriggerEvents=!1,this.polyfill||!d){this.options.buffer=this.options.buffer||parseFloat(this.element.getAttribute("data-buffer")),this.identifier="js-"+u+"-"+c.uuid(),this.min=c.getFirsNumberLike(this.options.min,parseFloat(this.element.getAttribute("min")),0),this.max=c.getFirsNumberLike(this.options.max,parseFloat(this.element.getAttribute("max")),100),this.value=c.getFirsNumberLike(this.options.value,this.element.value,parseFloat(this.element.value||this.min+(this.max-this.min)/2)),this.step=c.getFirsNumberLike(this.options.step,parseFloat(this.element.getAttribute("step"))||(a=1)),this.percent=null,c.isArray(this.options.stick)&&1<=this.options.stick.length?this.stick=this.options.stick:(r=this.element.getAttribute("stick"))&&1<=(n=r.split(" ")).length&&(this.stick=n.map(parseFloat)),this.stick&&1===this.stick.length&&this.stick.push(1.5*this.step),this._updatePercentFromValue(),this.toFixed=this._toFixed(this.step);var o=void 0;this.container=document.createElement("div"),l.addClass(this.container,this.options.fillClass),o=this.vertical?this.options.fillClass+"__vertical":this.options.fillClass+"__horizontal",l.addClass(this.container,o),this.handle=document.createElement("div"),l.addClass(this.handle,this.options.handleClass),o=this.vertical?this.options.handleClass+"__vertical":this.options.handleClass+"__horizontal",l.addClass(this.handle,o),this.range=document.createElement("div"),l.addClass(this.range,this.options.rangeClass),this.range.id=this.identifier;var i=e.getAttribute("title");i&&0<i.length&&this.range.setAttribute("title",i),this.options.bufferClass&&(this.buffer=document.createElement("div"),l.addClass(this.buffer,this.options.bufferClass),this.range.appendChild(this.buffer),o=this.vertical?this.options.bufferClass+"__vertical":this.options.bufferClass+"__horizontal",l.addClass(this.buffer,o)),this.range.appendChild(this.container),this.range.appendChild(this.handle),o=this.vertical?this.options.rangeClass+"__vertical":this.options.rangeClass+"__horizontal",l.addClass(this.range,o),c.isNumberLike(this.options.value)&&(this._setValue(this.options.value,!0),this.element.value=this.options.value),c.isNumberLike(this.options.buffer)&&this.element.setAttribute("data-buffer",this.options.buffer),c.isNumberLike(this.options.min)&&this.element.setAttribute("min",""+this.min),c.isNumberLike(this.options.max),this.element.setAttribute("max",""+this.max),(c.isNumberLike(this.options.step)||a)&&this.element.setAttribute("step",""+this.step),l.insertAfter(this.element,this.range),l.setCss(this.element,{position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this._handleDown=this._handleDown.bind(this),this._handleMove=this._handleMove.bind(this),this._handleEnd=this._handleEnd.bind(this),this._startEventListener=this._startEventListener.bind(this),this._changeEventListener=this._changeEventListener.bind(this),this._handleResize=this._handleResize.bind(this),this._init(),window.addEventListener("resize",this._handleResize,!1),l.addEventListeners(this.options.root,this.options.startEvent,this._startEventListener),this.element.addEventListener("change",this._changeEventListener,!1)}}return r(s,[{key:"update",value:function(e,t){return t&&(this.needTriggerEvents=!0),c.isObject(e)&&(c.isNumberLike(e.min)&&(this.element.setAttribute("min",""+e.min),this.min=e.min),c.isNumberLike(e.max)&&(this.element.setAttribute("max",""+e.max),this.max=e.max),c.isNumberLike(e.step)&&(this.element.setAttribute("step",""+e.step),this.step=e.step,this.toFixed=this._toFixed(e.step)),c.isNumberLike(e.buffer)&&this._setBufferPosition(e.buffer),c.isNumberLike(e.value)&&this._setValue(e.value)),this._update(),this.onSlideEventsCount=0,this.needTriggerEvents=!1,this}},{key:"destroy",value:function(){l.removeAllListenersFromEl(this,this.options.root),window.removeEventListener("resize",this._handleResize,!1),this.element.removeEventListener("change",this._changeEventListener,!1),this.element.style.cssText="",delete this.element[u],this.range&&this.range.parentNode.removeChild(this.range)}},{key:"_toFixed",value:function(e){return(e+"").replace(".","").length-1}},{key:"_init",value:function(){this.onInit&&"function"==typeof this.onInit&&this.onInit(),this._update(!1)}},{key:"_updatePercentFromValue",value:function(){this.percent=(this.value-this.min)/(this.max-this.min)}},{key:"_startEventListener",value:function(e,t){var a=this,r=e.target,n=!1;(1===e.which||"touches"in e)&&(l.forEachAncestors(r,function(e){return n=e.id===a.identifier&&!l.hasClass(e,a.options.disabledClass)},!0),n&&this._handleDown(e,t))}},{key:"_changeEventListener",value:function(e,t){if(!t||t.origin!==this.identifier){var a=e.target.value,r=this._getPositionFromValue(a);this._setPosition(r)}}},{key:"_update",value:function(e){var t=this.vertical?"offsetHeight":"offsetWidth";this.handleSize=l.getDimension(this.handle,t),this.rangeSize=l.getDimension(this.range,t),this.maxHandleX=this.rangeSize-this.handleSize,this.grabX=this.handleSize/2,this.position=this._getPositionFromValue(this.value),this.element.disabled?l.addClass(this.range,this.options.disabledClass):l.removeClass(this.range,this.options.disabledClass),this._setPosition(this.position),this.options.bufferClass&&this.options.buffer&&this._setBufferPosition(this.options.buffer),this._updatePercentFromValue(),!1!==e&&l.triggerEvent(this.element,"change",{origin:this.identifier})}},{key:"_handleResize",value:function(){var e=this;return c.debounce(function(){c.delay(function(){e._update()},300)},50)()}},{key:"_handleDown",value:function(e){if(this.isInteractsNow=!0,e.preventDefault(),l.addEventListeners(this.options.root,this.options.moveEvent,this._handleMove),l.addEventListeners(this.options.root,this.options.endEvent,this._handleEnd),!(-1<(" "+e.target.className+" ").replace(i," ").indexOf(this.options.handleClass))){var t=this.range.getBoundingClientRect(),a=this._getRelativePosition(e),r=this.vertical?t.bottom:t.left,n=this._getPositionFromNode(this.handle)-r,o=a-this.grabX;this._setPosition(o),n<=a&&a<n+2*this.options.borderRadius&&(this.grabX=a-n),this._updatePercentFromValue()}}},{key:"_handleMove",value:function(e){var t=this._getRelativePosition(e);this.isInteractsNow=!0,e.preventDefault(),this._setPosition(t-this.grabX)}},{key:"_handleEnd",value:function(e){e.preventDefault(),l.removeEventListeners(this.options.root,this.options.moveEvent,this._handleMove),l.removeEventListeners(this.options.root,this.options.endEvent,this._handleEnd),l.triggerEvent(this.element,"change",{origin:this.identifier}),(this.isInteractsNow||this.needTriggerEvents)&&this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.value,this.percent,this.position),this.onSlideEventsCount=0,this.isInteractsNow=!1}},{key:"_setPosition",value:function(e){var t,a=void 0,r=void 0,n=void 0,o=this._getValueFromPosition(c.between(e,0,this.maxHandleX));this.stick&&((r=o%(n=this.stick[0]))<(a=this.stick[1]||.1)?o-=r:Math.abs(n-r)<a&&(o=o-r+n)),t=this._getPositionFromValue(o),this.vertical?(this.container.style.height=t+this.grabX+"px",this.handle.style.webkitTransform="translateY(-"+t+"px)",this.handle.style.msTransform="translateY(-"+t+"px)",this.handle.style.transform="translateY(-"+t+"px)"):(this.container.style.width=t+this.grabX+"px",this.handle.style.webkitTransform="translateX("+t+"px)",this.handle.style.msTransform="translateX("+t+"px)",this.handle.style.transform="translateX("+t+"px)"),this._setValue(o),this.position=t,this.value=o,this._updatePercentFromValue(),(this.isInteractsNow||this.needTriggerEvents)&&(this.onSlideStart&&"function"==typeof this.onSlideStart&&0===this.onSlideEventsCount&&this.onSlideStart(this.value,this.percent,this.position),this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(this.value,this.percent,this.position)),this.onSlideEventsCount++}},{key:"_setBufferPosition",value:function(e){var t=!0;if(isFinite(e))e=parseFloat(e);else{if(!c.isString(e))return void console.warn("New position must be XXpx or XX%");0<e.indexOf("px")&&(t=!1),e=parseFloat(e)}if(isNaN(e))console.warn("New position is NaN");else if(this.options.bufferClass){var a=t?e:e/this.rangeSize*100;a<0&&(a=0),100<a&&(a=100),this.options.buffer=a;var r=this.options.borderRadius/this.rangeSize*100,n=a-r;n<0&&(n=0),this.vertical?(this.buffer.style.height=n+"%",this.buffer.style.bottom=.5*r+"%"):(this.buffer.style.width=n+"%",this.buffer.style.left=.5*r+"%"),this.element.setAttribute("data-buffer",a)}else console.warn("You disabled buffer, it's className is empty")}},{key:"_getPositionFromNode",value:function(e){for(var t=this.vertical?this.maxHandleX:0;null!==e;)t+=this.vertical?e.offsetTop:e.offsetLeft,e=e.offsetParent;return t}},{key:"_getRelativePosition",value:function(e){var t=this.range.getBoundingClientRect(),a=this.vertical?t.bottom:t.left,r=0,n=this.vertical?"pageY":"pageX";return void 0!==e[n]?r=e.touches&&e.touches.length?e.touches[0][n]:e[n]:void 0!==e.originalEvent?void 0!==e.originalEvent[n]?r=e.originalEvent[n]:e.originalEvent.touches&&e.originalEvent.touches[0]&&void 0!==e.originalEvent.touches[0][n]&&(r=e.originalEvent.touches[0][n]):e.touches&&e.touches[0]&&void 0!==e.touches[0][n]?r=e.touches[0][n]:!e.currentPoint||void 0===e.currentPoint.x&&void 0===e.currentPoint.y||(r=this.vertical?e.currentPoint.y:e.currentPoint.x),this.vertical&&(r-=window.pageYOffset),this.vertical?a-r:r-a}},{key:"_getPositionFromValue",value:function(e){var t=(e-this.min)/(this.max-this.min)*this.maxHandleX;return isNaN(t)?0:t}},{key:"_getValueFromPosition",value:function(e){var t=e/(this.maxHandleX||1),a=this.step*Math.round(t*(this.max-this.min)/this.step)+this.min;return Number(a.toFixed(this.toFixed))}},{key:"_setValue",value:function(e,t){(e!==this.value||t)&&(this.element.value=e,this.value=e,l.triggerEvent(this.element,"input",{origin:this.identifier}))}}],[{key:"create",value:function(e,a){var t=function(e){var t=e[u];t||(t=new s(e,a),e[u]=t)};e.length?Array.prototype.slice.call(e).forEach(function(e){t(e)}):t(e)}}]),s}();(t.default=o).version="0.4.10",o.dom=l,o.functions=c,e.exports=t.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportsRange=t.removeAllListenersFromEl=t.removeEventListeners=t.addEventListeners=t.insertAfter=t.triggerEvent=t.forEachAncestors=t.removeClass=t.addClass=t.hasClass=t.setCss=t.getDimension=t.getHiddenParentNodes=t.isHidden=t.detectIE=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(0)),o="eventListenerList",r=(t.detectIE=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(0<t)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(0<e.indexOf("Trident/")){var a=e.indexOf("rv:");return parseInt(e.substring(a+3,e.indexOf(".",a)),10)}var r=e.indexOf("Edge/");return 0<r&&parseInt(e.substring(r+5,e.indexOf(".",r)),10)})(),i=!(!window.PointerEvent||r)&&{passive:!1},s=t.isHidden=function(e){return 0===e.offsetWidth||0===e.offsetHeight||!1===e.open},c=t.getHiddenParentNodes=function(e){for(var t=[],a=e.parentNode;a&&s(a);)t.push(a),a=a.parentNode;return t},l=(t.getDimension=function(e,t){var a=c(e),r=a.length,n=[],o=e[t],i=function(e){void 0!==e.open&&(e.open=!e.open)};if(r){for(var s=0;s<r;s++)n.push({display:a[s].style.display,height:a[s].style.height,overflow:a[s].style.overflow,visibility:a[s].style.visibility}),a[s].style.display="block",a[s].style.height="0",a[s].style.overflow="hidden",a[s].style.visibility="hidden",i(a[s]);o=e[t];for(var l=0;l<r;l++)i(a[l]),a[l].style.display=n[l].display,a[l].style.height=n[l].height,a[l].style.overflow=n[l].overflow,a[l].style.visibility=n[l].visibility}return o},t.setCss=function(e,t){for(var a in t)e.style[a]=t[a];return e.style},t.hasClass=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")});t.addClass=function(e,t){l(e,t)||(e.className+=" "+t)},t.removeClass=function(e,t){var a=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(l(e,t)){for(;0<=a.indexOf(" "+t+" ");)a=a.replace(" "+t+" "," ");e.className=a.replace(/^\s+|\s+$/g,"")}},t.forEachAncestors=function(e,t,a){for(a&&t(e);e.parentNode&&!t(e);)e=e.parentNode;return e},t.triggerEvent=function(e,t,a){if(!n.isString(t))throw new TypeError("event name must be String");if(!(e instanceof HTMLElement))throw new TypeError("element must be HTMLElement");t=t.trim();var r=document.createEvent("CustomEvent");r.initCustomEvent(t,!1,!1,a),e.dispatchEvent(r)},t.insertAfter=function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},t.addEventListeners=function(t,e,a){e.forEach(function(e){t[o]||(t[o]={}),t[o][e]||(t[o][e]=[]),t.addEventListener(e,a,i),t[o][e].indexOf(a)<0&&t[o][e].push(a)})},t.removeEventListeners=function(a,e,r){e.forEach(function(e){var t=void 0;a.removeEventListener(e,r,!1),a[o]&&a[o][e]&&-1<(t=a[o][e].indexOf(r))&&a[o][e].splice(t,1)})},t.removeAllListenersFromEl=function(t,e){if(e[o]){for(var a in e[o])e[o][a].forEach(r,{eventName:a,el:e});e[o]={}}function r(e){e===t._startEventListener&&this.el.removeEventListener(this.eventName,e,!1)}},t.supportsRange=function(){var e=document.createElement("input");return e.setAttribute("type","range"),"text"!==e.type}},function(e,t,a){}])}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).glMatrix={})}(this,function(e){"use strict";var g="undefined"!=typeof Float32Array?Float32Array:Array,c=Math.random,t=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var a=Object.freeze({__proto__:null,EPSILON:1e-6,get ARRAY_TYPE(){return g},RANDOM:c,setMatrixArrayType:function(e){g=e},toRadian:function(e){return e*t},equals:function(e,t){return Math.abs(e-t)<=1e-6*Math.max(1,Math.abs(e),Math.abs(t))}});function r(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=a[0],l=a[1],c=a[2],u=a[3];return e[0]=r*s+o*l,e[1]=n*s+i*l,e[2]=r*c+o*u,e[3]=n*c+i*u,e}function n(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}var o=r,i=n,s=Object.freeze({__proto__:null,create:function(){var e=new g(4);return g!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},clone:function(e){var t=new g(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},fromValues:function(e,t,a,r){var n=new g(4);return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n},set:function(e,t,a,r,n){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e},transpose:function(e,t){if(e===t){var a=t[1];e[1]=t[2],e[2]=a}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},invert:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=a*o-n*r;return i?(i=1/i,e[0]=o*i,e[1]=-r*i,e[2]=-n*i,e[3]=a*i,e):null},adjoint:function(e,t){var a=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=a,e},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},multiply:r,rotate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=Math.sin(a),l=Math.cos(a);return e[0]=r*l+o*s,e[1]=n*l+i*s,e[2]=r*-s+o*l,e[3]=n*-s+i*l,e},scale:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=a[0],l=a[1];return e[0]=r*s,e[1]=n*s,e[2]=o*l,e[3]=i*l,e},fromRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=-a,e[3]=r,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},str:function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3])},LDU:function(e,t,a,r){return e[2]=r[2]/r[0],a[0]=r[0],a[1]=r[1],a[3]=r[3]-e[2]*a[1],[e,t,a]},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e},subtract:n,exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=t[0],s=t[1],l=t[2],c=t[3];return Math.abs(a-i)<=1e-6*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=1e-6*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=1e-6*Math.max(1,Math.abs(o),Math.abs(c))},multiplyScalar:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e},multiplyScalarAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e},mul:o,sub:i});function l(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=a[0],u=a[1],d=a[2],m=a[3],f=a[4],p=a[5];return e[0]=r*c+o*u,e[1]=n*c+i*u,e[2]=r*d+o*m,e[3]=n*d+i*m,e[4]=r*f+o*p+s,e[5]=n*f+i*p+l,e}function u(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e}var d=l,m=u,f=Object.freeze({__proto__:null,create:function(){var e=new g(6);return g!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},clone:function(e){var t=new g(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},fromValues:function(e,t,a,r,n,o){var i=new g(6);return i[0]=e,i[1]=t,i[2]=a,i[3]=r,i[4]=n,i[5]=o,i},set:function(e,t,a,r,n,o,i){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=o,e[5]=i,e},invert:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=a*o-r*n;return l?(l=1/l,e[0]=o*l,e[1]=-r*l,e[2]=-n*l,e[3]=a*l,e[4]=(n*s-o*i)*l,e[5]=(r*i-a*s)*l,e):null},determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:l,rotate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=Math.sin(a),u=Math.cos(a);return e[0]=r*u+o*c,e[1]=n*u+i*c,e[2]=r*-c+o*u,e[3]=n*-c+i*u,e[4]=s,e[5]=l,e},scale:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=a[0],u=a[1];return e[0]=r*c,e[1]=n*c,e[2]=o*u,e[3]=i*u,e[4]=s,e[5]=l,e},translate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=a[0],u=a[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=i,e[4]=r*c+o*u+s,e[5]=n*c+i*u+l,e},fromRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=-a,e[3]=r,e[4]=0,e[5]=0,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e},subtract:u,multiplyScalar:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e},multiplyScalarAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],l=t[0],c=t[1],u=t[2],d=t[3],m=t[4],f=t[5];return Math.abs(a-l)<=1e-6*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(r-c)<=1e-6*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-u)<=1e-6*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(o-d)<=1e-6*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-m)<=1e-6*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-f)<=1e-6*Math.max(1,Math.abs(s),Math.abs(f))},mul:d,sub:m});function p(){var e=new g(9);return g!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function h(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],m=a[0],f=a[1],p=a[2],h=a[3],v=a[4],g=a[5],C=a[6],y=a[7],A=a[8];return e[0]=m*r+f*i+p*c,e[1]=m*n+f*s+p*u,e[2]=m*o+f*l+p*d,e[3]=h*r+v*i+g*c,e[4]=h*n+v*s+g*u,e[5]=h*o+v*l+g*d,e[6]=C*r+y*i+A*c,e[7]=C*n+y*s+A*u,e[8]=C*o+y*l+A*d,e}function v(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e[6]=t[6]-a[6],e[7]=t[7]-a[7],e[8]=t[8]-a[8],e}var C=h,y=v,A=Object.freeze({__proto__:null,create:p,fromMat4:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},clone:function(e){var t=new g(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromValues:function(e,t,a,r,n,o,i,s,l){var c=new g(9);return c[0]=e,c[1]=t,c[2]=a,c[3]=r,c[4]=n,c[5]=o,c[6]=i,c[7]=s,c[8]=l,c},set:function(e,t,a,r,n,o,i,s,l,c){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=o,e[5]=i,e[6]=s,e[7]=l,e[8]=c,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(e===t){var a=t[1],r=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=a,e[5]=t[7],e[6]=r,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=u*i-s*c,m=-u*o+s*l,f=c*o-i*l,p=a*d+r*m+n*f;return p?(p=1/p,e[0]=d*p,e[1]=(-u*r+n*c)*p,e[2]=(s*r-n*i)*p,e[3]=m*p,e[4]=(u*a-n*l)*p,e[5]=(-s*a+n*o)*p,e[6]=f*p,e[7]=(-c*a+r*l)*p,e[8]=(i*a-r*o)*p,e):null},adjoint:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8];return e[0]=i*u-s*c,e[1]=n*c-r*u,e[2]=r*s-n*i,e[3]=s*l-o*u,e[4]=a*u-n*l,e[5]=n*o-a*s,e[6]=o*c-i*l,e[7]=r*l-a*c,e[8]=a*i-r*o,e},determinant:function(e){var t=e[0],a=e[1],r=e[2],n=e[3],o=e[4],i=e[5],s=e[6],l=e[7],c=e[8];return t*(c*o-i*l)+a*(-c*n+i*s)+r*(l*n-o*s)},multiply:h,translate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],m=a[0],f=a[1];return e[0]=r,e[1]=n,e[2]=o,e[3]=i,e[4]=s,e[5]=l,e[6]=m*r+f*i+c,e[7]=m*n+f*s+u,e[8]=m*o+f*l+d,e},rotate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],m=Math.sin(a),f=Math.cos(a);return e[0]=f*r+m*i,e[1]=f*n+m*s,e[2]=f*o+m*l,e[3]=f*i-m*r,e[4]=f*s-m*n,e[5]=f*l-m*o,e[6]=c,e[7]=u,e[8]=d,e},scale:function(e,t,a){var r=a[0],n=a[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=0,e[3]=-a,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=a+a,s=r+r,l=n+n,c=a*i,u=r*i,d=r*s,m=n*i,f=n*s,p=n*l,h=o*i,v=o*s,g=o*l;return e[0]=1-d-p,e[3]=u-g,e[6]=m+v,e[1]=u+g,e[4]=1-c-p,e[7]=f-h,e[2]=m-v,e[5]=f+h,e[8]=1-c-d,e},normalFromMat4:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],m=t[10],f=t[11],p=t[12],h=t[13],v=t[14],g=t[15],C=a*s-r*i,y=a*l-n*i,A=a*c-o*i,_=r*l-n*s,E=r*c-o*s,P=n*c-o*l,b=u*h-d*p,S=u*v-m*p,T=u*g-f*p,w=d*v-m*h,M=d*g-f*h,R=m*g-f*v,I=C*R-y*M+A*w+_*T-E*S+P*b;return I?(I=1/I,e[0]=(s*R-l*M+c*w)*I,e[1]=(l*T-i*R-c*S)*I,e[2]=(i*M-s*T+c*b)*I,e[3]=(n*M-r*R-o*w)*I,e[4]=(a*R-n*T+o*S)*I,e[5]=(r*T-a*M-o*b)*I,e[6]=(h*P-v*E+g*_)*I,e[7]=(v*A-p*P-g*y)*I,e[8]=(p*E-h*A+g*C)*I,e):null},projection:function(e,t,a){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/a,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e[8]=t[8]+a[8],e},subtract:v,multiplyScalar:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*a,e},multiplyScalarAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e[6]=t[6]+a[6]*r,e[7]=t[7]+a[7]*r,e[8]=t[8]+a[8]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=t[0],m=t[1],f=t[2],p=t[3],h=t[4],v=t[5],g=t[6],C=t[7],y=t[8];return Math.abs(a-d)<=1e-6*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(r-m)<=1e-6*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-f)<=1e-6*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(o-p)<=1e-6*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(i-h)<=1e-6*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-v)<=1e-6*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-g)<=1e-6*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-C)<=1e-6*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-y)<=1e-6*Math.max(1,Math.abs(u),Math.abs(y))},mul:C,sub:y});function P(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],m=t[9],f=t[10],p=t[11],h=t[12],v=t[13],g=t[14],C=t[15],y=a[0],A=a[1],_=a[2],E=a[3];return e[0]=y*r+A*s+_*d+E*h,e[1]=y*n+A*l+_*m+E*v,e[2]=y*o+A*c+_*f+E*g,e[3]=y*i+A*u+_*p+E*C,y=a[4],A=a[5],_=a[6],E=a[7],e[4]=y*r+A*s+_*d+E*h,e[5]=y*n+A*l+_*m+E*v,e[6]=y*o+A*c+_*f+E*g,e[7]=y*i+A*u+_*p+E*C,y=a[8],A=a[9],_=a[10],E=a[11],e[8]=y*r+A*s+_*d+E*h,e[9]=y*n+A*l+_*m+E*v,e[10]=y*o+A*c+_*f+E*g,e[11]=y*i+A*u+_*p+E*C,y=a[12],A=a[13],_=a[14],E=a[15],e[12]=y*r+A*s+_*d+E*h,e[13]=y*n+A*l+_*m+E*v,e[14]=y*o+A*c+_*f+E*g,e[15]=y*i+A*u+_*p+E*C,e}function E(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=r+r,l=n+n,c=o+o,u=r*s,d=r*l,m=r*c,f=n*l,p=n*c,h=o*c,v=i*s,g=i*l,C=i*c;return e[0]=1-(f+h),e[1]=d+C,e[2]=m-g,e[3]=0,e[4]=d-C,e[5]=1-(u+h),e[6]=p+v,e[7]=0,e[8]=m+g,e[9]=p-v,e[10]=1-(u+f),e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e}function b(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function S(e,t){var a=t[0],r=t[1],n=t[2],o=t[4],i=t[5],s=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(a,r,n),e[1]=Math.hypot(o,i,s),e[2]=Math.hypot(l,c,u),e}function T(e,t){var a=new g(3);S(a,t);var r=1/a[0],n=1/a[1],o=1/a[2],i=t[0]*r,s=t[1]*n,l=t[2]*o,c=t[4]*r,u=t[5]*n,d=t[6]*o,m=t[8]*r,f=t[9]*n,p=t[10]*o,h=i+u+p,v=0;return e[2]=0<h?(v=2*Math.sqrt(h+1),e[3]=.25*v,e[0]=(d-f)/v,e[1]=(m-l)/v,(s-c)/v):u<i&&p<i?(v=2*Math.sqrt(1+i-u-p),e[3]=(d-f)/v,e[0]=.25*v,e[1]=(s+c)/v,(m+l)/v):p<u?(v=2*Math.sqrt(1+u-i-p),e[3]=(m-l)/v,e[0]=(s+c)/v,e[1]=.25*v,(d+f)/v):(v=2*Math.sqrt(1+p-i-u),e[3]=(s-c)/v,e[0]=(m+l)/v,e[1]=(d+f)/v,.25*v),e}function w(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e[4]=t[4]-a[4],e[5]=t[5]-a[5],e[6]=t[6]-a[6],e[7]=t[7]-a[7],e[8]=t[8]-a[8],e[9]=t[9]-a[9],e[10]=t[10]-a[10],e[11]=t[11]-a[11],e[12]=t[12]-a[12],e[13]=t[13]-a[13],e[14]=t[14]-a[14],e[15]=t[15]-a[15],e}var M=_,R=w,I=Object.freeze({__proto__:null,create:function(){var e=new g(16);return g!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},clone:function(e){var t=new g(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(e,t,a,r,n,o,i,s,l,c,u,d,m,f,p,h){var v=new g(16);return v[0]=e,v[1]=t,v[2]=a,v[3]=r,v[4]=n,v[5]=o,v[6]=i,v[7]=s,v[8]=l,v[9]=c,v[10]=u,v[11]=d,v[12]=m,v[13]=f,v[14]=p,v[15]=h,v},set:function(e,t,a,r,n,o,i,s,l,c,u,d,m,f,p,h,v){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=o,e[5]=i,e[6]=s,e[7]=l,e[8]=c,e[9]=u,e[10]=d,e[11]=m,e[12]=f,e[13]=p,e[14]=h,e[15]=v,e},identity:P,transpose:function(e,t){if(e===t){var a=t[1],r=t[2],n=t[3],o=t[6],i=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=a,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=n,e[13]=i,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},invert:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],m=t[10],f=t[11],p=t[12],h=t[13],v=t[14],g=t[15],C=a*s-r*i,y=a*l-n*i,A=a*c-o*i,_=r*l-n*s,E=r*c-o*s,P=n*c-o*l,b=u*h-d*p,S=u*v-m*p,T=u*g-f*p,w=d*v-m*h,M=d*g-f*h,R=m*g-f*v,I=C*R-y*M+A*w+_*T-E*S+P*b;return I?(I=1/I,e[0]=(s*R-l*M+c*w)*I,e[1]=(n*M-r*R-o*w)*I,e[2]=(h*P-v*E+g*_)*I,e[3]=(m*E-d*P-f*_)*I,e[4]=(l*T-i*R-c*S)*I,e[5]=(a*R-n*T+o*S)*I,e[6]=(v*A-p*P-g*y)*I,e[7]=(u*P-m*A+f*y)*I,e[8]=(i*M-s*T+c*b)*I,e[9]=(r*T-a*M-o*b)*I,e[10]=(p*E-h*A+g*C)*I,e[11]=(d*A-u*E-f*C)*I,e[12]=(s*S-i*w-l*b)*I,e[13]=(a*w-r*S+n*b)*I,e[14]=(h*y-p*_-v*C)*I,e[15]=(u*_-d*y+m*C)*I,e):null},adjoint:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=t[4],s=t[5],l=t[6],c=t[7],u=t[8],d=t[9],m=t[10],f=t[11],p=t[12],h=t[13],v=t[14],g=t[15];return e[0]=s*(m*g-f*v)-d*(l*g-c*v)+h*(l*f-c*m),e[1]=-(r*(m*g-f*v)-d*(n*g-o*v)+h*(n*f-o*m)),e[2]=r*(l*g-c*v)-s*(n*g-o*v)+h*(n*c-o*l),e[3]=-(r*(l*f-c*m)-s*(n*f-o*m)+d*(n*c-o*l)),e[4]=-(i*(m*g-f*v)-u*(l*g-c*v)+p*(l*f-c*m)),e[5]=a*(m*g-f*v)-u*(n*g-o*v)+p*(n*f-o*m),e[6]=-(a*(l*g-c*v)-i*(n*g-o*v)+p*(n*c-o*l)),e[7]=a*(l*f-c*m)-i*(n*f-o*m)+u*(n*c-o*l),e[8]=i*(d*g-f*h)-u*(s*g-c*h)+p*(s*f-c*d),e[9]=-(a*(d*g-f*h)-u*(r*g-o*h)+p*(r*f-o*d)),e[10]=a*(s*g-c*h)-i*(r*g-o*h)+p*(r*c-o*s),e[11]=-(a*(s*f-c*d)-i*(r*f-o*d)+u*(r*c-o*s)),e[12]=-(i*(d*v-m*h)-u*(s*v-l*h)+p*(s*m-l*d)),e[13]=a*(d*v-m*h)-u*(r*v-n*h)+p*(r*m-n*d),e[14]=-(a*(s*v-l*h)-i*(r*v-n*h)+p*(r*l-n*s)),e[15]=a*(s*m-l*d)-i*(r*m-n*d)+u*(r*l-n*s),e},determinant:function(e){var t=e[0],a=e[1],r=e[2],n=e[3],o=e[4],i=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],m=e[11],f=e[12],p=e[13],h=e[14],v=e[15];return(t*i-a*o)*(d*v-m*h)-(t*s-r*o)*(u*v-m*p)+(t*l-n*o)*(u*h-d*p)+(a*s-r*i)*(c*v-m*f)-(a*l-n*i)*(c*h-d*f)+(r*l-n*s)*(c*p-u*f)},multiply:_,translate:function(e,t,a){var r,n,o,i,s,l,c,u,d,m,f,p,h=a[0],v=a[1],g=a[2];return e[15]=t===e?(e[12]=t[0]*h+t[4]*v+t[8]*g+t[12],e[13]=t[1]*h+t[5]*v+t[9]*g+t[13],e[14]=t[2]*h+t[6]*v+t[10]*g+t[14],t[3]*h+t[7]*v+t[11]*g+t[15]):(r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=t[8],m=t[9],f=t[10],p=t[11],e[0]=r,e[1]=n,e[2]=o,e[3]=i,e[4]=s,e[5]=l,e[6]=c,e[7]=u,e[8]=d,e[9]=m,e[10]=f,e[11]=p,e[12]=r*h+s*v+d*g+t[12],e[13]=n*h+l*v+m*g+t[13],e[14]=o*h+c*v+f*g+t[14],i*h+u*v+p*g+t[15]),e},scale:function(e,t,a){var r=a[0],n=a[1],o=a[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},rotate:function(e,t,a,r){var n,o,i,s,l,c,u,d,m,f,p,h,v,g,C,y,A,_,E,P,b,S,T,w,M=r[0],R=r[1],I=r[2],k=Math.hypot(M,R,I);return k<1e-6?null:(M*=k=1/k,R*=k,I*=k,n=Math.sin(a),i=1-(o=Math.cos(a)),s=t[0],l=t[1],c=t[2],u=t[3],d=t[4],m=t[5],f=t[6],p=t[7],h=t[8],v=t[9],g=t[10],C=t[11],y=M*M*i+o,A=R*M*i+I*n,_=I*M*i-R*n,E=M*R*i-I*n,P=R*R*i+o,b=I*R*i+M*n,S=M*I*i+R*n,T=R*I*i-M*n,w=I*I*i+o,e[0]=s*y+d*A+h*_,e[1]=l*y+m*A+v*_,e[2]=c*y+f*A+g*_,e[3]=u*y+p*A+C*_,e[4]=s*E+d*P+h*b,e[5]=l*E+m*P+v*b,e[6]=c*E+f*P+g*b,e[7]=u*E+p*P+C*b,e[8]=s*S+d*T+h*w,e[9]=l*S+m*T+v*w,e[10]=c*S+f*T+g*w,e[11]=u*S+p*T+C*w,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},rotateX:function(e,t,a){var r=Math.sin(a),n=Math.cos(a),o=t[4],i=t[5],s=t[6],l=t[7],c=t[8],u=t[9],d=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*n+c*r,e[5]=i*n+u*r,e[6]=s*n+d*r,e[7]=l*n+m*r,e[8]=c*n-o*r,e[9]=u*n-i*r,e[10]=d*n-s*r,e[11]=m*n-l*r,e},rotateY:function(e,t,a){var r=Math.sin(a),n=Math.cos(a),o=t[0],i=t[1],s=t[2],l=t[3],c=t[8],u=t[9],d=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n-c*r,e[1]=i*n-u*r,e[2]=s*n-d*r,e[3]=l*n-m*r,e[8]=o*r+c*n,e[9]=i*r+u*n,e[10]=s*r+d*n,e[11]=l*r+m*n,e},rotateZ:function(e,t,a){var r=Math.sin(a),n=Math.cos(a),o=t[0],i=t[1],s=t[2],l=t[3],c=t[4],u=t[5],d=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*n+c*r,e[1]=i*n+u*r,e[2]=s*n+d*r,e[3]=l*n+m*r,e[4]=c*n-o*r,e[5]=u*n-i*r,e[6]=d*n-s*r,e[7]=m*n-l*r,e},fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotation:function(e,t,a){var r,n,o,i=a[0],s=a[1],l=a[2],c=Math.hypot(i,s,l);return c<1e-6?null:(i*=c=1/c,s*=c,l*=c,r=Math.sin(t),o=1-(n=Math.cos(t)),e[0]=i*i*o+n,e[1]=s*i*o+l*r,e[2]=l*i*o-s*r,e[3]=0,e[4]=i*s*o-l*r,e[5]=s*s*o+n,e[6]=l*s*o+i*r,e[7]=0,e[8]=i*l*o+s*r,e[9]=s*l*o-i*r,e[10]=l*l*o+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},fromXRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=a,e[7]=0,e[8]=0,e[9]=-a,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromYRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-a,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=a,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:function(e,t){var a=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=a,e[2]=0,e[3]=0,e[4]=-a,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromRotationTranslation:E,fromQuat2:function(e,t){var a=new g(3),r=-t[0],n=-t[1],o=-t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=r*r+n*n+o*o+i*i;return a[2]=0<d?(a[0]=2*(s*i+u*r+l*o-c*n)/d,a[1]=2*(l*i+u*n+c*r-s*o)/d,2*(c*i+u*o+s*n-l*r)/d):(a[0]=2*(s*i+u*r+l*o-c*n),a[1]=2*(l*i+u*n+c*r-s*o),2*(c*i+u*o+s*n-l*r)),E(e,t,a),e},getTranslation:b,getScaling:S,getRotation:T,fromRotationTranslationScale:function(e,t,a,r){var n=t[0],o=t[1],i=t[2],s=t[3],l=n+n,c=o+o,u=i+i,d=n*l,m=n*c,f=n*u,p=o*c,h=o*u,v=i*u,g=s*l,C=s*c,y=s*u,A=r[0],_=r[1],E=r[2];return e[0]=(1-(p+v))*A,e[1]=(m+y)*A,e[2]=(f-C)*A,e[3]=0,e[4]=(m-y)*_,e[5]=(1-(d+v))*_,e[6]=(h+g)*_,e[7]=0,e[8]=(f+C)*E,e[9]=(h-g)*E,e[10]=(1-(d+p))*E,e[11]=0,e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,a,r,n){var o=t[0],i=t[1],s=t[2],l=t[3],c=o+o,u=i+i,d=s+s,m=o*c,f=o*u,p=o*d,h=i*u,v=i*d,g=s*d,C=l*c,y=l*u,A=l*d,_=r[0],E=r[1],P=r[2],b=n[0],S=n[1],T=n[2],w=(1-(h+g))*_,M=(f+A)*_,R=(p-y)*_,I=(f-A)*E,k=(1-(m+g))*E,O=(v+C)*E,N=(p+y)*P,D=(v-C)*P,L=(1-(m+h))*P;return e[0]=w,e[1]=M,e[2]=R,e[3]=0,e[4]=I,e[5]=k,e[6]=O,e[7]=0,e[8]=N,e[9]=D,e[10]=L,e[11]=0,e[12]=a[0]+b-(w*b+I*S+N*T),e[13]=a[1]+S-(M*b+k*S+D*T),e[14]=a[2]+T-(R*b+O*S+L*T),e[15]=1,e},fromQuat:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=a+a,s=r+r,l=n+n,c=a*i,u=r*i,d=r*s,m=n*i,f=n*s,p=n*l,h=o*i,v=o*s,g=o*l;return e[0]=1-d-p,e[1]=u+g,e[2]=m-v,e[3]=0,e[4]=u-g,e[5]=1-c-p,e[6]=f+h,e[7]=0,e[8]=m+v,e[9]=f-h,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},frustum:function(e,t,a,r,n,o,i){var s=1/(a-t),l=1/(n-r),c=1/(o-i);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(a+t)*s,e[9]=(n+r)*l,e[10]=(i+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*o*2*c,e[15]=0,e},perspective:function(e,t,a,r,n){var o,i=1/Math.tan(t/2);return e[0]=i/a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,e[14]=null!=n&&n!==1/0?(o=1/(r-n),e[10]=(n+r)*o,2*n*r*o):(e[10]=-1,-2*r),e},perspectiveFromFieldOfView:function(e,t,a,r){var n=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),i=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(i+s),c=2/(n+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(i-s)*l*.5,e[9]=(n-o)*c*.5,e[10]=r/(a-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*a/(a-r),e[15]=0,e},ortho:function(e,t,a,r,n,o,i){var s=1/(t-a),l=1/(r-n),c=1/(o-i);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+a)*s,e[13]=(n+r)*l,e[14]=(i+o)*c,e[15]=1,e},lookAt:function(e,t,a,r){var n,o,i,s,l,c,u,d,m,f,p=t[0],h=t[1],v=t[2],g=r[0],C=r[1],y=r[2],A=a[0],_=a[1],E=a[2];return Math.abs(p-A)<1e-6&&Math.abs(h-_)<1e-6&&Math.abs(v-E)<1e-6?P(e):(u=p-A,d=h-_,m=v-E,n=C*(m*=f=1/Math.hypot(u,d,m))-y*(d*=f),o=y*(u*=f)-g*m,i=g*d-C*u,(f=Math.hypot(n,o,i))?(n*=f=1/f,o*=f,i*=f):i=o=n=0,s=d*i-m*o,l=m*n-u*i,c=u*o-d*n,(f=Math.hypot(s,l,c))?(s*=f=1/f,l*=f,c*=f):c=l=s=0,e[0]=n,e[1]=s,e[2]=u,e[3]=0,e[4]=o,e[5]=l,e[6]=d,e[7]=0,e[8]=i,e[9]=c,e[10]=m,e[11]=0,e[12]=-(n*p+o*h+i*v),e[13]=-(s*p+l*h+c*v),e[14]=-(u*p+d*h+m*v),e[15]=1,e)},targetTo:function(e,t,a,r){var n=t[0],o=t[1],i=t[2],s=r[0],l=r[1],c=r[2],u=n-a[0],d=o-a[1],m=i-a[2],f=u*u+d*d+m*m;0<f&&(u*=f=1/Math.sqrt(f),d*=f,m*=f);var p=l*m-c*d,h=c*u-s*m,v=s*d-l*u;return 0<(f=p*p+h*h+v*v)&&(p*=f=1/Math.sqrt(f),h*=f,v*=f),e[0]=p,e[1]=h,e[2]=v,e[3]=0,e[4]=d*v-m*h,e[5]=m*p-u*v,e[6]=u*h-d*p,e[7]=0,e[8]=u,e[9]=d,e[10]=m,e[11]=0,e[12]=n,e[13]=o,e[14]=i,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e[8]=t[8]+a[8],e[9]=t[9]+a[9],e[10]=t[10]+a[10],e[11]=t[11]+a[11],e[12]=t[12]+a[12],e[13]=t[13]+a[13],e[14]=t[14]+a[14],e[15]=t[15]+a[15],e},subtract:w,multiplyScalar:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12]*a,e[13]=t[13]*a,e[14]=t[14]*a,e[15]=t[15]*a,e},multiplyScalarAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e[4]=t[4]+a[4]*r,e[5]=t[5]+a[5]*r,e[6]=t[6]+a[6]*r,e[7]=t[7]+a[7]*r,e[8]=t[8]+a[8]*r,e[9]=t[9]+a[9]*r,e[10]=t[10]+a[10]*r,e[11]=t[11]+a[11]*r,e[12]=t[12]+a[12]*r,e[13]=t[13]+a[13]*r,e[14]=t[14]+a[14]*r,e[15]=t[15]+a[15]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8],d=e[9],m=e[10],f=e[11],p=e[12],h=e[13],v=e[14],g=e[15],C=t[0],y=t[1],A=t[2],_=t[3],E=t[4],P=t[5],b=t[6],S=t[7],T=t[8],w=t[9],M=t[10],R=t[11],I=t[12],k=t[13],O=t[14],N=t[15];return Math.abs(a-C)<=1e-6*Math.max(1,Math.abs(a),Math.abs(C))&&Math.abs(r-y)<=1e-6*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(n-A)<=1e-6*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(o-_)<=1e-6*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(i-E)<=1e-6*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(s-P)<=1e-6*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(l-b)<=1e-6*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(c-S)<=1e-6*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-T)<=1e-6*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(d-w)<=1e-6*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(m-M)<=1e-6*Math.max(1,Math.abs(m),Math.abs(M))&&Math.abs(f-R)<=1e-6*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(p-I)<=1e-6*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(h-k)<=1e-6*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(v-O)<=1e-6*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(g-N)<=1e-6*Math.max(1,Math.abs(g),Math.abs(N))},mul:M,sub:R});function k(){var e=new g(3);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function O(e){var t=e[0],a=e[1],r=e[2];return Math.hypot(t,a,r)}function N(e,t,a){var r=new g(3);return r[0]=e,r[1]=t,r[2]=a,r}function D(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e}function L(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e}function x(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e}function U(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return Math.hypot(a,r,n)}function H(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return a*a+r*r+n*n}function z(e){var t=e[0],a=e[1],r=e[2];return t*t+a*a+r*r}function j(e,t){var a=t[0],r=t[1],n=t[2],o=a*a+r*r+n*n;return 0<o&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function B(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function F(e,t,a){var r=t[0],n=t[1],o=t[2],i=a[0],s=a[1],l=a[2];return e[0]=n*l-o*s,e[1]=o*i-r*l,e[2]=r*s-n*i,e}var W,G=D,Y=L,q=x,V=U,K=H,Z=O,$=z,J=(W=k(),function(e,t,a,r,n,o){var i,s;for(t||(t=3),a||(a=0),s=r?Math.min(r*t+a,e.length):e.length,i=a;i<s;i+=t)W[0]=e[i],W[1]=e[i+1],W[2]=e[i+2],n(W,W,o),e[i]=W[0],e[i+1]=W[1],e[i+2]=W[2];return e}),X=Object.freeze({__proto__:null,create:k,clone:function(e){var t=new g(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},length:O,fromValues:N,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},set:function(e,t,a,r){return e[0]=t,e[1]=a,e[2]=r,e},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e},subtract:D,multiply:L,divide:x,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},min:function(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e[2]=Math.min(t[2],a[2]),e},max:function(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e[2]=Math.max(t[2],a[2]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e},scaleAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e},distance:U,squaredDistance:H,squaredLength:z,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:j,dot:B,cross:F,lerp:function(e,t,a,r){var n=t[0],o=t[1],i=t[2];return e[0]=n+r*(a[0]-n),e[1]=o+r*(a[1]-o),e[2]=i+r*(a[2]-i),e},hermite:function(e,t,a,r,n,o){var i=o*o,s=i*(2*o-3)+1,l=i*(o-2)+o,c=i*(o-1),u=i*(3-2*o);return e[0]=t[0]*s+a[0]*l+r[0]*c+n[0]*u,e[1]=t[1]*s+a[1]*l+r[1]*c+n[1]*u,e[2]=t[2]*s+a[2]*l+r[2]*c+n[2]*u,e},bezier:function(e,t,a,r,n,o){var i=1-o,s=i*i,l=o*o,c=s*i,u=3*o*s,d=3*l*i,m=l*o;return e[0]=t[0]*c+a[0]*u+r[0]*d+n[0]*m,e[1]=t[1]*c+a[1]*u+r[1]*d+n[1]*m,e[2]=t[2]*c+a[2]*u+r[2]*d+n[2]*m,e},random:function(e,t){t=t||1;var a=2*c()*Math.PI,r=2*c()-1,n=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(a)*n,e[1]=Math.sin(a)*n,e[2]=r*t,e},transformMat4:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=a[3]*r+a[7]*n+a[11]*o+a[15];return i=i||1,e[0]=(a[0]*r+a[4]*n+a[8]*o+a[12])/i,e[1]=(a[1]*r+a[5]*n+a[9]*o+a[13])/i,e[2]=(a[2]*r+a[6]*n+a[10]*o+a[14])/i,e},transformMat3:function(e,t,a){var r=t[0],n=t[1],o=t[2];return e[0]=r*a[0]+n*a[3]+o*a[6],e[1]=r*a[1]+n*a[4]+o*a[7],e[2]=r*a[2]+n*a[5]+o*a[8],e},transformQuat:function(e,t,a){var r=a[0],n=a[1],o=a[2],i=a[3],s=t[0],l=t[1],c=t[2],u=n*c-o*l,d=o*s-r*c,m=r*l-n*s,f=n*m-o*d,p=o*u-r*m,h=r*d-n*u,v=2*i;return u*=v,d*=v,m*=v,f*=2,p*=2,h*=2,e[0]=s+u+f,e[1]=l+d+p,e[2]=c+m+h,e},rotateX:function(e,t,a,r){var n=[],o=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],o[0]=n[0],o[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),o[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),e[0]=o[0]+a[0],e[1]=o[1]+a[1],e[2]=o[2]+a[2],e},rotateY:function(e,t,a,r){var n=[],o=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],o[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),o[1]=n[1],o[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),e[0]=o[0]+a[0],e[1]=o[1]+a[1],e[2]=o[2]+a[2],e},rotateZ:function(e,t,a,r){var n=[],o=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],o[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),o[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),o[2]=n[2],e[0]=o[0]+a[0],e[1]=o[1]+a[1],e[2]=o[2]+a[2],e},angle:function(e,t){var a=e[0],r=e[1],n=e[2],o=t[0],i=t[1],s=t[2],l=Math.sqrt(a*a+r*r+n*n)*Math.sqrt(o*o+i*i+s*s),c=l&&B(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e},str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=t[0],i=t[1],s=t[2];return Math.abs(a-o)<=1e-6*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-i)<=1e-6*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-s)<=1e-6*Math.max(1,Math.abs(n),Math.abs(s))},sub:G,mul:Y,div:q,dist:V,sqrDist:K,len:Z,sqrLen:$,forEach:J});function Q(){var e=new g(4);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ee(e){var t=new g(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function te(e,t,a,r){var n=new g(4);return n[0]=e,n[1]=t,n[2]=a,n[3]=r,n}function ae(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function re(e,t,a,r,n){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e}function ne(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e}function oe(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],e[3]=t[3]-a[3],e}function ie(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],e}function se(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],e[3]=t[3]/a[3],e}function le(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e}function ce(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return Math.hypot(a,r,n,o)}function ue(e,t){var a=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2],o=t[3]-e[3];return a*a+r*r+n*n+o*o}function de(e){var t=e[0],a=e[1],r=e[2],n=e[3];return Math.hypot(t,a,r,n)}function me(e){var t=e[0],a=e[1],r=e[2],n=e[3];return t*t+a*a+r*r+n*n}function fe(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=a*a+r*r+n*n+o*o;return 0<i&&(i=1/Math.sqrt(i)),e[0]=a*i,e[1]=r*i,e[2]=n*i,e[3]=o*i,e}function pe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function he(e,t,a,r){var n=t[0],o=t[1],i=t[2],s=t[3];return e[0]=n+r*(a[0]-n),e[1]=o+r*(a[1]-o),e[2]=i+r*(a[2]-i),e[3]=s+r*(a[3]-s),e}function ve(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function ge(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=t[0],s=t[1],l=t[2],c=t[3];return Math.abs(a-i)<=1e-6*Math.max(1,Math.abs(a),Math.abs(i))&&Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=1e-6*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-c)<=1e-6*Math.max(1,Math.abs(o),Math.abs(c))}var Ce,ye=oe,Ae=ie,_e=se,Ee=ce,Pe=ue,be=de,Se=me,Te=(Ce=Q(),function(e,t,a,r,n,o){var i,s;for(t||(t=4),a||(a=0),s=r?Math.min(r*t+a,e.length):e.length,i=a;i<s;i+=t)Ce[0]=e[i],Ce[1]=e[i+1],Ce[2]=e[i+2],Ce[3]=e[i+3],n(Ce,Ce,o),e[i]=Ce[0],e[i+1]=Ce[1],e[i+2]=Ce[2],e[i+3]=Ce[3];return e}),we=Object.freeze({__proto__:null,create:Q,clone:ee,fromValues:te,copy:ae,set:re,add:ne,subtract:oe,multiply:ie,divide:se,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},min:function(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e[2]=Math.min(t[2],a[2]),e[3]=Math.min(t[3],a[3]),e},max:function(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e[2]=Math.max(t[2],a[2]),e[3]=Math.max(t[3],a[3]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:le,scaleAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e[2]=t[2]+a[2]*r,e[3]=t[3]+a[3]*r,e},distance:ce,squaredDistance:ue,length:de,squaredLength:me,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},normalize:fe,dot:pe,cross:function(e,t,a,r){var n=a[0]*r[1]-a[1]*r[0],o=a[0]*r[2]-a[2]*r[0],i=a[0]*r[3]-a[3]*r[0],s=a[1]*r[2]-a[2]*r[1],l=a[1]*r[3]-a[3]*r[1],c=a[2]*r[3]-a[3]*r[2],u=t[0],d=t[1],m=t[2],f=t[3];return e[0]=d*c-m*l+f*s,e[1]=-u*c+m*i-f*o,e[2]=u*l-d*i+f*n,e[3]=-u*s+d*o-m*n,e},lerp:he,random:function(e,t){var a,r,n,o,i,s;for(t=t||1;1<=(i=(a=2*c()-1)*a+(r=2*c()-1)*r););for(;1<=(s=(n=2*c()-1)*n+(o=2*c()-1)*o););var l=Math.sqrt((1-i)/s);return e[0]=t*a,e[1]=t*r,e[2]=t*n*l,e[3]=t*o*l,e},transformMat4:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3];return e[0]=a[0]*r+a[4]*n+a[8]*o+a[12]*i,e[1]=a[1]*r+a[5]*n+a[9]*o+a[13]*i,e[2]=a[2]*r+a[6]*n+a[10]*o+a[14]*i,e[3]=a[3]*r+a[7]*n+a[11]*o+a[15]*i,e},transformQuat:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=a[0],s=a[1],l=a[2],c=a[3],u=c*r+s*o-l*n,d=c*n+l*r-i*o,m=c*o+i*n-s*r,f=-i*r-s*n-l*o;return e[0]=u*c+f*-i+d*-l-m*-s,e[1]=d*c+f*-s+m*-i-u*-l,e[2]=m*c+f*-l+u*-s-d*-i,e[3]=t[3],e},zero:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},exactEquals:ve,equals:ge,sub:ye,mul:Ae,div:_e,dist:Ee,sqrDist:Pe,len:be,sqrLen:Se,forEach:Te});function Me(){var e=new g(4);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Re(e,t,a){a*=.5;var r=Math.sin(a);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(a),e}function Ie(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=a[0],l=a[1],c=a[2],u=a[3];return e[0]=r*u+i*s+n*c-o*l,e[1]=n*u+i*l+o*s-r*c,e[2]=o*u+i*c+r*l-n*s,e[3]=i*u-r*s-n*l-o*c,e}function ke(e,t,a){a*=.5;var r=t[0],n=t[1],o=t[2],i=t[3],s=Math.sin(a),l=Math.cos(a);return e[0]=r*l+i*s,e[1]=n*l+o*s,e[2]=o*l-n*s,e[3]=i*l-r*s,e}function Oe(e,t,a){a*=.5;var r=t[0],n=t[1],o=t[2],i=t[3],s=Math.sin(a),l=Math.cos(a);return e[0]=r*l-o*s,e[1]=n*l+i*s,e[2]=o*l+r*s,e[3]=i*l-n*s,e}function Ne(e,t,a){a*=.5;var r=t[0],n=t[1],o=t[2],i=t[3],s=Math.sin(a),l=Math.cos(a);return e[0]=r*l+n*s,e[1]=n*l-r*s,e[2]=o*l+i*s,e[3]=i*l-o*s,e}function De(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=Math.sqrt(a*a+r*r+n*n),s=Math.exp(o),l=0<i?s*Math.sin(i)/i:0;return e[0]=a*l,e[1]=r*l,e[2]=n*l,e[3]=s*Math.cos(i),e}function Le(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=Math.sqrt(a*a+r*r+n*n),s=0<i?Math.atan2(i,o)/i:0;return e[0]=a*s,e[1]=r*s,e[2]=n*s,e[3]=.5*Math.log(a*a+r*r+n*n+o*o),e}function xe(e,t,a,r){var n,o,i,s,l,c=t[0],u=t[1],d=t[2],m=t[3],f=a[0],p=a[1],h=a[2],v=a[3];return(o=c*f+u*p+d*h+m*v)<0&&(o=-o,f=-f,p=-p,h=-h,v=-v),l=1e-6<1-o?(n=Math.acos(o),i=Math.sin(n),s=Math.sin((1-r)*n)/i,Math.sin(r*n)/i):(s=1-r,r),e[0]=s*c+l*f,e[1]=s*u+l*p,e[2]=s*d+l*h,e[3]=s*m+l*v,e}function Ue(e,t){var a,r=t[0]+t[4]+t[8];if(0<r)a=Math.sqrt(r+1),e[3]=.5*a,a=.5/a,e[0]=(t[5]-t[7])*a,e[1]=(t[6]-t[2])*a,e[2]=(t[1]-t[3])*a;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var o=(n+1)%3,i=(n+2)%3;a=Math.sqrt(t[3*n+n]-t[3*o+o]-t[3*i+i]+1),e[n]=.5*a,a=.5/a,e[3]=(t[3*o+i]-t[3*i+o])*a,e[o]=(t[3*o+n]+t[3*n+o])*a,e[i]=(t[3*i+n]+t[3*n+i])*a}return e}var He,ze,je,Be,Fe,We,Ge=ee,Ye=te,qe=ae,Ve=re,Ke=ne,Ze=Ie,$e=le,Je=pe,Xe=he,Qe=de,et=Qe,tt=me,at=tt,rt=fe,nt=ve,ot=ge,it=(He=k(),ze=N(1,0,0),je=N(0,1,0),function(e,t,a){var r=B(t,a);return r<-.999999?(F(He,ze,t),Z(He)<1e-6&&F(He,je,t),j(He,He),Re(e,He,Math.PI),e):.999999<r?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(F(He,t,a),e[0]=He[0],e[1]=He[1],e[2]=He[2],e[3]=1+r,rt(e,e))}),st=(Be=Me(),Fe=Me(),function(e,t,a,r,n,o){return xe(Be,t,n,o),xe(Fe,a,r,o),xe(e,Be,Fe,2*o*(1-o)),e}),lt=(We=p(),function(e,t,a,r){return We[0]=a[0],We[3]=a[1],We[6]=a[2],We[1]=r[0],We[4]=r[1],We[7]=r[2],We[2]=-t[0],We[5]=-t[1],We[8]=-t[2],rt(e,Ue(e,We))}),ct=Object.freeze({__proto__:null,create:Me,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:Re,getAxisAngle:function(e,t){var a=2*Math.acos(t[3]),r=Math.sin(a/2);return e[2]=1e-6<r?(e[0]=t[0]/r,e[1]=t[1]/r,t[2]/r):(e[0]=1,e[1]=0),a},getAngle:function(e,t){var a=Je(e,t);return Math.acos(2*a*a-1)},multiply:Ie,rotateX:ke,rotateY:Oe,rotateZ:Ne,calculateW:function(e,t){var a=t[0],r=t[1],n=t[2];return e[0]=a,e[1]=r,e[2]=n,e[3]=Math.sqrt(Math.abs(1-a*a-r*r-n*n)),e},exp:De,ln:Le,pow:function(e,t,a){return Le(e,t),$e(e,e,a),De(e,e),e},slerp:xe,random:function(e){var t=c(),a=c(),r=c(),n=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*a),e[1]=n*Math.cos(2*Math.PI*a),e[2]=o*Math.sin(2*Math.PI*r),e[3]=o*Math.cos(2*Math.PI*r),e},invert:function(e,t){var a=t[0],r=t[1],n=t[2],o=t[3],i=a*a+r*r+n*n+o*o,s=i?1/i:0;return e[0]=-a*s,e[1]=-r*s,e[2]=-n*s,e[3]=o*s,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},fromMat3:Ue,fromEuler:function(e,t,a,r){var n=.5*Math.PI/180;t*=n,a*=n,r*=n;var o=Math.sin(t),i=Math.cos(t),s=Math.sin(a),l=Math.cos(a),c=Math.sin(r),u=Math.cos(r);return e[0]=o*l*u-i*s*c,e[1]=i*s*u+o*l*c,e[2]=i*l*c-o*s*u,e[3]=i*l*u+o*s*c,e},str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},clone:Ge,fromValues:Ye,copy:qe,set:Ve,add:Ke,mul:Ze,scale:$e,dot:Je,lerp:Xe,length:Qe,len:et,squaredLength:tt,sqrLen:at,normalize:rt,exactEquals:nt,equals:ot,rotationTo:it,sqlerp:st,setAxes:lt});function ut(e,t,a){var r=.5*a[0],n=.5*a[1],o=.5*a[2],i=t[0],s=t[1],l=t[2],c=t[3];return e[0]=i,e[1]=s,e[2]=l,e[3]=c,e[4]=r*c+n*l-o*s,e[5]=n*c+o*i-r*l,e[6]=o*c+r*s-n*i,e[7]=-r*i-n*s-o*l,e}function dt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}var mt=qe,ft=qe;function pt(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=a[4],l=a[5],c=a[6],u=a[7],d=t[4],m=t[5],f=t[6],p=t[7],h=a[0],v=a[1],g=a[2],C=a[3];return e[0]=r*C+i*h+n*g-o*v,e[1]=n*C+i*v+o*h-r*g,e[2]=o*C+i*g+r*v-n*h,e[3]=i*C-r*h-n*v-o*g,e[4]=r*u+i*s+n*c-o*l+d*C+p*h+m*g-f*v,e[5]=n*u+i*l+o*s-r*c+m*C+p*v+f*h-d*g,e[6]=o*u+i*c+r*l-n*s+f*C+p*g+d*v-m*h,e[7]=i*u-r*s-n*l-o*c+p*C-d*h-m*v-f*g,e}var ht=pt,vt=Je,gt=Qe,Ct=gt,yt=tt,At=yt,_t=Object.freeze({__proto__:null,create:function(){var e=new g(8);return g!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},clone:function(e){var t=new g(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},fromValues:function(e,t,a,r,n,o,i,s){var l=new g(8);return l[0]=e,l[1]=t,l[2]=a,l[3]=r,l[4]=n,l[5]=o,l[6]=i,l[7]=s,l},fromRotationTranslationValues:function(e,t,a,r,n,o,i){var s=new g(8);s[0]=e,s[1]=t,s[2]=a,s[3]=r;var l=.5*n,c=.5*o,u=.5*i;return s[4]=l*r+c*a-u*t,s[5]=c*r+u*e-l*a,s[6]=u*r+l*t-c*e,s[7]=-l*e-c*t-u*a,s},fromRotationTranslation:ut,fromTranslation:function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},fromRotation:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},fromMat4:function(e,t){var a=Me();T(a,t);var r=new g(3);return b(r,t),ut(e,a,r),e},copy:dt,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},set:function(e,t,a,r,n,o,i,s,l){return e[0]=t,e[1]=a,e[2]=r,e[3]=n,e[4]=o,e[5]=i,e[6]=s,e[7]=l,e},getReal:mt,getDual:function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},setReal:ft,setDual:function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},getTranslation:function(e,t){var a=t[4],r=t[5],n=t[6],o=t[7],i=-t[0],s=-t[1],l=-t[2],c=t[3];return e[0]=2*(a*c+o*i+r*l-n*s),e[1]=2*(r*c+o*s+n*i-a*l),e[2]=2*(n*c+o*l+a*s-r*i),e},translate:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=.5*a[0],l=.5*a[1],c=.5*a[2],u=t[4],d=t[5],m=t[6],f=t[7];return e[0]=r,e[1]=n,e[2]=o,e[3]=i,e[4]=i*s+n*c-o*l+u,e[5]=i*l+o*s-r*c+d,e[6]=i*c+r*l-n*s+m,e[7]=-r*s-n*l-o*c+f,e},rotateX:function(e,t,a){var r=-t[0],n=-t[1],o=-t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=s*i+u*r+l*o-c*n,m=l*i+u*n+c*r-s*o,f=c*i+u*o+s*n-l*r,p=u*i-s*r-l*n-c*o;return ke(e,t,a),r=e[0],n=e[1],o=e[2],i=e[3],e[4]=d*i+p*r+m*o-f*n,e[5]=m*i+p*n+f*r-d*o,e[6]=f*i+p*o+d*n-m*r,e[7]=p*i-d*r-m*n-f*o,e},rotateY:function(e,t,a){var r=-t[0],n=-t[1],o=-t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=s*i+u*r+l*o-c*n,m=l*i+u*n+c*r-s*o,f=c*i+u*o+s*n-l*r,p=u*i-s*r-l*n-c*o;return Oe(e,t,a),r=e[0],n=e[1],o=e[2],i=e[3],e[4]=d*i+p*r+m*o-f*n,e[5]=m*i+p*n+f*r-d*o,e[6]=f*i+p*o+d*n-m*r,e[7]=p*i-d*r-m*n-f*o,e},rotateZ:function(e,t,a){var r=-t[0],n=-t[1],o=-t[2],i=t[3],s=t[4],l=t[5],c=t[6],u=t[7],d=s*i+u*r+l*o-c*n,m=l*i+u*n+c*r-s*o,f=c*i+u*o+s*n-l*r,p=u*i-s*r-l*n-c*o;return Ne(e,t,a),r=e[0],n=e[1],o=e[2],i=e[3],e[4]=d*i+p*r+m*o-f*n,e[5]=m*i+p*n+f*r-d*o,e[6]=f*i+p*o+d*n-m*r,e[7]=p*i-d*r-m*n-f*o,e},rotateByQuatAppend:function(e,t,a){var r=a[0],n=a[1],o=a[2],i=a[3],s=t[0],l=t[1],c=t[2],u=t[3];return e[0]=s*i+u*r+l*o-c*n,e[1]=l*i+u*n+c*r-s*o,e[2]=c*i+u*o+s*n-l*r,e[3]=u*i-s*r-l*n-c*o,s=t[4],l=t[5],c=t[6],u=t[7],e[4]=s*i+u*r+l*o-c*n,e[5]=l*i+u*n+c*r-s*o,e[6]=c*i+u*o+s*n-l*r,e[7]=u*i-s*r-l*n-c*o,e},rotateByQuatPrepend:function(e,t,a){var r=t[0],n=t[1],o=t[2],i=t[3],s=a[0],l=a[1],c=a[2],u=a[3];return e[0]=r*u+i*s+n*c-o*l,e[1]=n*u+i*l+o*s-r*c,e[2]=o*u+i*c+r*l-n*s,e[3]=i*u-r*s-n*l-o*c,s=a[4],l=a[5],c=a[6],u=a[7],e[4]=r*u+i*s+n*c-o*l,e[5]=n*u+i*l+o*s-r*c,e[6]=o*u+i*c+r*l-n*s,e[7]=i*u-r*s-n*l-o*c,e},rotateAroundAxis:function(e,t,a,r){if(Math.abs(r)<1e-6)return dt(e,t);var n=Math.hypot(a[0],a[1],a[2]);r*=.5;var o=Math.sin(r),i=o*a[0]/n,s=o*a[1]/n,l=o*a[2]/n,c=Math.cos(r),u=t[0],d=t[1],m=t[2],f=t[3];e[0]=u*c+f*i+d*l-m*s,e[1]=d*c+f*s+m*i-u*l,e[2]=m*c+f*l+u*s-d*i,e[3]=f*c-u*i-d*s-m*l;var p=t[4],h=t[5],v=t[6],g=t[7];return e[4]=p*c+g*i+h*l-v*s,e[5]=h*c+g*s+v*i-p*l,e[6]=v*c+g*l+p*s-h*i,e[7]=g*c-p*i-h*s-v*l,e},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],e[3]=t[3]+a[3],e[4]=t[4]+a[4],e[5]=t[5]+a[5],e[6]=t[6]+a[6],e[7]=t[7]+a[7],e},multiply:pt,mul:ht,scale:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e},dot:vt,lerp:function(e,t,a,r){var n=1-r;return vt(t,a)<0&&(r=-r),e[0]=t[0]*n+a[0]*r,e[1]=t[1]*n+a[1]*r,e[2]=t[2]*n+a[2]*r,e[3]=t[3]*n+a[3]*r,e[4]=t[4]*n+a[4]*r,e[5]=t[5]*n+a[5]*r,e[6]=t[6]*n+a[6]*r,e[7]=t[7]*n+a[7]*r,e},invert:function(e,t){var a=yt(t);return e[0]=-t[0]/a,e[1]=-t[1]/a,e[2]=-t[2]/a,e[3]=t[3]/a,e[4]=-t[4]/a,e[5]=-t[5]/a,e[6]=-t[6]/a,e[7]=t[7]/a,e},conjugate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},length:gt,len:Ct,squaredLength:yt,sqrLen:At,normalize:function(e,t){var a=yt(t);if(0<a){a=Math.sqrt(a);var r=t[0]/a,n=t[1]/a,o=t[2]/a,i=t[3]/a,s=t[4],l=t[5],c=t[6],u=t[7],d=r*s+n*l+o*c+i*u;e[0]=r,e[1]=n,e[2]=o,e[3]=i,e[4]=(s-r*d)/a,e[5]=(l-n*d)/a,e[6]=(c-o*d)/a,e[7]=(u-i*d)/a}return e},str:function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},equals:function(e,t){var a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=t[0],d=t[1],m=t[2],f=t[3],p=t[4],h=t[5],v=t[6],g=t[7];return Math.abs(a-u)<=1e-6*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-d)<=1e-6*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-m)<=1e-6*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(o-f)<=1e-6*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-p)<=1e-6*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(s-h)<=1e-6*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(l-v)<=1e-6*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-g)<=1e-6*Math.max(1,Math.abs(c),Math.abs(g))}});function Et(){var e=new g(2);return g!=Float32Array&&(e[0]=0,e[1]=0),e}function Pt(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e}function bt(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e}function St(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e}function Tt(e,t){var a=t[0]-e[0],r=t[1]-e[1];return Math.hypot(a,r)}function wt(e,t){var a=t[0]-e[0],r=t[1]-e[1];return a*a+r*r}function Mt(e){var t=e[0],a=e[1];return Math.hypot(t,a)}function Rt(e){var t=e[0],a=e[1];return t*t+a*a}var It,kt=Mt,Ot=Pt,Nt=bt,Dt=St,Lt=Tt,xt=wt,Ut=Rt,Ht=(It=Et(),function(e,t,a,r,n,o){var i,s;for(t||(t=2),a||(a=0),s=r?Math.min(r*t+a,e.length):e.length,i=a;i<s;i+=t)It[0]=e[i],It[1]=e[i+1],n(It,It,o),e[i]=It[0],e[i+1]=It[1];return e}),zt=Object.freeze({__proto__:null,create:Et,clone:function(e){var t=new g(2);return t[0]=e[0],t[1]=e[1],t},fromValues:function(e,t){var a=new g(2);return a[0]=e,a[1]=t,a},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e},set:function(e,t,a){return e[0]=t,e[1]=a,e},add:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e},subtract:Pt,multiply:bt,divide:St,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:function(e,t,a){return e[0]=Math.min(t[0],a[0]),e[1]=Math.min(t[1],a[1]),e},max:function(e,t,a){return e[0]=Math.max(t[0],a[0]),e[1]=Math.max(t[1],a[1]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:function(e,t,a){return e[0]=t[0]*a,e[1]=t[1]*a,e},scaleAndAdd:function(e,t,a,r){return e[0]=t[0]+a[0]*r,e[1]=t[1]+a[1]*r,e},distance:Tt,squaredDistance:wt,length:Mt,squaredLength:Rt,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:function(e,t){var a=t[0],r=t[1],n=a*a+r*r;return 0<n&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},cross:function(e,t,a){var r=t[0]*a[1]-t[1]*a[0];return e[0]=e[1]=0,e[2]=r,e},lerp:function(e,t,a,r){var n=t[0],o=t[1];return e[0]=n+r*(a[0]-n),e[1]=o+r*(a[1]-o),e},random:function(e,t){t=t||1;var a=2*c()*Math.PI;return e[0]=Math.cos(a)*t,e[1]=Math.sin(a)*t,e},transformMat2:function(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[2]*n,e[1]=a[1]*r+a[3]*n,e},transformMat2d:function(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[2]*n+a[4],e[1]=a[1]*r+a[3]*n+a[5],e},transformMat3:function(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[3]*n+a[6],e[1]=a[1]*r+a[4]*n+a[7],e},transformMat4:function(e,t,a){var r=t[0],n=t[1];return e[0]=a[0]*r+a[4]*n+a[12],e[1]=a[1]*r+a[5]*n+a[13],e},rotate:function(e,t,a,r){var n=t[0]-a[0],o=t[1]-a[1],i=Math.sin(r),s=Math.cos(r);return e[0]=n*s-o*i+a[0],e[1]=n*i+o*s+a[1],e},angle:function(e,t){var a=e[0],r=e[1],n=t[0],o=t[1],i=Math.sqrt(a*a+r*r)*Math.sqrt(n*n+o*o),s=i&&(a*n+r*o)/i;return Math.acos(Math.min(Math.max(s,-1),1))},zero:function(e){return e[0]=0,e[1]=0,e},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]},equals:function(e,t){var a=e[0],r=e[1],n=t[0],o=t[1];return Math.abs(a-n)<=1e-6*Math.max(1,Math.abs(a),Math.abs(n))&&Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))},len:kt,sub:Ot,mul:Nt,div:Dt,dist:Lt,sqrDist:xt,sqrLen:Ut,forEach:Ht});e.glMatrix=a,e.mat2=s,e.mat2d=f,e.mat3=A,e.mat4=I,e.quat=ct,e.quat2=_t,e.vec2=zt,e.vec3=X,e.vec4=we,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";var e,n;function y(){return e.apply(null,arguments)}function u(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function d(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function m(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;for(var t in e)if(A(e,t))return;return 1}function f(e){return void 0===e}function p(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function v(e,t){for(var a=[],r=0;r<e.length;++r)a.push(t(e[r],r));return a}function g(e,t){for(var a in t)A(t,a)&&(e[a]=t[a]);return A(t,"toString")&&(e.toString=t.toString),A(t,"valueOf")&&(e.valueOf=t.valueOf),e}function C(e,t,a,r){return St(e,t,a,r,!0).utc()}function _(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function E(e){if(null==e._isValid){var t=_(e),a=n.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&a);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function P(e){var t=C(NaN);return null!=e?g(_(t),e):_(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),a=t.length>>>0,r=0;r<a;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var o=y.momentProperties=[],t=!1;function b(e,t){var a,r,n;if(f(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),f(t._i)||(e._i=t._i),f(t._f)||(e._f=t._f),f(t._l)||(e._l=t._l),f(t._strict)||(e._strict=t._strict),f(t._tzm)||(e._tzm=t._tzm),f(t._isUTC)||(e._isUTC=t._isUTC),f(t._offset)||(e._offset=t._offset),f(t._pf)||(e._pf=_(t)),f(t._locale)||(e._locale=t._locale),0<o.length)for(a=0;a<o.length;a++)f(n=t[r=o[a]])||(e[r]=n);return e}function S(e){b(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,y.updateOffset(this),t=!1)}function T(e){return e instanceof S||null!=e&&null!=e._isAMomentObject}function s(e){!1===y.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function a(n,o){var i=!0;return g(function(){if(null!=y.deprecationHandler&&y.deprecationHandler(null,n),i){for(var e,t,a=[],r=0;r<arguments.length;r++){if(e="","object"==typeof arguments[r]){for(t in e+="\n["+r+"] ",arguments[0])A(arguments[0],t)&&(e+=t+": "+arguments[0][t]+", ");e=e.slice(0,-2)}else e=arguments[r];a.push(e)}s(n+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),i=!1}return o.apply(this,arguments)},o)}var r,i={};function l(e,t){null!=y.deprecationHandler&&y.deprecationHandler(e,t),i[e]||(s(t),i[e]=!0)}function w(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function c(e,t){var a,r=g({},e);for(a in t)A(t,a)&&(d(e[a])&&d(t[a])?(r[a]={},g(r[a],e[a]),g(r[a],t[a])):null!=t[a]?r[a]=t[a]:delete r[a]);for(a in e)A(e,a)&&!A(t,a)&&d(e[a])&&(r[a]=g({},r[a]));return r}function M(e){null!=e&&this.set(e)}function R(e,t,a){var r=""+Math.abs(e),n=t-r.length;return(0<=e?a?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+r}y.suppressDeprecationWarnings=!1,y.deprecationHandler=null,r=Object.keys?Object.keys:function(e){var t,a=[];for(t in e)A(e,t)&&a.push(t);return a};var I=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,k=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,O={},N={};function D(e,t,a,r){var n="string"==typeof r?function(){return this[r]()}:r;e&&(N[e]=n),t&&(N[t[0]]=function(){return R(n.apply(this,arguments),t[1],t[2])}),a&&(N[a]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function L(e,t){return e.isValid()?(t=x(t,e.localeData()),O[t]=O[t]||function(r){for(var e,n=r.match(I),t=0,o=n.length;t<o;t++)N[n[t]]?n[t]=N[n[t]]:n[t]=(e=n[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(e){for(var t="",a=0;a<o;a++)t+=w(n[a])?n[a].call(e,r):n[a];return t}}(t),O[t](e)):e.localeData().invalidDate()}function x(e,t){var a=5;function r(e){return t.longDateFormat(e)||e}for(k.lastIndex=0;0<=a&&k.test(e);)e=e.replace(k,r),k.lastIndex=0,--a;return e}var U={};function H(e,t){var a=e.toLowerCase();U[a]=U[a+"s"]=U[t]=e}function z(e){return"string"==typeof e?U[e]||U[e.toLowerCase()]:void 0}function j(e){var t,a,r={};for(a in e)A(e,a)&&(t=z(a))&&(r[t]=e[a]);return r}var B={};function F(e,t){B[e]=t}function W(e){return e%4==0&&e%100!=0||e%400==0}function G(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Y(e){var t=+e,a=0;return 0!=t&&isFinite(t)&&(a=G(t)),a}function q(t,a){return function(e){return null!=e?(K(this,t,e),y.updateOffset(this,a),this):V(this,t)}}function V(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function K(e,t,a){e.isValid()&&!isNaN(a)&&("FullYear"===t&&W(e.year())&&1===e.month()&&29===e.date()?(a=Y(a),e._d["set"+(e._isUTC?"UTC":"")+t](a,e.month(),we(a,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](a))}var Z,$=/\d/,J=/\d\d/,X=/\d{3}/,Q=/\d{4}/,ee=/[+-]?\d{6}/,te=/\d\d?/,ae=/\d\d\d\d?/,re=/\d\d\d\d\d\d?/,ne=/\d{1,3}/,oe=/\d{1,4}/,ie=/[+-]?\d{1,6}/,se=/\d+/,le=/[+-]?\d+/,ce=/Z|[+-]\d\d:?\d\d/gi,ue=/Z|[+-]\d\d(?::?\d\d)?/gi,de=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function me(e,a,r){Z[e]=w(a)?a:function(e,t){return e&&r?r:a}}function fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}Z={};var pe={};function he(e,a){var t,r=a;for("string"==typeof e&&(e=[e]),p(a)&&(r=function(e,t){t[a]=Y(e)}),t=0;t<e.length;t++)pe[e[t]]=r}function ve(e,n){he(e,function(e,t,a,r){a._w=a._w||{},n(e,a._w,a,r)})}var ge,Ce=0,ye=1,Ae=2,_e=3,Ee=4,Pe=5,be=6,Se=7,Te=8;function we(e,t){if(isNaN(e)||isNaN(t))return NaN;var a=(t%12+12)%12;return e+=(t-a)/12,1==a?W(e)?29:28:31-a%7%2}ge=Array.prototype.indexOf?Array.prototype.indexOf:function(e){for(var t=0;t<this.length;++t)if(this[t]===e)return t;return-1},D("M",["MM",2],"Mo",function(){return this.month()+1}),D("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),D("MMMM",0,0,function(e){return this.localeData().months(this,e)}),H("month","M"),F("month",8),me("M",te),me("MM",te,J),me("MMM",function(e,t){return t.monthsShortRegex(e)}),me("MMMM",function(e,t){return t.monthsRegex(e)}),he(["M","MM"],function(e,t){t[ye]=Y(e)-1}),he(["MMM","MMMM"],function(e,t,a,r){var n=a._locale.monthsParse(e,r,a._strict);null!=n?t[ye]=n:_(a).invalidMonth=e});var Me="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Re="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ie=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ke=de,Oe=de;function Ne(e,t){var a;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=Y(t);else if(!p(t=e.localeData().monthsParse(t)))return e;return a=Math.min(e.date(),we(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,a),e}function De(e){return null!=e?(Ne(this,e),y.updateOffset(this,!0),this):V(this,"Month")}function Le(){function e(e,t){return t.length-e.length}for(var t,a=[],r=[],n=[],o=0;o<12;o++)t=C([2e3,o]),a.push(this.monthsShort(t,"")),r.push(this.months(t,"")),n.push(this.months(t,"")),n.push(this.monthsShort(t,""));for(a.sort(e),r.sort(e),n.sort(e),o=0;o<12;o++)a[o]=fe(a[o]),r[o]=fe(r[o]);for(o=0;o<24;o++)n[o]=fe(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+a.join("|")+")","i")}function xe(e){return W(e)?366:365}D("Y",0,0,function(){var e=this.year();return e<=9999?R(e,4):"+"+e}),D(0,["YY",2],0,function(){return this.year()%100}),D(0,["YYYY",4],0,"year"),D(0,["YYYYY",5],0,"year"),D(0,["YYYYYY",6,!0],0,"year"),H("year","y"),F("year",1),me("Y",le),me("YY",te,J),me("YYYY",oe,Q),me("YYYYY",ie,ee),me("YYYYYY",ie,ee),he(["YYYYY","YYYYYY"],Ce),he("YYYY",function(e,t){t[Ce]=2===e.length?y.parseTwoDigitYear(e):Y(e)}),he("YY",function(e,t){t[Ce]=y.parseTwoDigitYear(e)}),he("Y",function(e,t){t[Ce]=parseInt(e,10)}),y.parseTwoDigitYear=function(e){return Y(e)+(68<Y(e)?1900:2e3)};var Ue=q("FullYear",!0);function He(e){var t,a;return e<100&&0<=e?((a=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,a)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function ze(e,t,a){var r=7+t-a;return r-(7+He(e,0,r).getUTCDay()-t)%7-1}function je(e,t,a,r,n){var o,i=1+7*(t-1)+(7+a-r)%7+ze(e,r,n),s=i<=0?xe(o=e-1)+i:i>xe(e)?(o=e+1,i-xe(e)):(o=e,i);return{year:o,dayOfYear:s}}function Be(e,t,a){var r,n,o=ze(e.year(),t,a),i=Math.floor((e.dayOfYear()-o-1)/7)+1;return i<1?r=i+Fe(n=e.year()-1,t,a):i>Fe(e.year(),t,a)?(r=i-Fe(e.year(),t,a),n=e.year()+1):(n=e.year(),r=i),{week:r,year:n}}function Fe(e,t,a){var r=ze(e,t,a),n=ze(e+1,t,a);return(xe(e)-r+n)/7}function We(e,t){return e.slice(t,7).concat(e.slice(0,t))}D("w",["ww",2],"wo","week"),D("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),F("week",5),F("isoWeek",5),me("w",te),me("ww",te,J),me("W",te),me("WW",te,J),ve(["w","ww","W","WW"],function(e,t,a,r){t[r.substr(0,1)]=Y(e)}),D("d",0,"do","day"),D("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),D("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),D("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),D("e",0,0,"weekday"),D("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),F("day",11),F("weekday",11),F("isoWeekday",11),me("d",te),me("e",te),me("E",te),me("dd",function(e,t){return t.weekdaysMinRegex(e)}),me("ddd",function(e,t){return t.weekdaysShortRegex(e)}),me("dddd",function(e,t){return t.weekdaysRegex(e)}),ve(["dd","ddd","dddd"],function(e,t,a,r){var n=a._locale.weekdaysParse(e,r,a._strict);null!=n?t.d=n:_(a).invalidWeekday=e}),ve(["d","e","E"],function(e,t,a,r){t[r]=Y(e)});var Ge="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ye="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ve=de,Ke=de,Ze=de;function $e(){function e(e,t){return t.length-e.length}for(var t,a,r,n,o=[],i=[],s=[],l=[],c=0;c<7;c++)t=C([2e3,1]).day(c),a=fe(this.weekdaysMin(t,"")),r=fe(this.weekdaysShort(t,"")),n=fe(this.weekdays(t,"")),o.push(a),i.push(r),s.push(n),l.push(a),l.push(r),l.push(n);o.sort(e),i.sort(e),s.sort(e),l.sort(e),this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Je(){return this.hours()%12||12}function Xe(e,t){D(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Qe(e,t){return t._meridiemParse}D("H",["HH",2],0,"hour"),D("h",["hh",2],0,Je),D("k",["kk",2],0,function(){return this.hours()||24}),D("hmm",0,0,function(){return""+Je.apply(this)+R(this.minutes(),2)}),D("hmmss",0,0,function(){return""+Je.apply(this)+R(this.minutes(),2)+R(this.seconds(),2)}),D("Hmm",0,0,function(){return""+this.hours()+R(this.minutes(),2)}),D("Hmmss",0,0,function(){return""+this.hours()+R(this.minutes(),2)+R(this.seconds(),2)}),Xe("a",!0),Xe("A",!1),H("hour","h"),F("hour",13),me("a",Qe),me("A",Qe),me("H",te),me("h",te),me("k",te),me("HH",te,J),me("hh",te,J),me("kk",te,J),me("hmm",ae),me("hmmss",re),me("Hmm",ae),me("Hmmss",re),he(["H","HH"],_e),he(["k","kk"],function(e,t,a){var r=Y(e);t[_e]=24===r?0:r}),he(["a","A"],function(e,t,a){a._isPm=a._locale.isPM(e),a._meridiem=e}),he(["h","hh"],function(e,t,a){t[_e]=Y(e),_(a).bigHour=!0}),he("hmm",function(e,t,a){var r=e.length-2;t[_e]=Y(e.substr(0,r)),t[Ee]=Y(e.substr(r)),_(a).bigHour=!0}),he("hmmss",function(e,t,a){var r=e.length-4,n=e.length-2;t[_e]=Y(e.substr(0,r)),t[Ee]=Y(e.substr(r,2)),t[Pe]=Y(e.substr(n)),_(a).bigHour=!0}),he("Hmm",function(e,t,a){var r=e.length-2;t[_e]=Y(e.substr(0,r)),t[Ee]=Y(e.substr(r))}),he("Hmmss",function(e,t,a){var r=e.length-4,n=e.length-2;t[_e]=Y(e.substr(0,r)),t[Ee]=Y(e.substr(r,2)),t[Pe]=Y(e.substr(n))});var et,tt=q("Hours",!0),at={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Me,monthsShort:Re,week:{dow:0,doy:6},weekdays:Ge,weekdaysMin:qe,weekdaysShort:Ye,meridiemParse:/[ap]\.?m?\.?/i},rt={},nt={};function ot(e){return e?e.toLowerCase().replace("_","-"):e}function it(e){var t;if(void 0===rt[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),st(t)}catch(t){rt[e]=null}return rt[e]}function st(e,t){var a;return e&&((a=f(t)?ct(e):lt(e,t))?et=a:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function lt(e,t){if(null===t)return delete rt[e],null;var a,r=at;if(t.abbr=e,null!=rt[e])l("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=rt[e]._config;else if(null!=t.parentLocale)if(null!=rt[t.parentLocale])r=rt[t.parentLocale]._config;else{if(null==(a=it(t.parentLocale)))return nt[t.parentLocale]||(nt[t.parentLocale]=[]),nt[t.parentLocale].push({name:e,config:t}),null;r=a._config}return rt[e]=new M(c(r,t)),nt[e]&&nt[e].forEach(function(e){lt(e.name,e.config)}),st(e),rt[e]}function ct(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!u(e)){if(t=it(e))return t;e=[e]}return function(e){for(var t,a,r,n,o=0;o<e.length;){for(t=(n=ot(e[o]).split("-")).length,a=(a=ot(e[o+1]))?a.split("-"):null;0<t;){if(r=it(n.slice(0,t).join("-")))return r;if(a&&a.length>=t&&function(e,t){for(var a=Math.min(e.length,t.length),r=0;r<a;r+=1)if(e[r]!==t[r])return r;return a}(n,a)>=t-1)break;t--}o++}return et}(e)}function ut(e){var t,a=e._a;return a&&-2===_(e).overflow&&(t=a[ye]<0||11<a[ye]?ye:a[Ae]<1||a[Ae]>we(a[Ce],a[ye])?Ae:a[_e]<0||24<a[_e]||24===a[_e]&&(0!==a[Ee]||0!==a[Pe]||0!==a[be])?_e:a[Ee]<0||59<a[Ee]?Ee:a[Pe]<0||59<a[Pe]?Pe:a[be]<0||999<a[be]?be:-1,_(e)._overflowDayOfYear&&(t<Ce||Ae<t)&&(t=Ae),_(e)._overflowWeeks&&-1===t&&(t=Se),_(e)._overflowWeekday&&-1===t&&(t=Te),_(e).overflow=t),e}var dt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ft=/Z|[+-]\d\d(?::?\d\d)?/,pt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ht=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vt=/^\/?Date\((-?\d+)/i,gt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ct={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function yt(e){var t,a,r,n,o,i,s=e._i,l=dt.exec(s)||mt.exec(s);if(l){for(_(e).iso=!0,t=0,a=pt.length;t<a;t++)if(pt[t][1].exec(l[1])){n=pt[t][0],r=!1!==pt[t][2];break}if(null==n)return void(e._isValid=!1);if(l[3]){for(t=0,a=ht.length;t<a;t++)if(ht[t][1].exec(l[3])){o=(l[2]||" ")+ht[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(l[4]){if(!ft.exec(l[4]))return void(e._isValid=!1);i="Z"}e._f=n+(o||"")+(i||""),Pt(e)}else e._isValid=!1}function At(e){var t,a,r,n,o,i,s,l,c,u,d,m,f=gt.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(f){if(o=f[4],i=f[3],s=f[2],l=f[5],c=f[6],u=f[7],m=[(d=parseInt(o,10),d<=49?2e3+d:d<=999?1900+d:d),Re.indexOf(i),parseInt(s,10),parseInt(l,10),parseInt(c,10)],u&&m.push(parseInt(u,10)),r=t=m,n=e,(a=f[1])&&Ye.indexOf(a)!==new Date(r[0],r[1],r[2]).getDay()&&(_(n).weekdayMismatch=!0,!void(n._isValid=!1)))return;e._a=t,e._tzm=function(e,t,a){if(e)return Ct[e];if(t)return 0;var r=parseInt(a,10),n=r%100;return(r-n)/100*60+n}(f[8],f[9],f[10]),e._d=He.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),_(e).rfc2822=!0}else e._isValid=!1}function _t(e,t,a){return null!=e?e:null!=t?t:a}function Et(e){var t,a,r,n,o,i,s,l,c,u,d,m,f,p,h,v,g,C=[];if(!e._d){for(i=e,s=new Date(y.now()),r=i._useUTC?[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()]:[s.getFullYear(),s.getMonth(),s.getDate()],e._w&&null==e._a[Ae]&&null==e._a[ye]&&(g=v=h=p=f=m=d=u=c=void 0,null!=(c=(l=e)._w).GG||null!=c.W||null!=c.E?(f=1,p=4,u=_t(c.GG,l._a[Ce],Be(Tt(),1,4).year),d=_t(c.W,1),((m=_t(c.E,1))<1||7<m)&&(v=!0)):(f=l._locale._week.dow,p=l._locale._week.doy,g=Be(Tt(),f,p),u=_t(c.gg,l._a[Ce],g.year),d=_t(c.w,g.week),null!=c.d?((m=c.d)<0||6<m)&&(v=!0):null!=c.e?(m=c.e+f,(c.e<0||6<c.e)&&(v=!0)):m=f),d<1||d>Fe(u,f,p)?_(l)._overflowWeeks=!0:null!=v?_(l)._overflowWeekday=!0:(h=je(u,d,m,f,p),l._a[Ce]=h.year,l._dayOfYear=h.dayOfYear)),null!=e._dayOfYear&&(o=_t(e._a[Ce],r[Ce]),(e._dayOfYear>xe(o)||0===e._dayOfYear)&&(_(e)._overflowDayOfYear=!0),a=He(o,0,e._dayOfYear),e._a[ye]=a.getUTCMonth(),e._a[Ae]=a.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=C[t]=r[t];for(;t<7;t++)e._a[t]=C[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[_e]&&0===e._a[Ee]&&0===e._a[Pe]&&0===e._a[be]&&(e._nextDay=!0,e._a[_e]=0),e._d=(e._useUTC?He:function(e,t,a,r,n,o,i){var s;return e<100&&0<=e?(s=new Date(e+400,t,a,r,n,o,i),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,a,r,n,o,i),s}).apply(null,C),n=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[_e]=24),e._w&&void 0!==e._w.d&&e._w.d!==n&&(_(e).weekdayMismatch=!0)}}function Pt(e){if(e._f!==y.ISO_8601)if(e._f!==y.RFC_2822){e._a=[],_(e).empty=!0;for(var t,a,r,n,o,i,s,l=""+e._i,c=l.length,u=0,d=x(e._f,e._locale).match(I)||[],m=0;m<d.length;m++)a=d[m],(t=(l.match((g=a,C=e,A(Z,g)?Z[g](C._strict,C._locale):new RegExp(fe(g.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,a,r,n){return t||a||r||n})))))||[])[0])&&(0<(r=l.substr(0,l.indexOf(t))).length&&_(e).unusedInput.push(r),l=l.slice(l.indexOf(t)+t.length),u+=t.length),N[a]?(t?_(e).empty=!1:_(e).unusedTokens.push(a),o=a,s=e,null!=(i=t)&&A(pe,o)&&pe[o](i,s._a,s,o)):e._strict&&!t&&_(e).unusedTokens.push(a);_(e).charsLeftOver=c-u,0<l.length&&_(e).unusedInput.push(l),e._a[_e]<=12&&!0===_(e).bigHour&&0<e._a[_e]&&(_(e).bigHour=void 0),_(e).parsedDateParts=e._a.slice(0),_(e).meridiem=e._meridiem,e._a[_e]=(f=e._locale,p=e._a[_e],null==(h=e._meridiem)?p:null!=f.meridiemHour?f.meridiemHour(p,h):(null!=f.isPM&&((v=f.isPM(h))&&p<12&&(p+=12),v||12!==p||(p=0)),p)),null!==(n=_(e).era)&&(e._a[Ce]=e._locale.erasConvertYear(n,e._a[Ce])),Et(e),ut(e)}else At(e);else yt(e);var f,p,h,v,g,C}function bt(e){var t,a,r,n,o,i,s,l=e._i,c=e._f;return e._locale=e._locale||ct(e._l),null===l||void 0===c&&""===l?P({nullInput:!0}):("string"==typeof l&&(e._i=l=e._locale.preparse(l)),T(l)?new S(ut(l)):(h(l)?e._d=l:u(c)?function(e){var t,a,r,n,o,i,s=!1;if(0===e._f.length)return _(e).invalidFormat=!0,e._d=new Date(NaN);for(n=0;n<e._f.length;n++)o=0,i=!1,t=b({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[n],Pt(t),E(t)&&(i=!0),o+=_(t).charsLeftOver,o+=10*_(t).unusedTokens.length,_(t).score=o,s?o<r&&(r=o,a=t):(null==r||o<r||i)&&(r=o,a=t,i&&(s=!0));g(e,a||t)}(e):c?Pt(e):f(a=(t=e)._i)?t._d=new Date(y.now()):h(a)?t._d=new Date(a.valueOf()):"string"==typeof a?(i=t,null===(s=vt.exec(i._i))?(yt(i),!1===i._isValid&&(delete i._isValid,At(i),!1===i._isValid&&(delete i._isValid,i._strict?i._isValid=!1:y.createFromInputFallback(i)))):i._d=new Date(+s[1])):u(a)?(t._a=v(a.slice(0),function(e){return parseInt(e,10)}),Et(t)):d(a)?(r=t)._d||(o=void 0===(n=j(r._i)).day?n.date:n.day,r._a=v([n.year,n.month,o,n.hour,n.minute,n.second,n.millisecond],function(e){return e&&parseInt(e,10)}),Et(r)):p(a)?t._d=new Date(a):y.createFromInputFallback(t),E(e)||(e._d=null),e))}function St(e,t,a,r,n){var o,i={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==a&&!1!==a||(r=a,a=void 0),(d(e)&&m(e)||u(e)&&0===e.length)&&(e=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=n,i._l=a,i._i=e,i._f=t,i._strict=r,(o=new S(ut(bt(i))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function Tt(e,t,a,r){return St(e,t,a,r,!1)}y.createFromInputFallback=a("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),y.ISO_8601=function(){},y.RFC_2822=function(){};var wt=a("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:P()}),Mt=a("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Tt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:P()});function Rt(e,t){var a,r;if(1===t.length&&u(t[0])&&(t=t[0]),!t.length)return Tt();for(a=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](a)||(a=t[r]);return a}var It=["year","quarter","month","week","day","hour","minute","second","millisecond"];function kt(e){var t=j(e),a=t.year||0,r=t.quarter||0,n=t.month||0,o=t.week||t.isoWeek||0,i=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=function(e){var t,a,r=!1;for(t in e)if(A(e,t)&&(-1===ge.call(It,t)||null!=e[t]&&isNaN(e[t])))return!1;for(a=0;a<It.length;++a)if(e[It[a]]){if(r)return!1;parseFloat(e[It[a]])!==Y(e[It[a]])&&(r=!0)}return!0}(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+i+7*o,this._months=+n+3*r+12*a,this._data={},this._locale=ct(),this._bubble()}function Ot(e){return e instanceof kt}function Nt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Dt(e,a){D(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+R(~~(e/60),2)+a+R(~~e%60,2)})}Dt("Z",":"),Dt("ZZ",""),me("Z",ue),me("ZZ",ue),he(["Z","ZZ"],function(e,t,a){a._useUTC=!0,a._tzm=xt(ue,e)});var Lt=/([\+\-]|\d\d)/gi;function xt(e,t){var a,r,n=(t||"").match(e);return null===n?null:0===(r=60*(a=((n[n.length-1]||[])+"").match(Lt)||["-",0,0])[1]+Y(a[2]))?0:"+"===a[0]?r:-r}function Ut(e,t){var a,r;return t._isUTC?(a=t.clone(),r=(T(e)||h(e)?e.valueOf():Tt(e).valueOf())-a.valueOf(),a._d.setTime(a._d.valueOf()+r),y.updateOffset(a,!1),a):Tt(e).local()}function Ht(e){return-Math.round(e._d.getTimezoneOffset())}function zt(){return!!this.isValid()&&this._isUTC&&0===this._offset}y.updateOffset=function(){};var jt=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Bt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ft(e,t){var a,r,n,o,i,s,l=e,c=null;return Ot(e)?l={ms:e._milliseconds,d:e._days,M:e._months}:p(e)||!isNaN(+e)?(l={},t?l[t]=+e:l.milliseconds=+e):(c=jt.exec(e))?(a="-"===c[1]?-1:1,l={y:0,d:Y(c[Ae])*a,h:Y(c[_e])*a,m:Y(c[Ee])*a,s:Y(c[Pe])*a,ms:Y(Nt(1e3*c[be]))*a}):(c=Bt.exec(e))?(a="-"===c[1]?-1:1,l={y:Wt(c[2],a),M:Wt(c[3],a),w:Wt(c[4],a),d:Wt(c[5],a),h:Wt(c[6],a),m:Wt(c[7],a),s:Wt(c[8],a)}):null==l?l={}:"object"==typeof l&&("from"in l||"to"in l)&&(o=Tt(l.from),i=Tt(l.to),n=o.isValid()&&i.isValid()?(i=Ut(i,o),o.isBefore(i)?s=Gt(o,i):((s=Gt(i,o)).milliseconds=-s.milliseconds,s.months=-s.months),s):{milliseconds:0,months:0},(l={}).ms=n.milliseconds,l.M=n.months),r=new kt(l),Ot(e)&&A(e,"_locale")&&(r._locale=e._locale),Ot(e)&&A(e,"_isValid")&&(r._isValid=e._isValid),r}function Wt(e,t){var a=e&&parseFloat(e.replace(",","."));return(isNaN(a)?0:a)*t}function Gt(e,t){var a={};return a.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(a.months,"M").isAfter(t)&&--a.months,a.milliseconds=t-e.clone().add(a.months,"M"),a}function Yt(r,n){return function(e,t){var a;return null===t||isNaN(+t)||(l(n,"moment()."+n+"(period, number) is deprecated. Please use moment()."+n+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),a=e,e=t,t=a),qt(this,Ft(e,t),r),this}}function qt(e,t,a,r){var n=t._milliseconds,o=Nt(t._days),i=Nt(t._months);e.isValid()&&(r=null==r||r,i&&Ne(e,V(e,"Month")+i*a),o&&K(e,"Date",V(e,"Date")+o*a),n&&e._d.setTime(e._d.valueOf()+n*a),r&&y.updateOffset(e,o||i))}Ft.fn=kt.prototype,Ft.invalid=function(){return Ft(NaN)};var Vt=Yt(1,"add"),Kt=Yt(-1,"subtract");function Zt(e){return"string"==typeof e||e instanceof String}function $t(e,t){if(e.date()<t.date())return-$t(t,e);var a=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(a,"months");return-(a+(t-r<0?(t-r)/(r-e.clone().add(a-1,"months")):(t-r)/(e.clone().add(1+a,"months")-r)))||0}function Jt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ct(e))&&(this._locale=t),this)}y.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",y.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xt=a("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Qt(){return this._locale}function ea(e,t){return(e%t+t)%t}function ta(e,t,a){return e<100&&0<=e?new Date(e+400,t,a)-126227808e5:new Date(e,t,a).valueOf()}function aa(e,t,a){return e<100&&0<=e?Date.UTC(e+400,t,a)-126227808e5:Date.UTC(e,t,a)}function ra(e,t){return t.erasAbbrRegex(e)}function na(){for(var e=[],t=[],a=[],r=[],n=this.eras(),o=0,i=n.length;o<i;++o)t.push(fe(n[o].name)),e.push(fe(n[o].abbr)),a.push(fe(n[o].narrow)),r.push(fe(n[o].name)),r.push(fe(n[o].abbr)),r.push(fe(n[o].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}function oa(e,t){D(0,[e,e.length],0,t)}function ia(e,t,a,r,n){var o;return null==e?Be(this,r,n).year:((o=Fe(e,r,n))<t&&(t=o),function(e,t,a,r,n){var o=je(e,t,a,r,n),i=He(o.year,0,o.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}.call(this,e,t,a,r,n))}D("N",0,0,"eraAbbr"),D("NN",0,0,"eraAbbr"),D("NNN",0,0,"eraAbbr"),D("NNNN",0,0,"eraName"),D("NNNNN",0,0,"eraNarrow"),D("y",["y",1],"yo","eraYear"),D("y",["yy",2],0,"eraYear"),D("y",["yyy",3],0,"eraYear"),D("y",["yyyy",4],0,"eraYear"),me("N",ra),me("NN",ra),me("NNN",ra),me("NNNN",function(e,t){return t.erasNameRegex(e)}),me("NNNNN",function(e,t){return t.erasNarrowRegex(e)}),he(["N","NN","NNN","NNNN","NNNNN"],function(e,t,a,r){var n=a._locale.erasParse(e,r,a._strict);n?_(a).era=n:_(a).invalidEra=e}),me("y",se),me("yy",se),me("yyy",se),me("yyyy",se),me("yo",function(e,t){return t._eraYearOrdinalRegex||se}),he(["y","yy","yyy","yyyy"],Ce),he(["yo"],function(e,t,a,r){var n;a._locale._eraYearOrdinalRegex&&(n=e.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?t[Ce]=a._locale.eraYearOrdinalParse(e,n):t[Ce]=parseInt(e,10)}),D(0,["gg",2],0,function(){return this.weekYear()%100}),D(0,["GG",2],0,function(){return this.isoWeekYear()%100}),oa("gggg","weekYear"),oa("ggggg","weekYear"),oa("GGGG","isoWeekYear"),oa("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),F("weekYear",1),F("isoWeekYear",1),me("G",le),me("g",le),me("GG",te,J),me("gg",te,J),me("GGGG",oe,Q),me("gggg",oe,Q),me("GGGGG",ie,ee),me("ggggg",ie,ee),ve(["gggg","ggggg","GGGG","GGGGG"],function(e,t,a,r){t[r.substr(0,2)]=Y(e)}),ve(["gg","GG"],function(e,t,a,r){t[r]=y.parseTwoDigitYear(e)}),D("Q",0,"Qo","quarter"),H("quarter","Q"),F("quarter",7),me("Q",$),he("Q",function(e,t){t[ye]=3*(Y(e)-1)}),D("D",["DD",2],"Do","date"),H("date","D"),F("date",9),me("D",te),me("DD",te,J),me("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),he(["D","DD"],Ae),he("Do",function(e,t){t[Ae]=Y(e.match(te)[0])});var sa=q("Date",!0);D("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),F("dayOfYear",4),me("DDD",ne),me("DDDD",X),he(["DDD","DDDD"],function(e,t,a){a._dayOfYear=Y(e)}),D("m",["mm",2],0,"minute"),H("minute","m"),F("minute",14),me("m",te),me("mm",te,J),he(["m","mm"],Ee);var la=q("Minutes",!1);D("s",["ss",2],0,"second"),H("second","s"),F("second",15),me("s",te),me("ss",te,J),he(["s","ss"],Pe);var ca,ua,da=q("Seconds",!1);for(D("S",0,0,function(){return~~(this.millisecond()/100)}),D(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),D(0,["SSS",3],0,"millisecond"),D(0,["SSSS",4],0,function(){return 10*this.millisecond()}),D(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),D(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),D(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),D(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),D(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),F("millisecond",16),me("S",ne,$),me("SS",ne,J),me("SSS",ne,X),ca="SSSS";ca.length<=9;ca+="S")me(ca,se);function ma(e,t){t[be]=Y(1e3*("0."+e))}for(ca="S";ca.length<=9;ca+="S")he(ca,ma);ua=q("Milliseconds",!1),D("z",0,0,"zoneAbbr"),D("zz",0,0,"zoneName");var fa=S.prototype;function pa(e){return e}fa.add=Vt,fa.calendar=function(e,t){var a,r,n,o;1===arguments.length&&(arguments[0]?T(a=arguments[0])||h(a)||Zt(a)||p(a)||(n=u(r=a),o=!1,n&&(o=0===r.filter(function(e){return!p(e)&&Zt(r)}).length),n&&o)||function(e){var t,a=d(e)&&!m(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(t=0;t<n.length;t+=1)r=r||A(e,n[t]);return a&&r}(a)||null==a?(e=arguments[0],t=void 0):function(e){for(var t=d(e)&&!m(e),a=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n=0;n<r.length;n+=1)a=a||A(e,r[n]);return t&&a}(arguments[0])&&(t=arguments[0],e=void 0):t=e=void 0);var i=e||Tt(),s=Ut(i,this).startOf("day"),l=y.calendarFormat(this,s)||"sameElse",c=t&&(w(t[l])?t[l].call(this,i):t[l]);return this.format(c||this.localeData().calendar(l,this,Tt(i)))},fa.clone=function(){return new S(this)},fa.diff=function(e,t,a){var r,n,o;if(!this.isValid())return NaN;if(!(r=Ut(e,this)).isValid())return NaN;switch(n=6e4*(r.utcOffset()-this.utcOffset()),t=z(t)){case"year":o=$t(this,r)/12;break;case"month":o=$t(this,r);break;case"quarter":o=$t(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-n)/864e5;break;case"week":o=(this-r-n)/6048e5;break;default:o=this-r}return a?o:G(o)},fa.endOf=function(e){var t,a;if(void 0===(e=z(e))||"millisecond"===e||!this.isValid())return this;switch(a=this._isUTC?aa:ta,e){case"year":t=a(this.year()+1,0,1)-1;break;case"quarter":t=a(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=a(this.year(),this.month()+1,1)-1;break;case"week":t=a(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=a(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=36e5-ea(t+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":t=this._d.valueOf(),t+=6e4-ea(t,6e4)-1;break;case"second":t=this._d.valueOf(),t+=1e3-ea(t,1e3)-1}return this._d.setTime(t),y.updateOffset(this,!0),this},fa.format=function(e){var t=L(this,e=e||(this.isUtc()?y.defaultFormatUtc:y.defaultFormat));return this.localeData().postformat(t)},fa.from=function(e,t){return this.isValid()&&(T(e)&&e.isValid()||Tt(e).isValid())?Ft({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},fa.fromNow=function(e){return this.from(Tt(),e)},fa.to=function(e,t){return this.isValid()&&(T(e)&&e.isValid()||Tt(e).isValid())?Ft({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},fa.toNow=function(e){return this.to(Tt(),e)},fa.get=function(e){return w(this[e=z(e)])?this[e]():this},fa.invalidAt=function(){return _(this).overflow},fa.isAfter=function(e,t){var a=T(e)?e:Tt(e);return!(!this.isValid()||!a.isValid())&&("millisecond"===(t=z(t)||"millisecond")?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(t).valueOf())},fa.isBefore=function(e,t){var a=T(e)?e:Tt(e);return!(!this.isValid()||!a.isValid())&&("millisecond"===(t=z(t)||"millisecond")?this.valueOf()<a.valueOf():this.clone().endOf(t).valueOf()<a.valueOf())},fa.isBetween=function(e,t,a,r){var n=T(e)?e:Tt(e),o=T(t)?t:Tt(t);return!!(this.isValid()&&n.isValid()&&o.isValid())&&("("===(r=r||"()")[0]?this.isAfter(n,a):!this.isBefore(n,a))&&(")"===r[1]?this.isBefore(o,a):!this.isAfter(o,a))},fa.isSame=function(e,t){var a,r=T(e)?e:Tt(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=z(t)||"millisecond")?this.valueOf()===r.valueOf():(a=r.valueOf(),this.clone().startOf(t).valueOf()<=a&&a<=this.clone().endOf(t).valueOf()))},fa.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},fa.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},fa.isValid=function(){return E(this)},fa.lang=Xt,fa.locale=Jt,fa.localeData=Qt,fa.max=Mt,fa.min=wt,fa.parsingFlags=function(){return g({},_(this))},fa.set=function(e,t){if("object"==typeof e)for(var a=function(e){var t,a=[];for(t in e)A(e,t)&&a.push({unit:t,priority:B[t]});return a.sort(function(e,t){return e.priority-t.priority}),a}(e=j(e)),r=0;r<a.length;r++)this[a[r].unit](e[a[r].unit]);else if(w(this[e=z(e)]))return this[e](t);return this},fa.startOf=function(e){var t,a;if(void 0===(e=z(e))||"millisecond"===e||!this.isValid())return this;switch(a=this._isUTC?aa:ta,e){case"year":t=a(this.year(),0,1);break;case"quarter":t=a(this.year(),this.month()-this.month()%3,1);break;case"month":t=a(this.year(),this.month(),1);break;case"week":t=a(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=a(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=a(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ea(t+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":t=this._d.valueOf(),t-=ea(t,6e4);break;case"second":t=this._d.valueOf(),t-=ea(t,1e3)}return this._d.setTime(t),y.updateOffset(this,!0),this},fa.subtract=Kt,fa.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},fa.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},fa.toDate=function(){return new Date(this.valueOf())},fa.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,a=t?this.clone().utc():this;return a.year()<0||9999<a.year()?L(a,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):w(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",L(a,"Z")):L(a,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},fa.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,a,r="moment",n="";return this.isLocal()||(r=0===this.utcOffset()?"moment.utc":"moment.parseZone",n="Z"),e="["+r+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a=n+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+a)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(fa[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),fa.toJSON=function(){return this.isValid()?this.toISOString():null},fa.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},fa.unix=function(){return Math.floor(this.valueOf()/1e3)},fa.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},fa.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},fa.eraName=function(){for(var e,t=this.localeData().eras(),a=0,r=t.length;a<r;++a){if(e=this.clone().startOf("day").valueOf(),t[a].since<=e&&e<=t[a].until)return t[a].name;if(t[a].until<=e&&e<=t[a].since)return t[a].name}return""},fa.eraNarrow=function(){for(var e,t=this.localeData().eras(),a=0,r=t.length;a<r;++a){if(e=this.clone().startOf("day").valueOf(),t[a].since<=e&&e<=t[a].until)return t[a].narrow;if(t[a].until<=e&&e<=t[a].since)return t[a].narrow}return""},fa.eraAbbr=function(){for(var e,t=this.localeData().eras(),a=0,r=t.length;a<r;++a){if(e=this.clone().startOf("day").valueOf(),t[a].since<=e&&e<=t[a].until)return t[a].abbr;if(t[a].until<=e&&e<=t[a].since)return t[a].abbr}return""},fa.eraYear=function(){for(var e,t,a=this.localeData().eras(),r=0,n=a.length;r<n;++r)if(e=a[r].since<=a[r].until?1:-1,t=this.clone().startOf("day").valueOf(),a[r].since<=t&&t<=a[r].until||a[r].until<=t&&t<=a[r].since)return(this.year()-y(a[r].since).year())*e+a[r].offset;return this.year()},fa.year=Ue,fa.isLeapYear=function(){return W(this.year())},fa.weekYear=function(e){return ia.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},fa.isoWeekYear=function(e){return ia.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},fa.quarter=fa.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},fa.month=De,fa.daysInMonth=function(){return we(this.year(),this.month())},fa.week=fa.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},fa.isoWeek=fa.isoWeeks=function(e){var t=Be(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},fa.weeksInYear=function(){var e=this.localeData()._week;return Fe(this.year(),e.dow,e.doy)},fa.weeksInWeekYear=function(){var e=this.localeData()._week;return Fe(this.weekYear(),e.dow,e.doy)},fa.isoWeeksInYear=function(){return Fe(this.year(),1,4)},fa.isoWeeksInISOWeekYear=function(){return Fe(this.isoWeekYear(),1,4)},fa.date=sa,fa.day=fa.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,a,r=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,a=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=a.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-r,"d")):r},fa.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},fa.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null==e)return this.day()||7;var t,a,r=(t=e,a=this.localeData(),"string"==typeof t?a.weekdaysParse(t)%7||7:isNaN(t)?null:t);return this.day(this.day()%7?r:r-7)},fa.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},fa.hour=fa.hours=tt,fa.minute=fa.minutes=la,fa.second=fa.seconds=da,fa.millisecond=fa.milliseconds=ua,fa.utcOffset=function(e,t,a){var r,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null==e)return this._isUTC?n:Ht(this);if("string"==typeof e){if(null===(e=xt(ue,e)))return this}else Math.abs(e)<16&&!a&&(e*=60);return!this._isUTC&&t&&(r=Ht(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),n!==e&&(!t||this._changeInProgress?qt(this,Ft(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,y.updateOffset(this,!0),this._changeInProgress=null)),this},fa.utc=function(e){return this.utcOffset(0,e)},fa.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ht(this),"m")),this},fa.parseZone=function(){var e;return null!=this._tzm?this.utcOffset(this._tzm,!1,!0):"string"==typeof this._i&&(null!=(e=xt(ce,this._i))?this.utcOffset(e):this.utcOffset(0,!0)),this},fa.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Tt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},fa.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},fa.isLocal=function(){return!!this.isValid()&&!this._isUTC},fa.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},fa.isUtc=zt,fa.isUTC=zt,fa.zoneAbbr=function(){return this._isUTC?"UTC":""},fa.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},fa.dates=a("dates accessor is deprecated. Use date instead.",sa),fa.months=a("months accessor is deprecated. Use month instead",De),fa.years=a("years accessor is deprecated. Use year instead",Ue),fa.zone=a("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),fa.isDSTShifted=a("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!f(this._isDSTShifted))return this._isDSTShifted;var e,t={};return b(t,this),(t=bt(t))._a?(e=(t._isUTC?C:Tt)(t._a),this._isDSTShifted=this.isValid()&&0<function(e,t,a){for(var r=Math.min(e.length,t.length),n=Math.abs(e.length-t.length),o=0,i=0;i<r;i++)Y(e[i])!==Y(t[i])&&o++;return o+n}(t._a,e.toArray())):this._isDSTShifted=!1,this._isDSTShifted});var ha=M.prototype;function va(e,t,a,r){var n=ct(),o=C().set(r,t);return n[a](o,e)}function ga(e,t,a){if(p(e)&&(t=e,e=void 0),e=e||"",null!=t)return va(e,t,a,"month");for(var r=[],n=0;n<12;n++)r[n]=va(e,n,a,"month");return r}function Ca(e,t,a,r){"boolean"==typeof e?p(t)&&(a=t,t=void 0):(t=e,e=!1,p(a=t)&&(a=t,t=void 0)),t=t||"";var n,o=ct(),i=e?o._week.dow:0,s=[];if(null!=a)return va(t,(a+i)%7,r,"day");for(n=0;n<7;n++)s[n]=va(t,(n+i)%7,r,"day");return s}ha.calendar=function(e,t,a){var r=this._calendar[e]||this._calendar.sameElse;return w(r)?r.call(t,a):r},ha.longDateFormat=function(e){var t=this._longDateFormat[e],a=this._longDateFormat[e.toUpperCase()];return t||!a?t:(this._longDateFormat[e]=a.match(I).map(function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e}).join(""),this._longDateFormat[e])},ha.invalidDate=function(){return this._invalidDate},ha.ordinal=function(e){return this._ordinal.replace("%d",e)},ha.preparse=pa,ha.postformat=pa,ha.relativeTime=function(e,t,a,r){var n=this._relativeTime[a];return w(n)?n(e,t,a,r):n.replace(/%d/i,e)},ha.pastFuture=function(e,t){var a=this._relativeTime[0<e?"future":"past"];return w(a)?a(t):a.replace(/%s/i,t)},ha.set=function(e){var t,a;for(a in e)A(e,a)&&(w(t=e[a])?this[a]=t:this["_"+a]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},ha.eras=function(e,t){for(var a,r=this._eras||ct("en")._eras,n=0,o=r.length;n<o;++n){switch(typeof r[n].since){case"string":a=y(r[n].since).startOf("day"),r[n].since=a.valueOf()}switch(typeof r[n].until){case"undefined":r[n].until=1/0;break;case"string":a=y(r[n].until).startOf("day").valueOf(),r[n].until=a.valueOf()}}return r},ha.erasParse=function(e,t,a){var r,n,o,i,s,l=this.eras();for(e=e.toUpperCase(),r=0,n=l.length;r<n;++r)if(o=l[r].name.toUpperCase(),i=l[r].abbr.toUpperCase(),s=l[r].narrow.toUpperCase(),a)switch(t){case"N":case"NN":case"NNN":if(i===e)return l[r];break;case"NNNN":if(o===e)return l[r];break;case"NNNNN":if(s===e)return l[r]}else if(0<=[o,i,s].indexOf(e))return l[r]},ha.erasConvertYear=function(e,t){var a=e.since<=e.until?1:-1;return void 0===t?y(e.since).year():y(e.since).year()+(t-e.offset)*a},ha.erasAbbrRegex=function(e){return A(this,"_erasAbbrRegex")||na.call(this),e?this._erasAbbrRegex:this._erasRegex},ha.erasNameRegex=function(e){return A(this,"_erasNameRegex")||na.call(this),e?this._erasNameRegex:this._erasRegex},ha.erasNarrowRegex=function(e){return A(this,"_erasNarrowRegex")||na.call(this),e?this._erasNarrowRegex:this._erasRegex},ha.months=function(e,t){return e?u(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Ie).test(t)?"format":"standalone"][e.month()]:u(this._months)?this._months:this._months.standalone},ha.monthsShort=function(e,t){return e?u(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ie.test(t)?"format":"standalone"][e.month()]:u(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},ha.monthsParse=function(e,t,a){var r,n,o;if(this._monthsParseExact)return function(e,t,a){var r,n,o,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=C([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return a?"MMM"===t?-1!==(n=ge.call(this._shortMonthsParse,i))?n:null:-1!==(n=ge.call(this._longMonthsParse,i))?n:null:"MMM"===t?-1!==(n=ge.call(this._shortMonthsParse,i))||-1!==(n=ge.call(this._longMonthsParse,i))?n:null:-1!==(n=ge.call(this._longMonthsParse,i))||-1!==(n=ge.call(this._shortMonthsParse,i))?n:null}.call(this,e,t,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(n=C([2e3,r]),a&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),a||this._monthsParse[r]||(o="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),a&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(a&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!a&&this._monthsParse[r].test(e))return r}},ha.monthsRegex=function(e){return this._monthsParseExact?(A(this,"_monthsRegex")||Le.call(this),e?this._monthsStrictRegex:this._monthsRegex):(A(this,"_monthsRegex")||(this._monthsRegex=Oe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},ha.monthsShortRegex=function(e){return this._monthsParseExact?(A(this,"_monthsRegex")||Le.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(A(this,"_monthsShortRegex")||(this._monthsShortRegex=ke),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},ha.week=function(e){return Be(e,this._week.dow,this._week.doy).week},ha.firstDayOfYear=function(){return this._week.doy},ha.firstDayOfWeek=function(){return this._week.dow},ha.weekdays=function(e,t){var a=u(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?We(a,this._week.dow):e?a[e.day()]:a},ha.weekdaysMin=function(e){return!0===e?We(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},ha.weekdaysShort=function(e){return!0===e?We(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},ha.weekdaysParse=function(e,t,a){var r,n,o;if(this._weekdaysParseExact)return function(e,t,a){var r,n,o,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=C([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return a?"dddd"===t?-1!==(n=ge.call(this._weekdaysParse,i))?n:null:"ddd"===t?-1!==(n=ge.call(this._shortWeekdaysParse,i))?n:null:-1!==(n=ge.call(this._minWeekdaysParse,i))?n:null:"dddd"===t?-1!==(n=ge.call(this._weekdaysParse,i))||-1!==(n=ge.call(this._shortWeekdaysParse,i))||-1!==(n=ge.call(this._minWeekdaysParse,i))?n:null:"ddd"===t?-1!==(n=ge.call(this._shortWeekdaysParse,i))||-1!==(n=ge.call(this._weekdaysParse,i))||-1!==(n=ge.call(this._minWeekdaysParse,i))?n:null:-1!==(n=ge.call(this._minWeekdaysParse,i))||-1!==(n=ge.call(this._weekdaysParse,i))||-1!==(n=ge.call(this._shortWeekdaysParse,i))?n:null}.call(this,e,t,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(n=C([2e3,1]).day(r),a&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),a&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(a&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(a&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!a&&this._weekdaysParse[r].test(e))return r}},ha.weekdaysRegex=function(e){return this._weekdaysParseExact?(A(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(A(this,"_weekdaysRegex")||(this._weekdaysRegex=Ve),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},ha.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(A(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(A(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ke),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},ha.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(A(this,"_weekdaysRegex")||$e.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(A(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ze),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},ha.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},ha.meridiem=function(e,t,a){return 11<e?a?"pm":"PM":a?"am":"AM"},st("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===Y(e%100/10)?"th":1==t?"st":2==t?"nd":3==t?"rd":"th")}}),y.lang=a("moment.lang is deprecated. Use moment.locale instead.",st),y.langData=a("moment.langData is deprecated. Use moment.localeData instead.",ct);var ya=Math.abs;function Aa(e,t,a,r){var n=Ft(t,a);return e._milliseconds+=r*n._milliseconds,e._days+=r*n._days,e._months+=r*n._months,e._bubble()}function _a(e){return e<0?Math.floor(e):Math.ceil(e)}function Ea(e){return 4800*e/146097}function Pa(e){return 146097*e/4800}function ba(e){return function(){return this.as(e)}}var Sa=ba("ms"),Ta=ba("s"),wa=ba("m"),Ma=ba("h"),Ra=ba("d"),Ia=ba("w"),ka=ba("M"),Oa=ba("Q"),Na=ba("y");function Da(e){return function(){return this.isValid()?this._data[e]:NaN}}var La=Da("milliseconds"),xa=Da("seconds"),Ua=Da("minutes"),Ha=Da("hours"),za=Da("days"),ja=Da("months"),Ba=Da("years"),Fa=Math.round,Wa={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};var Ga=Math.abs;function Ya(e){return(0<e)-(e<0)||+e}function qa(){if(!this.isValid())return this.localeData().invalidDate();var e,t,a,r,n,o,i,s,l=Ga(this._milliseconds)/1e3,c=Ga(this._days),u=Ga(this._months),d=this.asSeconds();return d?(t=G((e=G(l/60))/60),l%=60,e%=60,a=G(u/12),u%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",n=d<0?"-":"",o=Ya(this._months)!==Ya(d)?"-":"",i=Ya(this._days)!==Ya(d)?"-":"",s=Ya(this._milliseconds)!==Ya(d)?"-":"",n+"P"+(a?o+a+"Y":"")+(u?o+u+"M":"")+(c?i+c+"D":"")+(t||e||l?"T":"")+(t?s+t+"H":"")+(e?s+e+"M":"")+(l?s+r+"S":"")):"P0D"}var Va=kt.prototype;return Va.isValid=function(){return this._isValid},Va.abs=function(){var e=this._data;return this._milliseconds=ya(this._milliseconds),this._days=ya(this._days),this._months=ya(this._months),e.milliseconds=ya(e.milliseconds),e.seconds=ya(e.seconds),e.minutes=ya(e.minutes),e.hours=ya(e.hours),e.months=ya(e.months),e.years=ya(e.years),this},Va.add=function(e,t){return Aa(this,e,t,1)},Va.subtract=function(e,t){return Aa(this,e,t,-1)},Va.as=function(e){if(!this.isValid())return NaN;var t,a,r=this._milliseconds;if("month"===(e=z(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,a=this._months+Ea(t),e){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(t=this._days+Math.round(Pa(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},Va.asMilliseconds=Sa,Va.asSeconds=Ta,Va.asMinutes=wa,Va.asHours=Ma,Va.asDays=Ra,Va.asWeeks=Ia,Va.asMonths=ka,Va.asQuarters=Oa,Va.asYears=Na,Va.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*Y(this._months/12):NaN},Va._bubble=function(){var e,t,a,r,n,o=this._milliseconds,i=this._days,s=this._months,l=this._data;return 0<=o&&0<=i&&0<=s||o<=0&&i<=0&&s<=0||(o+=864e5*_a(Pa(s)+i),s=i=0),l.milliseconds=o%1e3,e=G(o/1e3),l.seconds=e%60,t=G(e/60),l.minutes=t%60,a=G(t/60),l.hours=a%24,s+=n=G(Ea(i+=G(a/24))),i-=_a(Pa(n)),r=G(s/12),s%=12,l.days=i,l.months=s,l.years=r,this},Va.clone=function(){return Ft(this)},Va.get=function(e){return e=z(e),this.isValid()?this[e+"s"]():NaN},Va.milliseconds=La,Va.seconds=xa,Va.minutes=Ua,Va.hours=Ha,Va.days=za,Va.weeks=function(){return G(this.days()/7)},Va.months=ja,Va.years=Ba,Va.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var a,r,n,o,i,s,l,c,u,d,m,f,p,h,v,g=!1,C=Wa;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(g=e),"object"==typeof t&&(C=Object.assign({},Wa,t),null!=t.s&&null==t.ss&&(C.ss=t.s-1)),a=this.localeData(),o=!g,i=C,s=a,l=Ft(n=this).abs(),c=Fa(l.as("s")),u=Fa(l.as("m")),d=Fa(l.as("h")),m=Fa(l.as("d")),f=Fa(l.as("M")),p=Fa(l.as("w")),h=Fa(l.as("y")),v=(c<=i.ss?["s",c]:c<i.s&&["ss",c])||u<=1&&["m"]||u<i.m&&["mm",u]||d<=1&&["h"]||d<i.h&&["hh",d]||m<=1&&["d"]||m<i.d&&["dd",m],null!=i.w&&(v=v||p<=1&&["w"]||p<i.w&&["ww",p]),(v=v||f<=1&&["M"]||f<i.M&&["MM",f]||h<=1&&["y"]||["yy",h])[2]=o,v[3]=0<+n,v[4]=s,r=function(e,t,a,r,n){return n.relativeTime(t||1,!!a,e,r)}.apply(null,v),g&&(r=a.pastFuture(+this,r)),a.postformat(r)},Va.toISOString=qa,Va.toString=qa,Va.toJSON=qa,Va.locale=Jt,Va.localeData=Qt,Va.toIsoString=a("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",qa),Va.lang=Xt,D("X",0,0,"unix"),D("x",0,0,"valueOf"),me("x",le),me("X",/[+-]?\d+(\.\d{1,3})?/),he("X",function(e,t,a){a._d=new Date(1e3*parseFloat(e))}),he("x",function(e,t,a){a._d=new Date(Y(e))}),y.version="2.29.1",e=Tt,y.fn=fa,y.min=function(){return Rt("isBefore",[].slice.call(arguments,0))},y.max=function(){return Rt("isAfter",[].slice.call(arguments,0))},y.now=function(){return Date.now?Date.now():+new Date},y.utc=C,y.unix=function(e){return Tt(1e3*e)},y.months=function(e,t){return ga(e,t,"months")},y.isDate=h,y.locale=st,y.invalid=P,y.duration=Ft,y.isMoment=T,y.weekdays=function(e,t,a){return Ca(e,t,a,"weekdays")},y.parseZone=function(){return Tt.apply(null,arguments).parseZone()},y.localeData=ct,y.isDuration=Ot,y.monthsShort=function(e,t){return ga(e,t,"monthsShort")},y.weekdaysMin=function(e,t,a){return Ca(e,t,a,"weekdaysMin")},y.defineLocale=lt,y.updateLocale=function(e,t){var a,r,n;return null!=t?(n=at,null!=rt[e]&&null!=rt[e].parentLocale?rt[e].set(c(rt[e]._config,t)):(null!=(r=it(e))&&(n=r._config),t=c(n,t),null==r&&(t.abbr=e),(a=new M(t)).parentLocale=rt[e],rt[e]=a),st(e)):null!=rt[e]&&(null!=rt[e].parentLocale?(rt[e]=rt[e].parentLocale,e===st()&&st(e)):null!=rt[e]&&delete rt[e]),rt[e]},y.locales=function(){return r(rt)},y.weekdaysShort=function(e,t,a){return Ca(e,t,a,"weekdaysShort")},y.normalizeUnits=z,y.relativeTimeRounding=function(e){return void 0===e?Fa:"function"==typeof e&&(Fa=e,!0)},y.relativeTimeThreshold=function(e,t){return void 0!==Wa[e]&&(void 0===t?Wa[e]:(Wa[e]=t,"s"===e&&(Wa.ss=t-1),!0))},y.calendarFormat=function(e,t){var a=e.diff(t,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"},y.prototype=fa,y.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},y}),function(e,t){"use strict";"object"==typeof module&&module.exports?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define(["moment"],t):t(e.moment)}(this,function(o){"use strict";void 0===o.version&&o.default&&(o=o.default);var t,i={},s={},l={},c={},u={};o&&"string"==typeof o.version||w("Moment Timezone requires Moment.js. See https://momentjs.com/timezone/docs/#/use-it/browser/");var e=o.version.split("."),a=+e[0],r=+e[1];function d(e){return 96<e?e-87:64<e?e-29:e-48}function n(e){var t=0,a=e.split("."),r=a[0],n=a[1]||"",o=1,i=0,s=1;for(45===e.charCodeAt(0)&&(s=-(t=1));t<r.length;t++)i=60*i+d(r.charCodeAt(t));for(t=0;t<n.length;t++)o/=60,i+=d(n.charCodeAt(t))*o;return i*s}function m(e){for(var t=0;t<e.length;t++)e[t]=n(e[t])}function f(e,t){for(var a=[],r=0;r<t.length;r++)a[r]=e[t[r]];return a}function p(e){var t=e.split("|"),a=t[2].split(" "),r=t[3].split(""),n=t[4].split(" ");return m(a),m(r),m(n),function(e,t){for(var a=0;a<t;a++)e[a]=Math.round((e[a-1]||0)+6e4*e[a]);e[t-1]=1/0}(n,r.length),{name:t[0],abbrs:f(t[1].split(" "),r),offsets:f(a,r),untils:n,population:0|t[5]}}function h(e){e&&this._set(p(e))}function v(e,t){this.name=e,this.zones=t}function g(e){var t=e.toTimeString(),a=t.match(/\([a-z ]+\)/i);"GMT"===(a=a&&a[0]?(a=a[0].match(/[A-Z]/g))?a.join(""):void 0:(a=t.match(/[A-Z]{3,5}/g))?a[0]:void 0)&&(a=void 0),this.at=+e,this.abbr=a,this.offset=e.getTimezoneOffset()}function C(e){this.zone=e,this.offsetScore=0,this.abbrScore=0}function y(e,t){return e.offsetScore!==t.offsetScore?e.offsetScore-t.offsetScore:e.abbrScore!==t.abbrScore?e.abbrScore-t.abbrScore:e.zone.population!==t.zone.population?t.zone.population-e.zone.population:t.zone.name.localeCompare(e.zone.name)}function A(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(e&&3<e.length){var t=c[_(e)];if(t)return t;w("Moment Timezone found "+e+" from the Intl api, but did not have that data loaded.")}}catch(e){}for(var a,r,n=function(){for(var e,t,a=(new Date).getFullYear()-2,r=new g(new Date(a,0,1)),n=[r],o=1;o<48;o++)(t=new g(new Date(a,o,1))).offset!==r.offset&&(e=function(e,t){for(var a,r;r=6e4*((t.at-e.at)/12e4|0);)(a=new g(new Date(e.at+r))).offset===e.offset?e=a:t=a;return e}(r,t),n.push(e),n.push(new g(new Date(e.at+6e4)))),r=t;for(o=0;o<4;o++)n.push(new g(new Date(a+o,0,1))),n.push(new g(new Date(a+o,6,1)));return n}(),o=n.length,i=function(e){for(var t,a,r=e.length,n={},o=[],i=0;i<r;i++)for(t in a=u[e[i].offset]||{})a.hasOwnProperty(t)&&(n[t]=!0);for(i in n)n.hasOwnProperty(i)&&o.push(c[i]);return o}(n),s=[],l=0;l<i.length;l++){for(a=new C(P(i[l])),r=0;r<o;r++)a.scoreOffsetAt(n[r]);s.push(a)}return s.sort(y),0<s.length?s[0].zone.name:void 0}function _(e){return(e||"").toLowerCase().replace(/\//g,"_")}function E(e){var t,a,r,n;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)n=_(a=(r=e[t].split("|"))[0]),i[n]=e[t],c[n]=a,function(e,t){var a,r;for(m(t),a=0;a<t.length;a++)r=t[a],u[r]=u[r]||{},u[r][e]=!0}(n,r[2].split(" "))}function P(e,t){e=_(e);var a,r=i[e];return r instanceof h?r:"string"==typeof r?(r=new h(r),i[e]=r):s[e]&&t!==P&&(a=P(s[e],P))?((r=i[e]=new h)._set(a),r.name=c[e],r):null}function b(e){var t,a,r,n;for("string"==typeof e&&(e=[e]),t=0;t<e.length;t++)r=_((a=e[t].split("|"))[0]),n=_(a[1]),s[r]=n,c[r]=a[0],s[n]=r,c[n]=a[1]}function S(e){E(e.zones),b(e.links),function(e){var t,a,r,n;if(e&&e.length)for(t=0;t<e.length;t++)a=(n=e[t].split("|"))[0].toUpperCase(),r=n[1].split(" "),l[a]=new v(a,r)}(e.countries),M.dataVersion=e.version}function T(e){var t="X"===e._f||"x"===e._f;return!(!e._a||void 0!==e._tzm||t)}function w(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}function M(e){var t=Array.prototype.slice.call(arguments,0,-1),a=arguments[arguments.length-1],r=P(a),n=o.utc.apply(null,t);return r&&!o.isMoment(e)&&T(n)&&n.add(r.parse(n),"minutes"),n.tz(a),n}(a<2||2==a&&r<6)&&w("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+o.version+". See momentjs.com"),h.prototype={_set:function(e){this.name=e.name,this.abbrs=e.abbrs,this.untils=e.untils,this.offsets=e.offsets,this.population=e.population},_index:function(e){for(var t=+e,a=this.untils,r=0;r<a.length;r++)if(t<a[r])return r},countries:function(){var t=this.name;return Object.keys(l).filter(function(e){return-1!==l[e].zones.indexOf(t)})},parse:function(e){for(var t,a,r,n=+e,o=this.offsets,i=this.untils,s=i.length-1,l=0;l<s;l++)if(t=o[l],a=o[l+1],r=o[l?l-1:l],t<a&&M.moveAmbiguousForward?t=a:r<t&&M.moveInvalidForward&&(t=r),n<i[l]-6e4*t)return o[l];return o[s]},abbr:function(e){return this.abbrs[this._index(e)]},offset:function(e){return w("zone.offset has been deprecated in favor of zone.utcOffset"),this.offsets[this._index(e)]},utcOffset:function(e){return this.offsets[this._index(e)]}},C.prototype.scoreOffsetAt=function(e){this.offsetScore+=Math.abs(this.zone.utcOffset(e.at)-e.offset),this.zone.abbr(e.at).replace(/[^A-Z]/g,"")!==e.abbr&&this.abbrScore++},M.version="0.5.32",M.dataVersion="",M._zones=i,M._links=s,M._names=c,M._countries=l,M.add=E,M.link=b,M.load=S,M.zone=P,M.zoneExists=function e(t){return e.didShowError||(e.didShowError=!0,w("moment.tz.zoneExists('"+t+"') has been deprecated in favor of !moment.tz.zone('"+t+"')")),!!P(t)},M.guess=function(e){return t&&!e||(t=A()),t},M.names=function(){var e,t=[];for(e in c)c.hasOwnProperty(e)&&(i[e]||i[s[e]])&&c[e]&&t.push(c[e]);return t.sort()},M.Zone=h,M.unpack=p,M.unpackBase60=n,M.needsOffset=T,M.moveInvalidForward=!0,M.moveAmbiguousForward=!1,M.countries=function(){return Object.keys(l)},M.zonesForCountry=function(e,t){var a;if(a=(a=e).toUpperCase(),!(e=l[a]||null))return null;var r=e.zones.sort();return t?r.map(function(e){return{name:e,offset:P(e).utcOffset(new Date)}}):r};var R,I=o.fn;function k(e){return function(){return this._z?this._z.abbr(this):e.call(this)}}function O(e){return function(){return this._z=null,e.apply(this,arguments)}}o.tz=M,o.defaultZone=null,o.updateOffset=function(e,t){var a,r,n=o.defaultZone;void 0===e._z&&(n&&T(e)&&!e._isUTC&&(e._d=o.utc(e._a)._d,e.utc().add(n.parse(e),"minutes")),e._z=n),e._z&&(r=e._z.utcOffset(e),Math.abs(r)<16&&(r/=60),void 0!==e.utcOffset?(a=e._z,e.utcOffset(-r,t),e._z=a):e.zone(r,t))},I.tz=function(e,t){if(e){if("string"!=typeof e)throw new Error("Time zone name must be a string, got "+e+" ["+typeof e+"]");return this._z=P(e),this._z?o.updateOffset(this,t):w("Moment Timezone has no data for "+e+". See http://momentjs.com/timezone/docs/#/data-loading/."),this}if(this._z)return this._z.name},I.zoneName=k(I.zoneName),I.zoneAbbr=k(I.zoneAbbr),I.utc=O(I.utc),I.local=O(I.local),I.utcOffset=(R=I.utcOffset,function(){return 0<arguments.length&&(this._z=null),R.apply(this,arguments)}),o.tz.setDefault=function(e){return(a<2||2==a&&r<9)&&w("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+o.version+"."),o.defaultZone=e?P(e):null,o};var N=o.momentProperties;return"[object Array]"===Object.prototype.toString.call(N)?(N.push("_z"),N.push("_a")):N&&(N._z=null),S({version:"2020a",zones:["Africa/Abidjan|GMT|0|0||48e5","Africa/Nairobi|EAT|-30|0||47e5","Africa/Algiers|CET|-10|0||26e5","Africa/Lagos|WAT|-10|0||17e6","Africa/Maputo|CAT|-20|0||26e5","Africa/Cairo|EET EEST|-20 -30|01010|1M2m0 gL0 e10 mn0|15e6","Africa/Casablanca|+00 +01|0 -10|010101010101010101010101010101010101|1H3C0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uM0 e00 Dc0 11A0 s00 e00 IM0 WM0 mo0 gM0 LA0 WM0 jA0 e00 28M0 e00 2600 gM0 2600 e00 2600 gM0|32e5","Europe/Paris|CET CEST|-10 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|11e6","Africa/Johannesburg|SAST|-20|0||84e5","Africa/Khartoum|EAT CAT|-30 -20|01|1Usl0|51e5","Africa/Sao_Tome|GMT WAT|0 -10|010|1UQN0 2q00|","Africa/Tripoli|EET CET CEST|-20 -10 -20|0120|1IlA0 TA0 1o00|11e5","Africa/Windhoek|CAT WAT|-20 -10|0101010101010|1GQo0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|32e4","America/Adak|HST HDT|a0 90|01010101010101010101010|1GIc0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|326","America/Anchorage|AKST AKDT|90 80|01010101010101010101010|1GIb0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|30e4","America/Santo_Domingo|AST|40|0||29e5","America/Araguaina|-03 -02|30 20|010|1IdD0 Lz0|14e4","America/Fortaleza|-03|30|0||34e5","America/Asuncion|-03 -04|30 40|01010101010101010101010|1GTf0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0|28e5","America/Panama|EST|50|0||15e5","America/Mexico_City|CST CDT|60 50|01010101010101010101010|1GQw0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|20e6","America/Bahia|-02 -03|20 30|01|1GCq0|27e5","America/Managua|CST|60|0||22e5","America/La_Paz|-04|40|0||19e5","America/Lima|-05|50|0||11e6","America/Denver|MST MDT|70 60|01010101010101010101010|1GI90 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|26e5","America/Campo_Grande|-03 -04|30 40|0101010101010101|1GCr0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0|77e4","America/Cancun|CST CDT EST|60 50 50|01010102|1GQw0 1nX0 14p0 1lb0 14p0 1lb0 Dd0|63e4","America/Caracas|-0430 -04|4u 40|01|1QMT0|29e5","America/Chicago|CST CDT|60 50|01010101010101010101010|1GI80 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|92e5","America/Chihuahua|MST MDT|70 60|01010101010101010101010|1GQx0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0|81e4","America/Phoenix|MST|70|0||42e5","America/Whitehorse|PST PDT MST|80 70 70|010101010101010102|1GIa0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0|23e3","America/New_York|EST EDT|50 40|01010101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|21e6","America/Rio_Branco|-04 -05|40 50|01|1KLE0|31e4","America/Los_Angeles|PST PDT|80 70|01010101010101010101010|1GIa0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|15e6","America/Fort_Nelson|PST PDT MST|80 70 70|01010102|1GIa0 1zb0 Op0 1zb0 Op0 1zb0 Op0|39e2","America/Halifax|AST ADT|40 30|01010101010101010101010|1GI60 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|39e4","America/Godthab|-03 -02|30 20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|17e3","America/Grand_Turk|EST EDT AST|50 40 40|0101010121010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 5Ip0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|37e2","America/Havana|CST CDT|50 40|01010101010101010101010|1GQt0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0|21e5","America/Metlakatla|PST AKST AKDT|80 90 80|01212120121212121|1PAa0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 uM0 jB0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|14e2","America/Miquelon|-03 -02|30 20|01010101010101010101010|1GI50 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|61e2","America/Montevideo|-02 -03|20 30|01010101|1GI40 1o10 11z0 1o10 11z0 1o10 11z0|17e5","America/Noronha|-02|20|0||30e2","America/Port-au-Prince|EST EDT|50 40|010101010101010101010|1GI70 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 3iN0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|23e5","Antarctica/Palmer|-03 -04|30 40|010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0|40","America/Santiago|-03 -04|30 40|010101010101010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|62e5","America/Sao_Paulo|-02 -03|20 30|0101010101010101|1GCq0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1HB0 FX0|20e6","Atlantic/Azores|-01 +00|10 0|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|25e4","America/St_Johns|NST NDT|3u 2u|01010101010101010101010|1GI5u 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0|11e4","Antarctica/Casey|+11 +08|-b0 -80|0101|1GAF0 blz0 3m10|10","Antarctica/Davis|+05 +07|-50 -70|01|1GAI0|70","Pacific/Port_Moresby|+10|-a0|0||25e4","Pacific/Guadalcanal|+11|-b0|0||11e4","Asia/Tashkent|+05|-50|0||23e5","Pacific/Auckland|NZDT NZST|-d0 -c0|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|14e5","Asia/Baghdad|+03|-30|0||66e5","Antarctica/Troll|+00 +02|0 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|40","Asia/Dhaka|+06|-60|0||16e6","Asia/Amman|EET EEST|-20 -30|010101010101010101010|1GPy0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00|25e5","Asia/Kamchatka|+12|-c0|0||18e4","Asia/Baku|+04 +05|-40 -50|010101010|1GNA0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00|27e5","Asia/Bangkok|+07|-70|0||15e6","Asia/Barnaul|+07 +06|-70 -60|010|1N7v0 3rd0|","Asia/Beirut|EET EEST|-20 -30|01010101010101010101010|1GNy0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0|22e5","Asia/Kuala_Lumpur|+08|-80|0||71e5","Asia/Kolkata|IST|-5u|0||15e6","Asia/Chita|+10 +08 +09|-a0 -80 -90|012|1N7s0 3re0|33e4","Asia/Ulaanbaatar|+08 +09|-80 -90|01010|1O8G0 1cJ0 1cP0 1cJ0|12e5","Asia/Shanghai|CST|-80|0||23e6","Asia/Colombo|+0530|-5u|0||22e5","Asia/Damascus|EET EEST|-20 -30|01010101010101010101010|1GPy0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0|26e5","Asia/Dili|+09|-90|0||19e4","Asia/Dubai|+04|-40|0||39e5","Asia/Famagusta|EET EEST +03|-20 -30 -30|0101010101201010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 15U0 2Ks0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|","Asia/Gaza|EET EEST|-20 -30|01010101010101010101010|1GPy0 1a00 1fA0 1cL0 1cN0 1nX0 1210 1nz0 1220 1qL0 WN0 1qL0 WN0 1qL0 11c0 1oo0 11c0 1rc0 Wo0 1rc0 Wo0 1rc0|18e5","Asia/Hong_Kong|HKT|-80|0||73e5","Asia/Hovd|+07 +08|-70 -80|01010|1O8H0 1cJ0 1cP0 1cJ0|81e3","Asia/Irkutsk|+09 +08|-90 -80|01|1N7t0|60e4","Europe/Istanbul|EET EEST +03|-20 -30 -30|01010101012|1GNB0 1qM0 11A0 1o00 1200 1nA0 11A0 1tA0 U00 15w0|13e6","Asia/Jakarta|WIB|-70|0||31e6","Asia/Jayapura|WIT|-90|0||26e4","Asia/Jerusalem|IST IDT|-20 -30|01010101010101010101010|1GPA0 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0|81e4","Asia/Kabul|+0430|-4u|0||46e5","Asia/Karachi|PKT|-50|0||24e6","Asia/Kathmandu|+0545|-5J|0||12e5","Asia/Yakutsk|+10 +09|-a0 -90|01|1N7s0|28e4","Asia/Krasnoyarsk|+08 +07|-80 -70|01|1N7u0|10e5","Asia/Magadan|+12 +10 +11|-c0 -a0 -b0|012|1N7q0 3Cq0|95e3","Asia/Makassar|WITA|-80|0||15e5","Asia/Manila|PST|-80|0||24e6","Europe/Athens|EET EEST|-20 -30|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|35e5","Asia/Novosibirsk|+07 +06|-70 -60|010|1N7v0 4eN0|15e5","Asia/Omsk|+07 +06|-70 -60|01|1N7v0|12e5","Asia/Pyongyang|KST KST|-90 -8u|010|1P4D0 6BA0|29e5","Asia/Qyzylorda|+06 +05|-60 -50|01|1Xei0|73e4","Asia/Rangoon|+0630|-6u|0||48e5","Asia/Sakhalin|+11 +10|-b0 -a0|010|1N7r0 3rd0|58e4","Asia/Seoul|KST|-90|0||23e6","Asia/Srednekolymsk|+12 +11|-c0 -b0|01|1N7q0|35e2","Asia/Tehran|+0330 +0430|-3u -4u|01010101010101010101010|1GLUu 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0|14e6","Asia/Tokyo|JST|-90|0||38e6","Asia/Tomsk|+07 +06|-70 -60|010|1N7v0 3Qp0|10e5","Asia/Vladivostok|+11 +10|-b0 -a0|01|1N7r0|60e4","Asia/Yekaterinburg|+06 +05|-60 -50|01|1N7w0|14e5","Europe/Lisbon|WET WEST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|27e5","Atlantic/Cape_Verde|-01|10|0||50e4","Australia/Sydney|AEDT AEST|-b0 -a0|01010101010101010101010|1GQg0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0|40e5","Australia/Adelaide|ACDT ACST|-au -9u|01010101010101010101010|1GQgu 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0|11e5","Australia/Brisbane|AEST|-a0|0||20e5","Australia/Darwin|ACST|-9u|0||12e4","Australia/Eucla|+0845|-8J|0||368","Australia/Lord_Howe|+11 +1030|-b0 -au|01010101010101010101010|1GQf0 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu|347","Australia/Perth|AWST|-80|0||18e5","Pacific/Easter|-05 -06|50 60|010101010101010101010|1H3D0 Op0 1zb0 Rd0 1wn0 Rd0 46n0 Ap0 1Nb0 Ap0 1Nb0 Ap0 1zb0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0|30e2","Europe/Dublin|GMT IST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|12e5","Etc/GMT-1|+01|-10|0||","Pacific/Fakaofo|+13|-d0|0||483","Pacific/Kiritimati|+14|-e0|0||51e2","Etc/GMT-2|+02|-20|0||","Pacific/Tahiti|-10|a0|0||18e4","Pacific/Niue|-11|b0|0||12e2","Etc/GMT+12|-12|c0|0||","Pacific/Galapagos|-06|60|0||25e3","Etc/GMT+7|-07|70|0||","Pacific/Pitcairn|-08|80|0||56","Pacific/Gambier|-09|90|0||125","Etc/UTC|UTC|0|0||","Europe/Ulyanovsk|+04 +03|-40 -30|010|1N7y0 3rd0|13e5","Europe/London|GMT BST|0 -10|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|10e6","Europe/Chisinau|EET EEST|-20 -30|01010101010101010101010|1GNA0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|67e4","Europe/Kaliningrad|+03 EET|-30 -20|01|1N7z0|44e4","Europe/Kirov|+04 +03|-40 -30|01|1N7y0|48e4","Europe/Moscow|MSK MSK|-40 -30|01|1N7y0|16e6","Europe/Saratov|+04 +03|-40 -30|010|1N7y0 5810|","Europe/Simferopol|EET EEST MSK MSK|-20 -30 -40 -30|0101023|1GNB0 1qM0 11A0 1o00 11z0 1nW0|33e4","Europe/Volgograd|+04 +03|-40 -30|010|1N7y0 9Jd0|10e5","Pacific/Honolulu|HST|a0|0||37e4","MET|MET MEST|-10 -20|01010101010101010101010|1GNB0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0|","Pacific/Chatham|+1345 +1245|-dJ -cJ|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|600","Pacific/Apia|+14 +13|-e0 -d0|01010101010101010101010|1GQe0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00|37e3","Pacific/Bougainville|+10 +11|-a0 -b0|01|1NwE0|18e4","Pacific/Fiji|+13 +12|-d0 -c0|01010101010101010101010|1Goe0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 uM0 1VA0 s00 1VA0 s00 1VA0 s00 20o0 pc0 20o0 s00 20o0 pc0 20o0|88e4","Pacific/Guam|ChST|-a0|0||17e4","Pacific/Marquesas|-0930|9u|0||86e2","Pacific/Pago_Pago|SST|b0|0||37e2","Pacific/Norfolk|+1130 +11 +12|-bu -b0 -c0|012121212|1PoCu 9Jcu 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0|25e4","Pacific/Tongatapu|+13 +14|-d0 -e0|010|1S4d0 s00|75e3"],links:["Africa/Abidjan|Africa/Accra","Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Bissau","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Monrovia","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|America/Danmarkshavn","Africa/Abidjan|Atlantic/Reykjavik","Africa/Abidjan|Atlantic/St_Helena","Africa/Abidjan|Etc/GMT","Africa/Abidjan|Etc/GMT+0","Africa/Abidjan|Etc/GMT-0","Africa/Abidjan|Etc/GMT0","Africa/Abidjan|Etc/Greenwich","Africa/Abidjan|GMT","Africa/Abidjan|GMT+0","Africa/Abidjan|GMT-0","Africa/Abidjan|GMT0","Africa/Abidjan|Greenwich","Africa/Abidjan|Iceland","Africa/Algiers|Africa/Tunis","Africa/Cairo|Egypt","Africa/Casablanca|Africa/El_Aaiun","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Lagos|Africa/Bangui","Africa/Lagos|Africa/Brazzaville","Africa/Lagos|Africa/Douala","Africa/Lagos|Africa/Kinshasa","Africa/Lagos|Africa/Libreville","Africa/Lagos|Africa/Luanda","Africa/Lagos|Africa/Malabo","Africa/Lagos|Africa/Ndjamena","Africa/Lagos|Africa/Niamey","Africa/Lagos|Africa/Porto-Novo","Africa/Maputo|Africa/Blantyre","Africa/Maputo|Africa/Bujumbura","Africa/Maputo|Africa/Gaborone","Africa/Maputo|Africa/Harare","Africa/Maputo|Africa/Kigali","Africa/Maputo|Africa/Lubumbashi","Africa/Maputo|Africa/Lusaka","Africa/Nairobi|Africa/Addis_Ababa","Africa/Nairobi|Africa/Asmara","Africa/Nairobi|Africa/Asmera","Africa/Nairobi|Africa/Dar_es_Salaam","Africa/Nairobi|Africa/Djibouti","Africa/Nairobi|Africa/Juba","Africa/Nairobi|Africa/Kampala","Africa/Nairobi|Africa/Mogadishu","Africa/Nairobi|Indian/Antananarivo","Africa/Nairobi|Indian/Comoro","Africa/Nairobi|Indian/Mayotte","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|America/Juneau","America/Anchorage|America/Nome","America/Anchorage|America/Sitka","America/Anchorage|America/Yakutat","America/Anchorage|US/Alaska","America/Campo_Grande|America/Cuiaba","America/Chicago|America/Indiana/Knox","America/Chicago|America/Indiana/Tell_City","America/Chicago|America/Knox_IN","America/Chicago|America/Matamoros","America/Chicago|America/Menominee","America/Chicago|America/North_Dakota/Beulah","America/Chicago|America/North_Dakota/Center","America/Chicago|America/North_Dakota/New_Salem","America/Chicago|America/Rainy_River","America/Chicago|America/Rankin_Inlet","America/Chicago|America/Resolute","America/Chicago|America/Winnipeg","America/Chicago|CST6CDT","America/Chicago|Canada/Central","America/Chicago|US/Central","America/Chicago|US/Indiana-Starke","America/Chihuahua|America/Mazatlan","America/Chihuahua|Mexico/BajaSur","America/Denver|America/Boise","America/Denver|America/Cambridge_Bay","America/Denver|America/Edmonton","America/Denver|America/Inuvik","America/Denver|America/Ojinaga","America/Denver|America/Shiprock","America/Denver|America/Yellowknife","America/Denver|Canada/Mountain","America/Denver|MST7MDT","America/Denver|Navajo","America/Denver|US/Mountain","America/Fortaleza|America/Argentina/Buenos_Aires","America/Fortaleza|America/Argentina/Catamarca","America/Fortaleza|America/Argentina/ComodRivadavia","America/Fortaleza|America/Argentina/Cordoba","America/Fortaleza|America/Argentina/Jujuy","America/Fortaleza|America/Argentina/La_Rioja","America/Fortaleza|America/Argentina/Mendoza","America/Fortaleza|America/Argentina/Rio_Gallegos","America/Fortaleza|America/Argentina/Salta","America/Fortaleza|America/Argentina/San_Juan","America/Fortaleza|America/Argentina/San_Luis","America/Fortaleza|America/Argentina/Tucuman","America/Fortaleza|America/Argentina/Ushuaia","America/Fortaleza|America/Belem","America/Fortaleza|America/Buenos_Aires","America/Fortaleza|America/Catamarca","America/Fortaleza|America/Cayenne","America/Fortaleza|America/Cordoba","America/Fortaleza|America/Jujuy","America/Fortaleza|America/Maceio","America/Fortaleza|America/Mendoza","America/Fortaleza|America/Paramaribo","America/Fortaleza|America/Recife","America/Fortaleza|America/Rosario","America/Fortaleza|America/Santarem","America/Fortaleza|Antarctica/Rothera","America/Fortaleza|Atlantic/Stanley","America/Fortaleza|Etc/GMT+3","America/Godthab|America/Nuuk","America/Halifax|America/Glace_Bay","America/Halifax|America/Goose_Bay","America/Halifax|America/Moncton","America/Halifax|America/Thule","America/Halifax|Atlantic/Bermuda","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/La_Paz|America/Boa_Vista","America/La_Paz|America/Guyana","America/La_Paz|America/Manaus","America/La_Paz|America/Porto_Velho","America/La_Paz|Brazil/West","America/La_Paz|Etc/GMT+4","America/Lima|America/Bogota","America/Lima|America/Guayaquil","America/Lima|Etc/GMT+5","America/Los_Angeles|America/Ensenada","America/Los_Angeles|America/Santa_Isabel","America/Los_Angeles|America/Tijuana","America/Los_Angeles|America/Vancouver","America/Los_Angeles|Canada/Pacific","America/Los_Angeles|Mexico/BajaNorte","America/Los_Angeles|PST8PDT","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Managua|America/Belize","America/Managua|America/Costa_Rica","America/Managua|America/El_Salvador","America/Managua|America/Guatemala","America/Managua|America/Regina","America/Managua|America/Swift_Current","America/Managua|America/Tegucigalpa","America/Managua|Canada/Saskatchewan","America/Mexico_City|America/Bahia_Banderas","America/Mexico_City|America/Merida","America/Mexico_City|America/Monterrey","America/Mexico_City|Mexico/General","America/New_York|America/Detroit","America/New_York|America/Fort_Wayne","America/New_York|America/Indiana/Indianapolis","America/New_York|America/Indiana/Marengo","America/New_York|America/Indiana/Petersburg","America/New_York|America/Indiana/Vevay","America/New_York|America/Indiana/Vincennes","America/New_York|America/Indiana/Winamac","America/New_York|America/Indianapolis","America/New_York|America/Iqaluit","America/New_York|America/Kentucky/Louisville","America/New_York|America/Kentucky/Monticello","America/New_York|America/Louisville","America/New_York|America/Montreal","America/New_York|America/Nassau","America/New_York|America/Nipigon","America/New_York|America/Pangnirtung","America/New_York|America/Thunder_Bay","America/New_York|America/Toronto","America/New_York|Canada/Eastern","America/New_York|EST5EDT","America/New_York|US/East-Indiana","America/New_York|US/Eastern","America/New_York|US/Michigan","America/Noronha|Atlantic/South_Georgia","America/Noronha|Brazil/DeNoronha","America/Noronha|Etc/GMT+2","America/Panama|America/Atikokan","America/Panama|America/Cayman","America/Panama|America/Coral_Harbour","America/Panama|America/Jamaica","America/Panama|EST","America/Panama|Jamaica","America/Phoenix|America/Creston","America/Phoenix|America/Dawson_Creek","America/Phoenix|America/Hermosillo","America/Phoenix|MST","America/Phoenix|US/Arizona","America/Rio_Branco|America/Eirunepe","America/Rio_Branco|America/Porto_Acre","America/Rio_Branco|Brazil/Acre","America/Santiago|Chile/Continental","America/Santo_Domingo|America/Anguilla","America/Santo_Domingo|America/Antigua","America/Santo_Domingo|America/Aruba","America/Santo_Domingo|America/Barbados","America/Santo_Domingo|America/Blanc-Sablon","America/Santo_Domingo|America/Curacao","America/Santo_Domingo|America/Dominica","America/Santo_Domingo|America/Grenada","America/Santo_Domingo|America/Guadeloupe","America/Santo_Domingo|America/Kralendijk","America/Santo_Domingo|America/Lower_Princes","America/Santo_Domingo|America/Marigot","America/Santo_Domingo|America/Martinique","America/Santo_Domingo|America/Montserrat","America/Santo_Domingo|America/Port_of_Spain","America/Santo_Domingo|America/Puerto_Rico","America/Santo_Domingo|America/St_Barthelemy","America/Santo_Domingo|America/St_Kitts","America/Santo_Domingo|America/St_Lucia","America/Santo_Domingo|America/St_Thomas","America/Santo_Domingo|America/St_Vincent","America/Santo_Domingo|America/Tortola","America/Santo_Domingo|America/Virgin","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Whitehorse|America/Dawson","America/Whitehorse|Canada/Yukon","Antarctica/Palmer|America/Punta_Arenas","Asia/Baghdad|Antarctica/Syowa","Asia/Baghdad|Asia/Aden","Asia/Baghdad|Asia/Bahrain","Asia/Baghdad|Asia/Kuwait","Asia/Baghdad|Asia/Qatar","Asia/Baghdad|Asia/Riyadh","Asia/Baghdad|Etc/GMT-3","Asia/Baghdad|Europe/Minsk","Asia/Bangkok|Asia/Ho_Chi_Minh","Asia/Bangkok|Asia/Novokuznetsk","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Saigon","Asia/Bangkok|Asia/Vientiane","Asia/Bangkok|Etc/GMT-7","Asia/Bangkok|Indian/Christmas","Asia/Dhaka|Antarctica/Vostok","Asia/Dhaka|Asia/Almaty","Asia/Dhaka|Asia/Bishkek","Asia/Dhaka|Asia/Dacca","Asia/Dhaka|Asia/Kashgar","Asia/Dhaka|Asia/Qostanay","Asia/Dhaka|Asia/Thimbu","Asia/Dhaka|Asia/Thimphu","Asia/Dhaka|Asia/Urumqi","Asia/Dhaka|Etc/GMT-6","Asia/Dhaka|Indian/Chagos","Asia/Dili|Etc/GMT-9","Asia/Dili|Pacific/Palau","Asia/Dubai|Asia/Muscat","Asia/Dubai|Asia/Tbilisi","Asia/Dubai|Asia/Yerevan","Asia/Dubai|Etc/GMT-4","Asia/Dubai|Europe/Samara","Asia/Dubai|Indian/Mahe","Asia/Dubai|Indian/Mauritius","Asia/Dubai|Indian/Reunion","Asia/Gaza|Asia/Hebron","Asia/Hong_Kong|Hongkong","Asia/Jakarta|Asia/Pontianak","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kamchatka|Asia/Anadyr","Asia/Kamchatka|Etc/GMT-12","Asia/Kamchatka|Kwajalein","Asia/Kamchatka|Pacific/Funafuti","Asia/Kamchatka|Pacific/Kwajalein","Asia/Kamchatka|Pacific/Majuro","Asia/Kamchatka|Pacific/Nauru","Asia/Kamchatka|Pacific/Tarawa","Asia/Kamchatka|Pacific/Wake","Asia/Kamchatka|Pacific/Wallis","Asia/Kathmandu|Asia/Katmandu","Asia/Kolkata|Asia/Calcutta","Asia/Kuala_Lumpur|Asia/Brunei","Asia/Kuala_Lumpur|Asia/Kuching","Asia/Kuala_Lumpur|Asia/Singapore","Asia/Kuala_Lumpur|Etc/GMT-8","Asia/Kuala_Lumpur|Singapore","Asia/Makassar|Asia/Ujung_Pandang","Asia/Rangoon|Asia/Yangon","Asia/Rangoon|Indian/Cocos","Asia/Seoul|ROK","Asia/Shanghai|Asia/Chongqing","Asia/Shanghai|Asia/Chungking","Asia/Shanghai|Asia/Harbin","Asia/Shanghai|Asia/Macao","Asia/Shanghai|Asia/Macau","Asia/Shanghai|Asia/Taipei","Asia/Shanghai|PRC","Asia/Shanghai|ROC","Asia/Tashkent|Antarctica/Mawson","Asia/Tashkent|Asia/Aqtau","Asia/Tashkent|Asia/Aqtobe","Asia/Tashkent|Asia/Ashgabat","Asia/Tashkent|Asia/Ashkhabad","Asia/Tashkent|Asia/Atyrau","Asia/Tashkent|Asia/Dushanbe","Asia/Tashkent|Asia/Oral","Asia/Tashkent|Asia/Samarkand","Asia/Tashkent|Etc/GMT-5","Asia/Tashkent|Indian/Kerguelen","Asia/Tashkent|Indian/Maldives","Asia/Tehran|Iran","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Choibalsan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Asia/Vladivostok|Asia/Ust-Nera","Asia/Yakutsk|Asia/Khandyga","Atlantic/Azores|America/Scoresbysund","Atlantic/Cape_Verde|Etc/GMT+1","Australia/Adelaide|Australia/Broken_Hill","Australia/Adelaide|Australia/South","Australia/Adelaide|Australia/Yancowinna","Australia/Brisbane|Australia/Lindeman","Australia/Brisbane|Australia/Queensland","Australia/Darwin|Australia/North","Australia/Lord_Howe|Australia/LHI","Australia/Perth|Australia/West","Australia/Sydney|Australia/ACT","Australia/Sydney|Australia/Canberra","Australia/Sydney|Australia/Currie","Australia/Sydney|Australia/Hobart","Australia/Sydney|Australia/Melbourne","Australia/Sydney|Australia/NSW","Australia/Sydney|Australia/Tasmania","Australia/Sydney|Australia/Victoria","Etc/UTC|Etc/UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UCT","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Athens|Asia/Nicosia","Europe/Athens|EET","Europe/Athens|Europe/Bucharest","Europe/Athens|Europe/Helsinki","Europe/Athens|Europe/Kiev","Europe/Athens|Europe/Mariehamn","Europe/Athens|Europe/Nicosia","Europe/Athens|Europe/Riga","Europe/Athens|Europe/Sofia","Europe/Athens|Europe/Tallinn","Europe/Athens|Europe/Uzhgorod","Europe/Athens|Europe/Vilnius","Europe/Athens|Europe/Zaporozhye","Europe/Chisinau|Europe/Tiraspol","Europe/Dublin|Eire","Europe/Istanbul|Asia/Istanbul","Europe/Istanbul|Turkey","Europe/Lisbon|Atlantic/Canary","Europe/Lisbon|Atlantic/Faeroe","Europe/Lisbon|Atlantic/Faroe","Europe/Lisbon|Atlantic/Madeira","Europe/Lisbon|Portugal","Europe/Lisbon|WET","Europe/London|Europe/Belfast","Europe/London|Europe/Guernsey","Europe/London|Europe/Isle_of_Man","Europe/London|Europe/Jersey","Europe/London|GB","Europe/London|GB-Eire","Europe/Moscow|W-SU","Europe/Paris|Africa/Ceuta","Europe/Paris|Arctic/Longyearbyen","Europe/Paris|Atlantic/Jan_Mayen","Europe/Paris|CET","Europe/Paris|Europe/Amsterdam","Europe/Paris|Europe/Andorra","Europe/Paris|Europe/Belgrade","Europe/Paris|Europe/Berlin","Europe/Paris|Europe/Bratislava","Europe/Paris|Europe/Brussels","Europe/Paris|Europe/Budapest","Europe/Paris|Europe/Busingen","Europe/Paris|Europe/Copenhagen","Europe/Paris|Europe/Gibraltar","Europe/Paris|Europe/Ljubljana","Europe/Paris|Europe/Luxembourg","Europe/Paris|Europe/Madrid","Europe/Paris|Europe/Malta","Europe/Paris|Europe/Monaco","Europe/Paris|Europe/Oslo","Europe/Paris|Europe/Podgorica","Europe/Paris|Europe/Prague","Europe/Paris|Europe/Rome","Europe/Paris|Europe/San_Marino","Europe/Paris|Europe/Sarajevo","Europe/Paris|Europe/Skopje","Europe/Paris|Europe/Stockholm","Europe/Paris|Europe/Tirane","Europe/Paris|Europe/Vaduz","Europe/Paris|Europe/Vatican","Europe/Paris|Europe/Vienna","Europe/Paris|Europe/Warsaw","Europe/Paris|Europe/Zagreb","Europe/Paris|Europe/Zurich","Europe/Paris|Poland","Europe/Ulyanovsk|Europe/Astrakhan","Pacific/Auckland|Antarctica/McMurdo","Pacific/Auckland|Antarctica/South_Pole","Pacific/Auckland|NZ","Pacific/Chatham|NZ-CHAT","Pacific/Easter|Chile/EasterIsland","Pacific/Fakaofo|Etc/GMT-13","Pacific/Fakaofo|Pacific/Enderbury","Pacific/Galapagos|Etc/GMT+6","Pacific/Gambier|Etc/GMT+9","Pacific/Guadalcanal|Antarctica/Macquarie","Pacific/Guadalcanal|Etc/GMT-11","Pacific/Guadalcanal|Pacific/Efate","Pacific/Guadalcanal|Pacific/Kosrae","Pacific/Guadalcanal|Pacific/Noumea","Pacific/Guadalcanal|Pacific/Pohnpei","Pacific/Guadalcanal|Pacific/Ponape","Pacific/Guam|Pacific/Saipan","Pacific/Honolulu|HST","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Kiritimati|Etc/GMT-14","Pacific/Niue|Etc/GMT+11","Pacific/Pago_Pago|Pacific/Midway","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pitcairn|Etc/GMT+8","Pacific/Port_Moresby|Antarctica/DumontDUrville","Pacific/Port_Moresby|Etc/GMT-10","Pacific/Port_Moresby|Pacific/Chuuk","Pacific/Port_Moresby|Pacific/Truk","Pacific/Port_Moresby|Pacific/Yap","Pacific/Tahiti|Etc/GMT+10","Pacific/Tahiti|Pacific/Rarotonga"],countries:["AD|Europe/Andorra","AE|Asia/Dubai","AF|Asia/Kabul","AG|America/Port_of_Spain America/Antigua","AI|America/Port_of_Spain America/Anguilla","AL|Europe/Tirane","AM|Asia/Yerevan","AO|Africa/Lagos Africa/Luanda","AQ|Antarctica/Casey Antarctica/Davis Antarctica/DumontDUrville Antarctica/Mawson Antarctica/Palmer Antarctica/Rothera Antarctica/Syowa Antarctica/Troll Antarctica/Vostok Pacific/Auckland Antarctica/McMurdo","AR|America/Argentina/Buenos_Aires America/Argentina/Cordoba America/Argentina/Salta America/Argentina/Jujuy America/Argentina/Tucuman America/Argentina/Catamarca America/Argentina/La_Rioja America/Argentina/San_Juan America/Argentina/Mendoza America/Argentina/San_Luis America/Argentina/Rio_Gallegos America/Argentina/Ushuaia","AS|Pacific/Pago_Pago","AT|Europe/Vienna","AU|Australia/Lord_Howe Antarctica/Macquarie Australia/Hobart Australia/Currie Australia/Melbourne Australia/Sydney Australia/Broken_Hill Australia/Brisbane Australia/Lindeman Australia/Adelaide Australia/Darwin Australia/Perth Australia/Eucla","AW|America/Curacao America/Aruba","AX|Europe/Helsinki Europe/Mariehamn","AZ|Asia/Baku","BA|Europe/Belgrade Europe/Sarajevo","BB|America/Barbados","BD|Asia/Dhaka","BE|Europe/Brussels","BF|Africa/Abidjan Africa/Ouagadougou","BG|Europe/Sofia","BH|Asia/Qatar Asia/Bahrain","BI|Africa/Maputo Africa/Bujumbura","BJ|Africa/Lagos Africa/Porto-Novo","BL|America/Port_of_Spain America/St_Barthelemy","BM|Atlantic/Bermuda","BN|Asia/Brunei","BO|America/La_Paz","BQ|America/Curacao America/Kralendijk","BR|America/Noronha America/Belem America/Fortaleza America/Recife America/Araguaina America/Maceio America/Bahia America/Sao_Paulo America/Campo_Grande America/Cuiaba America/Santarem America/Porto_Velho America/Boa_Vista America/Manaus America/Eirunepe America/Rio_Branco","BS|America/Nassau","BT|Asia/Thimphu","BW|Africa/Maputo Africa/Gaborone","BY|Europe/Minsk","BZ|America/Belize","CA|America/St_Johns America/Halifax America/Glace_Bay America/Moncton America/Goose_Bay America/Blanc-Sablon America/Toronto America/Nipigon America/Thunder_Bay America/Iqaluit America/Pangnirtung America/Atikokan America/Winnipeg America/Rainy_River America/Resolute America/Rankin_Inlet America/Regina America/Swift_Current America/Edmonton America/Cambridge_Bay America/Yellowknife America/Inuvik America/Creston America/Dawson_Creek America/Fort_Nelson America/Vancouver America/Whitehorse America/Dawson","CC|Indian/Cocos","CD|Africa/Maputo Africa/Lagos Africa/Kinshasa Africa/Lubumbashi","CF|Africa/Lagos Africa/Bangui","CG|Africa/Lagos Africa/Brazzaville","CH|Europe/Zurich","CI|Africa/Abidjan","CK|Pacific/Rarotonga","CL|America/Santiago America/Punta_Arenas Pacific/Easter","CM|Africa/Lagos Africa/Douala","CN|Asia/Shanghai Asia/Urumqi","CO|America/Bogota","CR|America/Costa_Rica","CU|America/Havana","CV|Atlantic/Cape_Verde","CW|America/Curacao","CX|Indian/Christmas","CY|Asia/Nicosia Asia/Famagusta","CZ|Europe/Prague","DE|Europe/Zurich Europe/Berlin Europe/Busingen","DJ|Africa/Nairobi Africa/Djibouti","DK|Europe/Copenhagen","DM|America/Port_of_Spain America/Dominica","DO|America/Santo_Domingo","DZ|Africa/Algiers","EC|America/Guayaquil Pacific/Galapagos","EE|Europe/Tallinn","EG|Africa/Cairo","EH|Africa/El_Aaiun","ER|Africa/Nairobi Africa/Asmara","ES|Europe/Madrid Africa/Ceuta Atlantic/Canary","ET|Africa/Nairobi Africa/Addis_Ababa","FI|Europe/Helsinki","FJ|Pacific/Fiji","FK|Atlantic/Stanley","FM|Pacific/Chuuk Pacific/Pohnpei Pacific/Kosrae","FO|Atlantic/Faroe","FR|Europe/Paris","GA|Africa/Lagos Africa/Libreville","GB|Europe/London","GD|America/Port_of_Spain America/Grenada","GE|Asia/Tbilisi","GF|America/Cayenne","GG|Europe/London Europe/Guernsey","GH|Africa/Accra","GI|Europe/Gibraltar","GL|America/Godthab America/Danmarkshavn America/Scoresbysund America/Thule","GM|Africa/Abidjan Africa/Banjul","GN|Africa/Abidjan Africa/Conakry","GP|America/Port_of_Spain America/Guadeloupe","GQ|Africa/Lagos Africa/Malabo","GR|Europe/Athens","GS|Atlantic/South_Georgia","GT|America/Guatemala","GU|Pacific/Guam","GW|Africa/Bissau","GY|America/Guyana","HK|Asia/Hong_Kong","HN|America/Tegucigalpa","HR|Europe/Belgrade Europe/Zagreb","HT|America/Port-au-Prince","HU|Europe/Budapest","ID|Asia/Jakarta Asia/Pontianak Asia/Makassar Asia/Jayapura","IE|Europe/Dublin","IL|Asia/Jerusalem","IM|Europe/London Europe/Isle_of_Man","IN|Asia/Kolkata","IO|Indian/Chagos","IQ|Asia/Baghdad","IR|Asia/Tehran","IS|Atlantic/Reykjavik","IT|Europe/Rome","JE|Europe/London Europe/Jersey","JM|America/Jamaica","JO|Asia/Amman","JP|Asia/Tokyo","KE|Africa/Nairobi","KG|Asia/Bishkek","KH|Asia/Bangkok Asia/Phnom_Penh","KI|Pacific/Tarawa Pacific/Enderbury Pacific/Kiritimati","KM|Africa/Nairobi Indian/Comoro","KN|America/Port_of_Spain America/St_Kitts","KP|Asia/Pyongyang","KR|Asia/Seoul","KW|Asia/Riyadh Asia/Kuwait","KY|America/Panama America/Cayman","KZ|Asia/Almaty Asia/Qyzylorda Asia/Qostanay Asia/Aqtobe Asia/Aqtau Asia/Atyrau Asia/Oral","LA|Asia/Bangkok Asia/Vientiane","LB|Asia/Beirut","LC|America/Port_of_Spain America/St_Lucia","LI|Europe/Zurich Europe/Vaduz","LK|Asia/Colombo","LR|Africa/Monrovia","LS|Africa/Johannesburg Africa/Maseru","LT|Europe/Vilnius","LU|Europe/Luxembourg","LV|Europe/Riga","LY|Africa/Tripoli","MA|Africa/Casablanca","MC|Europe/Monaco","MD|Europe/Chisinau","ME|Europe/Belgrade Europe/Podgorica","MF|America/Port_of_Spain America/Marigot","MG|Africa/Nairobi Indian/Antananarivo","MH|Pacific/Majuro Pacific/Kwajalein","MK|Europe/Belgrade Europe/Skopje","ML|Africa/Abidjan Africa/Bamako","MM|Asia/Yangon","MN|Asia/Ulaanbaatar Asia/Hovd Asia/Choibalsan","MO|Asia/Macau","MP|Pacific/Guam Pacific/Saipan","MQ|America/Martinique","MR|Africa/Abidjan Africa/Nouakchott","MS|America/Port_of_Spain America/Montserrat","MT|Europe/Malta","MU|Indian/Mauritius","MV|Indian/Maldives","MW|Africa/Maputo Africa/Blantyre","MX|America/Mexico_City America/Cancun America/Merida America/Monterrey America/Matamoros America/Mazatlan America/Chihuahua America/Ojinaga America/Hermosillo America/Tijuana America/Bahia_Banderas","MY|Asia/Kuala_Lumpur Asia/Kuching","MZ|Africa/Maputo","NA|Africa/Windhoek","NC|Pacific/Noumea","NE|Africa/Lagos Africa/Niamey","NF|Pacific/Norfolk","NG|Africa/Lagos","NI|America/Managua","NL|Europe/Amsterdam","NO|Europe/Oslo","NP|Asia/Kathmandu","NR|Pacific/Nauru","NU|Pacific/Niue","NZ|Pacific/Auckland Pacific/Chatham","OM|Asia/Dubai Asia/Muscat","PA|America/Panama","PE|America/Lima","PF|Pacific/Tahiti Pacific/Marquesas Pacific/Gambier","PG|Pacific/Port_Moresby Pacific/Bougainville","PH|Asia/Manila","PK|Asia/Karachi","PL|Europe/Warsaw","PM|America/Miquelon","PN|Pacific/Pitcairn","PR|America/Puerto_Rico","PS|Asia/Gaza Asia/Hebron","PT|Europe/Lisbon Atlantic/Madeira Atlantic/Azores","PW|Pacific/Palau","PY|America/Asuncion","QA|Asia/Qatar","RE|Indian/Reunion","RO|Europe/Bucharest","RS|Europe/Belgrade","RU|Europe/Kaliningrad Europe/Moscow Europe/Simferopol Europe/Kirov Europe/Astrakhan Europe/Volgograd Europe/Saratov Europe/Ulyanovsk Europe/Samara Asia/Yekaterinburg Asia/Omsk Asia/Novosibirsk Asia/Barnaul Asia/Tomsk Asia/Novokuznetsk Asia/Krasnoyarsk Asia/Irkutsk Asia/Chita Asia/Yakutsk Asia/Khandyga Asia/Vladivostok Asia/Ust-Nera Asia/Magadan Asia/Sakhalin Asia/Srednekolymsk Asia/Kamchatka Asia/Anadyr","RW|Africa/Maputo Africa/Kigali","SA|Asia/Riyadh","SB|Pacific/Guadalcanal","SC|Indian/Mahe","SD|Africa/Khartoum","SE|Europe/Stockholm","SG|Asia/Singapore","SH|Africa/Abidjan Atlantic/St_Helena","SI|Europe/Belgrade Europe/Ljubljana","SJ|Europe/Oslo Arctic/Longyearbyen","SK|Europe/Prague Europe/Bratislava","SL|Africa/Abidjan Africa/Freetown","SM|Europe/Rome Europe/San_Marino","SN|Africa/Abidjan Africa/Dakar","SO|Africa/Nairobi Africa/Mogadishu","SR|America/Paramaribo","SS|Africa/Juba","ST|Africa/Sao_Tome","SV|America/El_Salvador","SX|America/Curacao America/Lower_Princes","SY|Asia/Damascus","SZ|Africa/Johannesburg Africa/Mbabane","TC|America/Grand_Turk","TD|Africa/Ndjamena","TF|Indian/Reunion Indian/Kerguelen","TG|Africa/Abidjan Africa/Lome","TH|Asia/Bangkok","TJ|Asia/Dushanbe","TK|Pacific/Fakaofo","TL|Asia/Dili","TM|Asia/Ashgabat","TN|Africa/Tunis","TO|Pacific/Tongatapu","TR|Europe/Istanbul","TT|America/Port_of_Spain","TV|Pacific/Funafuti","TW|Asia/Taipei","TZ|Africa/Nairobi Africa/Dar_es_Salaam","UA|Europe/Simferopol Europe/Kiev Europe/Uzhgorod Europe/Zaporozhye","UG|Africa/Nairobi Africa/Kampala","UM|Pacific/Pago_Pago Pacific/Wake Pacific/Honolulu Pacific/Midway","US|America/New_York America/Detroit America/Kentucky/Louisville America/Kentucky/Monticello America/Indiana/Indianapolis America/Indiana/Vincennes America/Indiana/Winamac America/Indiana/Marengo America/Indiana/Petersburg America/Indiana/Vevay America/Chicago America/Indiana/Tell_City America/Indiana/Knox America/Menominee America/North_Dakota/Center America/North_Dakota/New_Salem America/North_Dakota/Beulah America/Denver America/Boise America/Phoenix America/Los_Angeles America/Anchorage America/Juneau America/Sitka America/Metlakatla America/Yakutat America/Nome America/Adak Pacific/Honolulu","UY|America/Montevideo","UZ|Asia/Samarkand Asia/Tashkent","VA|Europe/Rome Europe/Vatican","VC|America/Port_of_Spain America/St_Vincent","VE|America/Caracas","VG|America/Port_of_Spain America/Tortola","VI|America/Port_of_Spain America/St_Thomas","VN|Asia/Bangkok Asia/Ho_Chi_Minh","VU|Pacific/Efate","WF|Pacific/Wallis","WS|Pacific/Apia","YE|Asia/Riyadh Asia/Aden","YT|Africa/Nairobi Indian/Mayotte","ZA|Africa/Johannesburg","ZM|Africa/Maputo Africa/Lusaka","ZW|Africa/Maputo Africa/Harare"]}),o}),window.CloudStreamerSDK=function(e,t){console.log(t);var n=this;n.options=t||{},n.conn=null,n.cm=null,n.mCameraID=null,n.camera=null,n.sharedKey=null,n.mAccessToken=null,n.streamer=document.getElementById(e),n.m={},n.conn=new CloudShareConnection(n.options),n.config={},n.config.ws_port=8888,n.config.wss_port=8883,n.config.host="cam.skyvr.videoexpertsgroup.com",n.api_host=n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com",n.api_port=null;var a=n.api_security_port=null;n.streamer.classList.add("cloudstreamer"),n.streamer.classList.add("green"),n.streamer.classList.add("black"),n.streamer.innerHTML='<div class="cloudstreamer-loader" style="display: none"></div><div class="cloudstreamer-error" style="display: none">\t<div class="cloudstreamer-error-text" style="display: none"></div></div><div class="cloudstreamer-watermark"></div><div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudstreamer-black-screen" style="display: none">\t\t<div class="cloudstreamer-watermark"></div>\t\t<div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div></div><div class="cloudplayer-controls">\t<div class="cloudplayer-stop" style="display: none"></div>\t<div class="cloudplayer-play" style="display: none"></div>\t<div class="cloudplayer-time"></div>\t<div class="cloudplayer-fullscreen"></div></div><video class="cloudstreamer-webcam-video" autoplay="true"></video>';var r=n.streamer.getElementsByClassName("cloudstreamer-loader")[0],o=n.streamer.getElementsByClassName("cloudstreamer-error")[0],i=n.streamer.getElementsByClassName("cloudstreamer-error-text")[0],s=n.streamer.getElementsByClassName("cloudstreamer-webcam-video")[0],l=n.streamer.getElementsByClassName("cloudplayer-stop")[0],c=n.streamer.getElementsByClassName("cloudplayer-play")[0],u=!1;function d(){u&&(r.style.display="none",u=!1)}n._setError=function(e){setTimeout(n.stop,10),n.mLastError=e,n.mCallback_onError&&n.mCallback_onError(n,e)},n.showErrorText=function(e){d(),o.style.display="inline-block",i.style.display="inline-block",i.innerHTML=e,l.style.display="none",c.style.display="none",s.srcObject=null},n.setSource=function(e){if(o.style.display="none",i.style.display="none",c.style.display="none",!e||""===e){var t="Access token is required";return console.error(t),n.showErrorText(t),CloudReturnCode.ERROR_INVALID_SOURCE}if("https:"==location.protocol){try{var a=atob(e);a=JSON.parse(a),console.log(a),a.token&&a.camid&&a.access&&""!==a.token&&""!==a.camid&&""!==a.access&&(n.sharedKey=a.token,n.mCameraID=a.camid),a.api&&(n.api_host=a.api,console.log("self.api_host: ",n.api_host)),a.api_p&&(n.api_port=a.api_p,console.log("self.api_port: ",n.api_port)),a.api_security_port&&(n.api_security_port=a.api_security_port,console.log("self.api_security_port: ",n.api_security_port))}catch(e){t="Invalid access token format";return console.error(t),CloudReturnCode.ERROR_INVALID_SOURCE}var r=n.api_host;n.api_host==(n.options.cloud_domain?n.options.cloud_domain:"web.skyvr.videoexpertsgroup.com")?r="https://"+n.api_host:"https:"===location.protocol?(r="https://"+n.api_host,null!=n.api_secutiry_port&&(r+=":"+n.api_secutiry_port)):"http:"!==location.protocol&&"file:"!==location.protocol||(r="http://"+n.api_host,null!=n.api_secutiry_port&&(r+=":"+n.api_secutiry_port)),n.conn.ServiceProviderUrl=r+"/",n.conn.open(n.sharedKey),n.mAccessToken=e,c.style.display=""}else n.showErrorText("Streamer is only available with HTTPS connection")},n.getSource=function(){return n.mAccessToken?n.mAccessToken:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED},n.start=function(){if(!n.sharedKey)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;console.warn("[CloudStreamerSDK] Start"),n.stop("by_strm_sdk_1"),navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){s.srcObject=e,n.conn&&n.conn._getAPI().cameraStreamUrls_webrtc(n.mCameraID).done(function(e){if(console.log("stream_urls: ",e),e.webrtc){var t=CloudHelpers.promise();0<CloudHelpers.compareVersions(CloudPlayerWebRTC2.version,e.webrtc.version)?(console.warn("Expected version webrtc.version (v"+e.webrtc.version+")  mismatch with included CloudPlayerWebRTC (v"+CloudPlayerWebRTC2.version+")"),t=CloudHelpers.requestJS(e.webrtc.scripts.player,function(e){for(e=e.replace("CloudPlayerWebRTC =","CloudPlayerWebRTC2 =");-1!==e.indexOf("CloudPlayerWebRTC.");)e=e.replace("CloudPlayerWebRTC.","CloudPlayerWebRTC2.");return e})):t.resolve(),t.done(function(){(a=new CloudPlayerWebRTC2(null,e.webrtc.connection_url,e.webrtc.ice_servers,{send_video:!0,send_audio:!0})).startWS(),l.style.display="",c.style.display="none"}).fail(function(e){console.error("err: ",e),n.showErrorText("Problem with streaming protocol")})}else n.showErrorText("Channel does not support WebRTC streamer")}).fail(function(e){console.error("err: ",e),n.showErrorText("Channel for streaming is not found")})}).catch(function(e){n.sharedKey=null,console.error(e),console.error("Something went wrong! ",e),-1!=(""+e).indexOf("Requested device is not found")&&n.showErrorText("Camera is not found")})},c.onclick=n.start,n.stop=function(){if(l.style.display="none",c.style.display=n.mAccessToken?"":"none",s.srcObject=null,!n.sharedKey)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;try{a&&a.stopWS()}catch(e){console.error(e)}},l.onclick=n.stop,n.initFullscreenControls=function(){var e,t,a=n.streamer.getElementsByClassName("cloudplayer-fullscreen")[0];n.changedFullscreen=function(){console.log("changedFullscreen"),document.webkitIsFullScreen?(e=n.player.style.height,t=n.player.style.width,n.streamer.style.height="100%",n.streamer.style.width="100%",console.log("changedFullscreen -> fullscreen")):(n.streamer.style.height=e,n.streamer.style.width=t,console.log("changedFullscreen -> NOT fullscreen"))},document.addEventListener&&(document.addEventListener("webkitfullscreenchange",n.changedFullscreen,!1),document.addEventListener("mozfullscreenchange",n.changedFullscreen,!1),document.addEventListener("fullscreenchange",n.changedFullscreen,!1),document.addEventListener("MSFullscreenChange",n.changedFullscreen,!1)),n.fullscreen=function(){console.log("fullscreen: clicked"),1==document.webkitIsFullScreen?document.webkitCancelFullScreen():document.mozFullScreen?document.mozCancelFullScreen():document.msFullscreenElement&&null!=document.msFullscreenElement?document.msExitFullscreen():n.streamer.mozRequestFullScreen?n.streamer.mozRequestFullScreen():n.streamer.requestFullscreen?n.streamer.requestFullscreen():n.streamer.webkitRequestFullscreen?n.streamer.webkitRequestFullscreen():n.streamer.msRequestFullscreen&&n.streamer.msRequestFullscreen()},a.onclick=n.fullscreen},n.initFullscreenControls()},window.CloudStreamerFlash=function(e,t){console.log(t);var n=this;n.options=t||{},n.conn=null,n.cm=null,n.mCameraID=null,n.camera=null,n.sharedKey=null,n.mAccessToken="",n.streamer=document.getElementById(e),n.m={},n.conn=new CloudShareConnection(n.options),n.config={},n.config.ws_port=8888,n.config.wss_port=8883,n.config.host="cam.skyvr.videoexpertsgroup.com",n.streamer.classList.add("cloudstreamer"),n.streamer.classList.add("green"),n.streamer.classList.add("black"),StreamerSWF.log=function(e){console.log("[CloudStreamerFlash]",e)},StreamerSWF.error=function(e){console.error("[CloudStreamerFlash]",e)},StreamerSWF.warn=function(e){console.warn("[CloudStreamerFlash]",e)},StreamerSWF.startedPublish=function(){console.log("[CloudStreamerFlash] publishing started")},StreamerSWF.stoppedPublish=function(){console.log("[CloudStreamerFlash] publishing stopped")},StreamerSWF.activityLevel=function(e){},n.streamer.innerHTML='<div class="cloudstreamer-loader" style="display: none"></div><div class="cloudstreamer-error" style="display: none">\t<div class="cloudstreamer-error-text" style="display: none"></div></div><div class="cloudstreamer-watermark"></div><div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div><div class="cloudstreamer-black-screen" style="display: none">\t\t<div class="cloudstreamer-watermark"></div>\t\t<div class="cloudstreamer-sdkversion">SDK '+CloudSDK.version+'</div></div><object class="streamer-swf" id="streamer_swf" type="application/x-shockwave-flash" data="'+CloudSDK.streamer_swf+'" width="100%" height="100%" ><param name="movie" value="'+CloudSDK.streamer_swf+'" /><embed src="'+CloudSDK.streamer_swf+'"><param name="allowScriptAccess" value="always"/><param value="allowNetworking" value="all"/><param name="wmode" value="transparent"/><param name="menu" value="false" /></object>';var a=n.streamer.getElementsByClassName("cloudstreamer-loader")[0],o=n.streamer.getElementsByClassName("cloudstreamer-error")[0],i=n.streamer.getElementsByClassName("cloudstreamer-error-text")[0];n.streamer.getElementsByClassName("streamer-swf")[0];console.log(StreamerSWF.flash()),n.onStarted=function(e){console.log("[CloudStreamerFlash] activate streaming to rtmp_url: ",e),StreamerSWF.activate(e,"PCMU")};var r=!(n.onStopped=function(){console.log("[CloudStreamerFlash] deactivate"),StreamerSWF.deactivate()});function s(){r&&(a.style.display="none",r=!1)}n._setError=function(e){setTimeout(n.stop,10),n.mLastError=e,n.mCallback_onError&&n.mCallback_onError(n,e)},n.showErrorText=function(e){s(),o.style.display="inline-block",i.style.display="inline-block",i.innerHTML=e},n.setSource=function(e){if(o.style.display="none",i.style.display="none",!e||""===e){var t="Access token required";return console.error(t),n.showErrorText(t),CloudReturnCode.ERROR_INVALID_SOURCE}if(CloudHelpers.isMobile())n.showErrorText("Mobile streamer is not available yet");else if(CloudHelpers.isChrome())n.showErrorText("Streamer is not available yet for Chrome. But you can open this page in Edge or Firefox to start streaming from your web camera.");else if(CloudHelpers.supportFlash()||!CloudHelpers.isFireFox()){if("https:"!=window.location.protocol){try{var a=atob(e);a=JSON.parse(a),console.log(a),a.token&&a.camid&&a.access&&""!==a.token&&""!==a.camid&&""!==a.access&&(n.sharedKey=a.token,n.mCameraID=a.camid),a.svcp&&""!=a.svcp&&(n.svcp_url=a.svcp,console.log("self.svcp_url: ",n.svcp_url))}catch(e){t="Invalid access token format";return console.error(t),CloudReturnCode.ERROR_INVALID_SOURCE}if(n.mAccessToken=e,null!=n.svcp_url){n.conn.ServiceProviderUrl=n.svcp_url;var r=CloudHelpers.parseUri(n.svcp_url);n.config.host=r.host}return n.conn.open(n.sharedKey),n.conn?(n.cm=new CloudCameraList(n.conn),n.cm.getCamera(n.mCameraID).done(function(e){n.mCamera=e,console.log("camera: ",n.mCamera._origJson()),n.start()}).fail(function(e){n.showErrorText("Channel for streaming not found")}),CloudReturnCode.OK):CloudReturnCode.ERROR_NO_CLOUD_CONNECTION}n.showErrorText("Streamer are not available yet with https")}else n.showErrorText("In Firefox Streamer available using by flash now.<br>Please install flash <a href='https://get.adobe.com/flashplayer' target='_blank'>https://get.adobe.com/flashplayer</a><br> or maybe enable Plugin 'Shockwave Flash' in your browser <a href='about:addons' target='_blank'>about:addons</a>.")},n.getSource=function(){return n.sharedKey?n.mAccessToken:CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED};var l=null;function c(){clearInterval(l)}n.start=function(){if(!n.mCamera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;if(!StreamerSWF.flash().vjs_activate)return c(),void(l=setInterval(function(){StreamerSWF.flash().vjs_activate&&(n.start(),c())},1e3));console.warn("[CloudStreamerFlash] Start"),n.stop("by_strm_sdk_1");var e=n.mCamera.getCameraManagerID();n.mCamera._getConn()._getAPI().resetCameraManager(e,{}).done(function(e){console.log(e),n.config.token=e.token,n.config.camid=n.mCamera.getID(),n.initWebSocket()}).fail(function(e){console.error(e)})},n.stop=function(){if(c(),!n.camera)return CloudReturnCode.ERROR_SOURCE_NOT_CONFIGURED;if(console.warn("Stop"),n.ws&&n.ws.socket)try{n.ws.socket.close()}catch(e){console.error(e)}try{StreamerSWF.deactivate()}catch(e){console.error(e)}},n.initWebSocket=function(){var e=n.config.srv||n.config.host;if(n.ws={},console.log("self.config.host: "+n.config.host),console.log("self.config.srv: "+n.config.srv),"http:"!=window.location.protocol&&"file:"!=window.location.protocol)return"https:"==window.location.protocol?void console.error("Not supported https yet"):void console.error("Expected protocol http or https");e="ws://"+e+":"+n.config.ws_port,e+="/ctl/NEW/"+n.config.token+"/",n.ws.socket=new WebSocket(e),n.ws.socket.onopen=function(){console.log("WS Opened"),n._register()},n.ws.socket.onclose=function(e){console.log("Closed")},n.ws.socket.onmessage=function(e){console.log("Received: "+e.data);try{var t=JSON.parse(e.data),a=t.cmd;n.handlers[a]?n.handlers[a](t):console.warn("Not found handler "+a)}catch(e){console.error(e)}},n.ws.socket.onerror=function(e){console.error("Error: "+e.message)}},n.m_nMessageID=0,n.makeCommand=function(e){return n.m_nMessageID++,{cmd:e,msgid:n.m_nMessageID}},n.makeCommandDone=function(e,t,a){var r=n.makeCommand("done");return r.orig_cmd=e,r.refid=t,r.status=a,r},n._register=function(){var e=n.makeCommand("register");e.pwd="",e.reg_token=n.config.token,e.ver="0.1",e.tz="UTC",e.vendor="web",n.sendMessage(e)},n.sendMessage=function(e){n.ws.socket.send(JSON.stringify(e))},n.handlers={},n.handlers.configure=function(e){e.server&&(n.config.srv=e.server),e.uuid&&(n.config.uuid=e.uuid)},n.handlers.bye=function(e){e.reason&&"RECONNECT"==e.reason&&setTimeout(function(){n.initWebSocket()},1200)},n.handlers.hello=function(e){e.media_server&&(n.config.media_server=e.media_server),e.sid&&(n.config.sid=e.sid),e.upload_url&&(n.config.upload_url=e.upload_url),n.sendMessage(n.makeCommandDone("hello",e.msgid,"OK"));var t=n.makeCommand("cam_register");t.ip="127.0.0.1",t.uuid=n.config.uuid,t.brand="None",t.model="Unknown",t.sn="nope",t.type="cm",t.version="0",t.initial_mode="cloud",n.sendMessage(t)},n.handlers.cam_hello=function(e){n.sendMessage(n.makeCommandDone("cam_hello",e.msgid,"OK")),n.config.camid=e.cam_id,e.media_url&&(n.config.media_url=e.media_url),e.media_uri&&(n.config.media_server=e.media_uri),e.path&&(n.config.media_url=e.path)},n.handlers.get_cam_status=function(e){var t=n.makeCommand("cam_status");t.cam_id=n.config.camid,t.ip="127.0.0.1",t.activity=!0,t.streaming=!0,t.status_led=!1,n.sendMessage(t)},n.handlers.get_supported_streams=function(e){var t=n.makeCommand("supported_streams");t.cam_id=n.config.camid,t.audio_es=["Aud"],t.video_es=["Vid"],t.streams=[{id:"Main",video:"Vid",audio:"Aud"}],n.sendMessage(t)},n.stream_start_counter=0,n.handlers.stream_start=function(e){var t="rtmp://"+n.config.media_server+"/"+n.config.media_url+"Main";t+="?sid="+n.config.sid,console.log(t),0==n.stream_start_counter&&(n.stream_start_counter++,n.options.onStarted?n.options.onStarted(t):n.options.onStarted||n.onStarted(t)),n.sendMessage(n.makeCommandDone("stream_start",e.msgid,"OK"))},n.handlers.stream_stop=function(e){n.stream_start_counter--,n.sendMessage(n.makeCommandDone("stream_start",e.msgid,"OK")),0==n.stream_start_counter&&(n.options.onStopped?n.options.onStarted(stream_url):n.options.onStarted||n.onStopped())}};